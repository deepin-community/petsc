<center><a href="https://gitlab.com/petsc/petsc/-/blob/183cd29ee28cacc3ee84c625478d276606b77b2c/src/ts/impls/arkimex/arkimex.c">Actual source code: arkimex.c</a></center><br>

<html>
<head>
<title></title>
<meta name="generator" content="c2html 0.9.4">
<meta name="date" content="2024-03-29T14:12:28+00:00">
</head>

<body bgcolor="#FFFFFF">
<pre width="80">
<a name="line1">  1: </a><font color="#B22222">/*</font>
<a name="line2">  2: </a><font color="#B22222">  Code for timestepping with additive Runge-Kutta IMEX method or Diagonally Implicit Runge-Kutta methods.</font>

<a name="line4">  4: </a><font color="#B22222">  Notes:</font>
<a name="line5">  5: </a><font color="#B22222">  For ARK, the general system is written as</font>

<a name="line7">  7: </a><font color="#B22222">  F(t,U,Udot) = G(t,U)</font>

<a name="line9">  9: </a><font color="#B22222">  where F represents the stiff part of the physics and G represents the non-stiff part.</font>

<a name="line11"> 11: </a><font color="#B22222">*/</font>
<a name="line12"> 12: </a>#include <A href="../../../../include/petsc/private/tsimpl.h.html">&lt;petsc/private/tsimpl.h&gt;</A>
<a name="line13"> 13: </a>#include <A href="../../../../include/petscdm.h.html">&lt;petscdm.h&gt;</A>

<a name="line15"> 15: </a>static <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>  TSARKIMEXDefault = <a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a>;
<a name="line16"> 16: </a>static <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>     TSDIRKDefault    = <a href="../../../../manualpages/TS/TSDIRKES213SAL.html">TSDIRKES213SAL</a>;
<a name="line17"> 17: </a>static <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>      TSARKIMEXRegisterAllCalled;
<a name="line18"> 18: </a>static <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>      TSARKIMEXPackageInitialized;
<a name="line19"> 19: </a><strong><font color="#4169E1">static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSExtrapolate_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>, <a href="../../../../manualpages/Vec/Vec.html">Vec</a>)</font></strong>;

<a name="line21"> 21: </a><font color="#4169E1">typedef struct _ARKTableau *ARKTableau;</font>
<a name="line22"> 22: </a><font color="#4169E1"><a name="_ARKTableau"></a>struct _ARKTableau </font>{
<a name="line23"> 23: </a>  char      *name;
<a name="line24"> 24: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>  additive;             <font color="#B22222">/* If False, it is a DIRK method */</font>
<a name="line25"> 25: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   order;                <font color="#B22222">/* Classical approximation order of the method */</font>
<a name="line26"> 26: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   s;                    <font color="#B22222">/* Number of stages */</font>
<a name="line27"> 27: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>  stiffly_accurate;     <font color="#B22222">/* The implicit part is stiffly accurate */</font>
<a name="line28"> 28: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>  FSAL_implicit;        <font color="#B22222">/* The implicit part is FSAL */</font>
<a name="line29"> 29: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>  explicit_first_stage; <font color="#B22222">/* The implicit part has an explicit first stage */</font>
<a name="line30"> 30: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   pinterp;              <font color="#B22222">/* Interpolation order */</font>
<a name="line31"> 31: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *At, *bt, *ct;         <font color="#B22222">/* Stiff tableau */</font>
<a name="line32"> 32: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *A, *b, *c;            <font color="#B22222">/* Non-stiff tableau */</font>
<a name="line33"> 33: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *bembedt, *bembed;     <font color="#B22222">/* Embedded formula of order one less (order-1) */</font>
<a name="line34"> 34: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *binterpt, *binterp;   <font color="#B22222">/* Dense output formula */</font>
<a name="line35"> 35: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>  ccfl;                 <font color="#B22222">/* Placeholder for CFL coefficient relative to forward Euler */</font>
<a name="line36"> 36: </a>};
<a name="line37"> 37: </a><font color="#4169E1">typedef struct _ARKTableauLink *ARKTableauLink;</font>
<a name="line38"> 38: </a><font color="#4169E1"><a name="_ARKTableauLink"></a>struct _ARKTableauLink </font>{
<a name="line39"> 39: </a>  <font color="#4169E1">struct _ARKTableau</font> tab;
<a name="line40"> 40: </a>  ARKTableauLink     next;
<a name="line41"> 41: </a>};
<a name="line42"> 42: </a>static ARKTableauLink ARKTableauList;

<a name="line44"> 44: </a><font color="#4169E1">typedef</font> <font color="#4169E1">struct</font> {
<a name="line45"> 45: </a>  ARKTableau   tableau;
<a name="line46"> 46: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *Y;            <font color="#B22222">/* States computed during the step */</font>
<a name="line47"> 47: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *YdotI;        <font color="#B22222">/* Time derivatives for the stiff part */</font>
<a name="line48"> 48: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *YdotRHS;      <font color="#B22222">/* Function evaluations for the non-stiff part */</font>
<a name="line49"> 49: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *Y_prev;       <font color="#B22222">/* States computed during the previous time step */</font>
<a name="line50"> 50: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *YdotI_prev;   <font color="#B22222">/* Time derivatives for the stiff part for the previous time step*/</font>
<a name="line51"> 51: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         *YdotRHS_prev; <font color="#B22222">/* Function evaluations for the non-stiff part for the previous time step*/</font>
<a name="line52"> 52: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>          Ydot0;        <font color="#B22222">/* Holds the slope from the previous step in FSAL case */</font>
<a name="line53"> 53: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>          Ydot;         <font color="#B22222">/* Work vector holding Ydot during residual evaluation */</font>
<a name="line54"> 54: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>          Z;            <font color="#B22222">/* Ydot = shift(Y-Z) */</font>
<a name="line55"> 55: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a> *work;         <font color="#B22222">/* Scalar work */</font>
<a name="line56"> 56: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>    scoeff;       <font color="#B22222">/* shift = scoeff/dt */</font>
<a name="line57"> 57: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>    stage_time;
<a name="line58"> 58: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>    imex;
<a name="line59"> 59: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>    extrapolate; <font color="#B22222">/* Extrapolate initial guess from previous time-step stage values */</font>
<a name="line60"> 60: </a>  TSStepStatus status;

<a name="line62"> 62: </a>  <font color="#B22222">/* context for sensitivity analysis */</font>
<a name="line63"> 63: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *VecsDeltaLam;   <font color="#B22222">/* Increment of the adjoint sensitivity w.r.t IC at stage */</font>
<a name="line64"> 64: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *VecsSensiTemp;  <font color="#B22222">/* Vectors to be multiplied with Jacobian transpose */</font>
<a name="line65"> 65: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *VecsSensiPTemp; <font color="#B22222">/* Temporary Vectors to store JacobianP-transpose-vector product */</font>
<a name="line66"> 66: </a>} TS_ARKIMEX;

<a name="line68"> 68: </a><font color="#B22222">/*MC</font>
<a name="line69"> 69: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXARS122.html">TSARKIMEXARS122</a> - Second order ARK IMEX scheme, {cite}`ascher_1997`</font>

<a name="line71"> 71: </a><font color="#B22222">     This method has one explicit stage and one implicit stage.</font>

<a name="line73"> 73: </a><font color="#B22222">     Options Database Key:</font>
<a name="line74"> 74: </a><font color="#B22222">.      -ts_arkimex_type ars122 - set arkimex type to ars122</font>

<a name="line76"> 76: </a><font color="#B22222">     Level: advanced</font>

<a name="line78"> 78: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line79"> 79: </a><font color="#B22222">M*/</font>

<a name="line81"> 81: </a><font color="#B22222">/*MC</font>
<a name="line82"> 82: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXA2.html">TSARKIMEXA2</a> - Second order ARK IMEX scheme with A-stable implicit part.</font>

<a name="line84"> 84: </a><font color="#B22222">     This method has an explicit stage and one implicit stage, and has an A-stable implicit scheme. This method was provided by Emil Constantinescu.</font>

<a name="line86"> 86: </a><font color="#B22222">     Options Database Key:</font>
<a name="line87"> 87: </a><font color="#B22222">.      -ts_arkimex_type a2 - set arkimex type to a2</font>

<a name="line89"> 89: </a><font color="#B22222">     Level: advanced</font>

<a name="line91"> 91: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line92"> 92: </a><font color="#B22222">M*/</font>

<a name="line94"> 94: </a><font color="#B22222">/*MC</font>
<a name="line95"> 95: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXL2.html">TSARKIMEXL2</a> - Second order ARK IMEX scheme with L-stable implicit part, {cite}`pareschi_2005`</font>

<a name="line97"> 97: </a><font color="#B22222">     This method has two implicit stages, and L-stable implicit scheme.</font>

<a name="line99"> 99: </a><font color="#B22222">     Options Database Key:</font>
<a name="line100">100: </a><font color="#B22222">.      -ts_arkimex_type l2 - set arkimex type to l2</font>

<a name="line102">102: </a><font color="#B22222">     Level: advanced</font>

<a name="line104">104: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line105">105: </a><font color="#B22222">M*/</font>

<a name="line107">107: </a><font color="#B22222">/*MC</font>
<a name="line108">108: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX1BEE.html">TSARKIMEX1BEE</a> - First order backward Euler represented as an ARK IMEX scheme with extrapolation as error estimator. This is a 3-stage method.</font>

<a name="line110">110: </a><font color="#B22222">     This method is aimed at starting the integration of implicit DAEs when explicit first-stage ARK methods are used.</font>

<a name="line112">112: </a><font color="#B22222">     Options Database Key:</font>
<a name="line113">113: </a><font color="#B22222">.      -ts_arkimex_type 1bee - set arkimex type to 1bee</font>

<a name="line115">115: </a><font color="#B22222">     Level: advanced</font>

<a name="line117">117: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line118">118: </a><font color="#B22222">M*/</font>

<a name="line120">120: </a><font color="#B22222">/*MC</font>
<a name="line121">121: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX2C.html">TSARKIMEX2C</a> - Second order ARK IMEX scheme with L-stable implicit part.</font>

<a name="line123">123: </a><font color="#B22222">     This method has one explicit stage and two implicit stages. The implicit part is the same as in <a href="../../../../manualpages/TS/TSARKIMEX2D.html">TSARKIMEX2D</a> and <a href="../../../../manualpages/TS/TSARKIMEX2E.html">TSARKIMEX2E</a>, but the explicit part has a larger stability region on the negative real axis. This method was provided by Emil Constantinescu.</font>

<a name="line125">125: </a><font color="#B22222">     Options Database Key:</font>
<a name="line126">126: </a><font color="#B22222">.      -ts_arkimex_type 2c - set arkimex type to 2c</font>

<a name="line128">128: </a><font color="#B22222">     Level: advanced</font>

<a name="line130">130: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line131">131: </a><font color="#B22222">M*/</font>

<a name="line133">133: </a><font color="#B22222">/*MC</font>
<a name="line134">134: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX2D.html">TSARKIMEX2D</a> - Second order ARK IMEX scheme with L-stable implicit part.</font>

<a name="line136">136: </a><font color="#B22222">     This method has one explicit stage and two implicit stages. The stability function is independent of the explicit part in the infinity limit of the implicit component. This method was provided by Emil Constantinescu.</font>

<a name="line138">138: </a><font color="#B22222">     Options Database Key:</font>
<a name="line139">139: </a><font color="#B22222">.      -ts_arkimex_type 2d - set arkimex type to 2d</font>

<a name="line141">141: </a><font color="#B22222">     Level: advanced</font>

<a name="line143">143: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line144">144: </a><font color="#B22222">M*/</font>

<a name="line146">146: </a><font color="#B22222">/*MC</font>
<a name="line147">147: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX2E.html">TSARKIMEX2E</a> - Second order ARK IMEX scheme with L-stable implicit part.</font>

<a name="line149">149: </a><font color="#B22222">     This method has one explicit stage and two implicit stages. It is is an optimal method developed by Emil Constantinescu.</font>

<a name="line151">151: </a><font color="#B22222">     Options Database Key:</font>
<a name="line152">152: </a><font color="#B22222">.      -ts_arkimex_type 2e - set arkimex type to 2e</font>

<a name="line154">154: </a><font color="#B22222">    Level: advanced</font>

<a name="line156">156: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line157">157: </a><font color="#B22222">M*/</font>

<a name="line159">159: </a><font color="#B22222">/*MC</font>
<a name="line160">160: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXPRSSP2.html">TSARKIMEXPRSSP2</a> - Second order SSP ARK IMEX scheme, {cite}`pareschi_2005`</font>

<a name="line162">162: </a><font color="#B22222">     This method has three implicit stages.</font>

<a name="line164">164: </a><font color="#B22222">     This method is referred to as SSP2-(3,3,2) in &lt;https://arxiv.org/abs/1110.4375&gt;</font>

<a name="line166">166: </a><font color="#B22222">     Options Database Key:</font>
<a name="line167">167: </a><font color="#B22222">.      -ts_arkimex_type prssp2 - set arkimex type to prssp2</font>

<a name="line169">169: </a><font color="#B22222">     Level: advanced</font>

<a name="line171">171: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line172">172: </a><font color="#B22222">M*/</font>

<a name="line174">174: </a><font color="#B22222">/*MC</font>
<a name="line175">175: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a> - Third order ARK IMEX scheme with L-stable implicit part, {cite}`kennedy_2003`</font>

<a name="line177">177: </a><font color="#B22222">     This method has one explicit stage and three implicit stages.</font>

<a name="line179">179: </a><font color="#B22222">     Options Database Key:</font>
<a name="line180">180: </a><font color="#B22222">.      -ts_arkimex_type 3 - set arkimex type to 3</font>

<a name="line182">182: </a><font color="#B22222">     Level: advanced</font>

<a name="line184">184: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line185">185: </a><font color="#B22222">M*/</font>

<a name="line187">187: </a><font color="#B22222">/*MC</font>
<a name="line188">188: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXARS443.html">TSARKIMEXARS443</a> - Third order ARK IMEX scheme, {cite}`ascher_1997`</font>

<a name="line190">190: </a><font color="#B22222">     This method has one explicit stage and four implicit stages.</font>

<a name="line192">192: </a><font color="#B22222">     Options Database Key:</font>
<a name="line193">193: </a><font color="#B22222">.      -ts_arkimex_type ars443 - set arkimex type to ars443</font>

<a name="line195">195: </a><font color="#B22222">     Level: advanced</font>

<a name="line197">197: </a><font color="#B22222">     Notes:</font>
<a name="line198">198: </a><font color="#B22222">     This method is referred to as ARS(4,4,3) in &lt;https://arxiv.org/abs/1110.4375&gt;</font>

<a name="line200">200: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line201">201: </a><font color="#B22222">M*/</font>

<a name="line203">203: </a><font color="#B22222">/*MC</font>
<a name="line204">204: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEXBPR3.html">TSARKIMEXBPR3</a> - Third order ARK IMEX scheme. Referred to as ARK3 in &lt;https://arxiv.org/abs/1110.4375&gt;</font>

<a name="line206">206: </a><font color="#B22222">     This method has one explicit stage and four implicit stages.</font>

<a name="line208">208: </a><font color="#B22222">     Options Database Key:</font>
<a name="line209">209: </a><font color="#B22222">.      -ts_arkimex_type bpr3 - set arkimex type to bpr3</font>

<a name="line211">211: </a><font color="#B22222">     Level: advanced</font>

<a name="line213">213: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line214">214: </a><font color="#B22222">M*/</font>

<a name="line216">216: </a><font color="#B22222">/*MC</font>
<a name="line217">217: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX4.html">TSARKIMEX4</a> - Fourth order ARK IMEX scheme with L-stable implicit part, {cite}`kennedy_2003`.</font>

<a name="line219">219: </a><font color="#B22222">     This method has one explicit stage and four implicit stages.</font>

<a name="line221">221: </a><font color="#B22222">     Options Database Key:</font>
<a name="line222">222: </a><font color="#B22222">.      -ts_arkimex_type 4 - set arkimex type to4</font>

<a name="line224">224: </a><font color="#B22222">     Level: advanced</font>

<a name="line226">226: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line227">227: </a><font color="#B22222">M*/</font>

<a name="line229">229: </a><font color="#B22222">/*MC</font>
<a name="line230">230: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSARKIMEX5.html">TSARKIMEX5</a> - Fifth order ARK IMEX scheme with L-stable implicit part, {cite}`kennedy_2003`.</font>

<a name="line232">232: </a><font color="#B22222">     This method has one explicit stage and five implicit stages.</font>

<a name="line234">234: </a><font color="#B22222">     Options Database Key:</font>
<a name="line235">235: </a><font color="#B22222">.      -ts_arkimex_type 5 - set arkimex type to 5</font>

<a name="line237">237: </a><font color="#B22222">     Level: advanced</font>

<a name="line239">239: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`</font>
<a name="line240">240: </a><font color="#B22222">M*/</font>

<a name="line242">242: </a><font color="#B22222">/*MC</font>
<a name="line243">243: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKS212.html">TSDIRKS212</a> - Second order DIRK scheme.</font>

<a name="line245">245: </a><font color="#B22222">     This method has two implicit stages with an embedded method of other 1.</font>
<a name="line246">246: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line248">248: </a><font color="#B22222">     Options Database Key:</font>
<a name="line249">249: </a><font color="#B22222">.      -ts_dirk_type s212 - select this method.</font>

<a name="line251">251: </a><font color="#B22222">     Level: advanced</font>

<a name="line253">253: </a><font color="#B22222">     Note:</font>
<a name="line254">254: </a><font color="#B22222">     This is the default DIRK scheme in SUNDIALS.</font>

<a name="line256">256: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line257">257: </a><font color="#B22222">M*/</font>

<a name="line259">259: </a><font color="#B22222">/*MC</font>
<a name="line260">260: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES122SAL.html">TSDIRKES122SAL</a> - First order DIRK scheme &lt;https://arxiv.org/abs/1803.01613&gt;</font>

<a name="line262">262: </a><font color="#B22222">     Uses backward Euler as advancing method and trapezoidal rule as embedded method. See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line264">264: </a><font color="#B22222">     Options Database Key:</font>
<a name="line265">265: </a><font color="#B22222">.      -ts_dirk_type es122sal - select this method.</font>

<a name="line267">267: </a><font color="#B22222">     Level: advanced</font>

<a name="line269">269: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line270">270: </a><font color="#B22222">M*/</font>

<a name="line272">272: </a><font color="#B22222">/*MC</font>
<a name="line273">273: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES213SAL.html">TSDIRKES213SAL</a> - Second order DIRK scheme {cite}`kennedy2019diagonally`. Also known as TR-BDF2, see{cite}`hosea1996analysis`</font>

<a name="line275">275: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line277">277: </a><font color="#B22222">     Options Database Key:</font>
<a name="line278">278: </a><font color="#B22222">.      -ts_dirk_type es213sal - select this method.</font>

<a name="line280">280: </a><font color="#B22222">     Level: advanced</font>

<a name="line282">282: </a><font color="#B22222">     Note:</font>
<a name="line283">283: </a><font color="#B22222">     This is the default DIRK scheme used in PETSc.</font>

<a name="line285">285: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line286">286: </a><font color="#B22222">M*/</font>

<a name="line288">288: </a><font color="#B22222">/*MC</font>
<a name="line289">289: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES324SAL.html">TSDIRKES324SAL</a> - Third order DIRK scheme, {cite}`kennedy2019diagonally`</font>

<a name="line291">291: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line293">293: </a><font color="#B22222">     Options Database Key:</font>
<a name="line294">294: </a><font color="#B22222">.      -ts_dirk_type es324sal - select this method.</font>

<a name="line296">296: </a><font color="#B22222">     Level: advanced</font>

<a name="line298">298: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line299">299: </a><font color="#B22222">M*/</font>

<a name="line301">301: </a><font color="#B22222">/*MC</font>
<a name="line302">302: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES325SAL.html">TSDIRKES325SAL</a> - Third order DIRK scheme {cite}`kennedy2019diagonally`.</font>

<a name="line304">304: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line306">306: </a><font color="#B22222">     Options Database Key:</font>
<a name="line307">307: </a><font color="#B22222">.      -ts_dirk_type es325sal - select this method.</font>

<a name="line309">309: </a><font color="#B22222">     Level: advanced</font>

<a name="line311">311: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line312">312: </a><font color="#B22222">M*/</font>

<a name="line314">314: </a><font color="#B22222">/*MC</font>
<a name="line315">315: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK657A.html">TSDIRK657A</a> - Sixth order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line317">317: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line319">319: </a><font color="#B22222">     Options Database Key:</font>
<a name="line320">320: </a><font color="#B22222">.      -ts_dirk_type 657a - select this method.</font>

<a name="line322">322: </a><font color="#B22222">     Level: advanced</font>

<a name="line324">324: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line325">325: </a><font color="#B22222">M*/</font>

<a name="line327">327: </a><font color="#B22222">/*MC</font>
<a name="line328">328: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES648SA.html">TSDIRKES648SA</a> - Sixth order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line330">330: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line332">332: </a><font color="#B22222">     Options Database Key:</font>
<a name="line333">333: </a><font color="#B22222">.      -ts_dirk_type es648sa - select this method.</font>

<a name="line335">335: </a><font color="#B22222">     Level: advanced</font>

<a name="line337">337: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line338">338: </a><font color="#B22222">M*/</font>

<a name="line340">340: </a><font color="#B22222">/*MC</font>
<a name="line341">341: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK658A.html">TSDIRK658A</a> - Sixth order DIRK scheme  &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line343">343: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line345">345: </a><font color="#B22222">     Options Database Key:</font>
<a name="line346">346: </a><font color="#B22222">.      -ts_dirk_type 658a - select this method.</font>

<a name="line348">348: </a><font color="#B22222">     Level: advanced</font>

<a name="line350">350: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line351">351: </a><font color="#B22222">M*/</font>

<a name="line353">353: </a><font color="#B22222">/*MC</font>
<a name="line354">354: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKS659A.html">TSDIRKS659A</a> - Sixth order DIRK scheme  &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line356">356: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line358">358: </a><font color="#B22222">     Options Database Key:</font>
<a name="line359">359: </a><font color="#B22222">.      -ts_dirk_type s659a - select this method.</font>

<a name="line361">361: </a><font color="#B22222">     Level: advanced</font>

<a name="line363">363: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line364">364: </a><font color="#B22222">M*/</font>

<a name="line366">366: </a><font color="#B22222">/*MC</font>
<a name="line367">367: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK7510SAL.html">TSDIRK7510SAL</a> - Seventh order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line369">369: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line371">371: </a><font color="#B22222">     Options Database Key:</font>
<a name="line372">372: </a><font color="#B22222">.      -ts_dirk_type 7510sal - select this method.</font>

<a name="line374">374: </a><font color="#B22222">     Level: advanced</font>

<a name="line376">376: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line377">377: </a><font color="#B22222">M*/</font>

<a name="line379">379: </a><font color="#B22222">/*MC</font>
<a name="line380">380: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES7510SA.html">TSDIRKES7510SA</a> - Seventh order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line382">382: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line384">384: </a><font color="#B22222">     Options Database Key:</font>
<a name="line385">385: </a><font color="#B22222">.      -ts_dirk_type es7510sa - select this method.</font>

<a name="line387">387: </a><font color="#B22222">     Level: advanced</font>

<a name="line389">389: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line390">390: </a><font color="#B22222">M*/</font>

<a name="line392">392: </a><font color="#B22222">/*MC</font>
<a name="line393">393: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK759A.html">TSDIRK759A</a> - Seventh order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line395">395: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line397">397: </a><font color="#B22222">     Options Database Key:</font>
<a name="line398">398: </a><font color="#B22222">.      -ts_dirk_type 759a - select this method.</font>

<a name="line400">400: </a><font color="#B22222">     Level: advanced</font>

<a name="line402">402: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line403">403: </a><font color="#B22222">M*/</font>

<a name="line405">405: </a><font color="#B22222">/*MC</font>
<a name="line406">406: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKS7511SAL.html">TSDIRKS7511SAL</a> - Seventh order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line408">408: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line410">410: </a><font color="#B22222">     Options Database Key:</font>
<a name="line411">411: </a><font color="#B22222">.      -ts_dirk_type s7511sal - select this method.</font>

<a name="line413">413: </a><font color="#B22222">     Level: advanced</font>

<a name="line415">415: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line416">416: </a><font color="#B22222">M*/</font>

<a name="line418">418: </a><font color="#B22222">/*MC</font>
<a name="line419">419: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK8614A.html">TSDIRK8614A</a> - Eighth order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line421">421: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line423">423: </a><font color="#B22222">     Options Database Key:</font>
<a name="line424">424: </a><font color="#B22222">.      -ts_dirk_type 8614a - select this method.</font>

<a name="line426">426: </a><font color="#B22222">     Level: advanced</font>

<a name="line428">428: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line429">429: </a><font color="#B22222">M*/</font>

<a name="line431">431: </a><font color="#B22222">/*MC</font>
<a name="line432">432: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRK8616SAL.html">TSDIRK8616SAL</a> - Eighth order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line434">434: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line436">436: </a><font color="#B22222">     Options Database Key:</font>
<a name="line437">437: </a><font color="#B22222">.      -ts_dirk_type 8616sal - select this method.</font>

<a name="line439">439: </a><font color="#B22222">     Level: advanced</font>

<a name="line441">441: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line442">442: </a><font color="#B22222">M*/</font>

<a name="line444">444: </a><font color="#B22222">/*MC</font>
<a name="line445">445: </a><font color="#B22222">     <a href="../../../../manualpages/TS/TSDIRKES8516SAL.html">TSDIRKES8516SAL</a> - Eighth order DIRK scheme &lt;https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs&gt;</font>

<a name="line447">447: </a><font color="#B22222">     See `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` for additional details.</font>

<a name="line449">449: </a><font color="#B22222">     Options Database Key:</font>
<a name="line450">450: </a><font color="#B22222">.      -ts_dirk_type es8516sal - select this method.</font>

<a name="line452">452: </a><font color="#B22222">     Level: advanced</font>

<a name="line454">454: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line455">455: </a><font color="#B22222">M*/</font>

<a name="line457">457: </a><strong><font color="#4169E1"><a name="TSHasRHSFunction"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSHasRHSFunction(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *has)</font></strong>
<a name="line458">458: </a>{
<a name="line459">459: </a>  <a href="../../../../manualpages/TS/TSRHSFunction.html">TSRHSFunction</a> func;

<a name="line461">461: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line462">462: </a>  *has = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line463">463: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/DMTSGetRHSFunction.html">DMTSGetRHSFunction</a>(ts-&gt;dm, &amp;func, NULL));
<a name="line464">464: </a>  <font color="#4169E1">if</font> (func) *has = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line465">465: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line466">466: </a>}

<a name="line468">468: </a><font color="#B22222">/*@C</font>
<a name="line469">469: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXRegisterAll.html">TSARKIMEXRegisterAll</a> - Registers all of the additive Runge-Kutta implicit-explicit methods in `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`</font>

<a name="line471">471: </a><font color="#B22222">  Not Collective, but should be called by all processes which will need the schemes to be registered</font>

<a name="line473">473: </a><font color="#B22222">  Level: advanced</font>

<a name="line475">475: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TS.html">TS</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXRegisterDestroy.html">TSARKIMEXRegisterDestroy</a>()`</font>
<a name="line476">476: </a><font color="#B22222">@*/</font>
<a name="line477">477: </a><strong><font color="#4169E1"><a name="TSARKIMEXRegisterAll"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXRegisterAll.html">TSARKIMEXRegisterAll</a>(void)</font></strong>
<a name="line478">478: </a>{
<a name="line479">479: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line480">480: </a>  <font color="#4169E1">if</font> (TSARKIMEXRegisterAllCalled) <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line481">481: </a>  TSARKIMEXRegisterAllCalled = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;

<a name="line483">483: </a><strong><font color="#228B22">#define RC  PetscRealConstant</font></strong>
<a name="line484">484: </a><strong><font color="#228B22">#define s2  RC(1.414213562373095048802)  </font><font color="#B22222">/* PetscSqrtReal((<a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>)2.0) */</font><font color="#228B22"></font></strong>
<a name="line485">485: </a><strong><font color="#228B22">#define us2 RC(0.2928932188134524755992) </font><font color="#B22222">/* 1.0-1.0/PetscSqrtReal((<a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>)2.0); */</font><font color="#228B22"></font></strong>

<a name="line487">487: </a>  <font color="#B22222">/* Diagonally implicit methods */</font>
<a name="line488">488: </a>  {
<a name="line489">489: </a>    <font color="#B22222">/* DIRK212, default of SUNDIALS */</font>
<a name="line490">490: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[2][2] = {
<a name="line491">491: </a>      {RC(1.0),  RC(0.0)},
<a name="line492">492: </a>      {RC(-1.0), RC(1.0)}
<a name="line493">493: </a>    };
<a name="line494">494: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[2]      = {RC(0.5), RC(0.5)};
<a name="line495">495: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[2] = {RC(1.0), RC(0.0)};
<a name="line496">496: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKS212.html">TSDIRKS212</a>, 2, 2, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line497">497: </a>  }

<a name="line499">499: </a>  {
<a name="line500">500: </a>    <font color="#B22222">/* ESDIRK12 from https://arxiv.org/pdf/1803.01613.pdf */</font>
<a name="line501">501: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[2][2] = {
<a name="line502">502: </a>      {RC(0.0), RC(0.0)},
<a name="line503">503: </a>      {RC(0.0), RC(1.0)}
<a name="line504">504: </a>    };
<a name="line505">505: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[2]      = {RC(0.0), RC(1.0)};
<a name="line506">506: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[2] = {RC(0.5), RC(0.5)};
<a name="line507">507: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES122SAL.html">TSDIRKES122SAL</a>, 1, 2, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line508">508: </a>  }

<a name="line510">510: </a>  {
<a name="line511">511: </a>    <font color="#B22222">/* ESDIRK213L[2]SA from KC16.</font>
<a name="line512">512: </a><font color="#B22222">       TR-BDF2 from Hosea and Shampine</font>
<a name="line513">513: </a><font color="#B22222">       ESDIRK23 in https://arxiv.org/pdf/1803.01613.pdf */</font>
<a name="line514">514: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line515">515: </a>      {RC(0.0),      RC(0.0),      RC(0.0)},
<a name="line516">516: </a>      {us2,          us2,          RC(0.0)},
<a name="line517">517: </a>      {s2 / RC(4.0), s2 / RC(4.0), us2    },
<a name="line518">518: </a>    };
<a name="line519">519: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[3]      = {s2 / RC(4.0), s2 / RC(4.0), us2};
<a name="line520">520: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[3] = {(RC(1.0) - s2 / RC(4.0)) / RC(3.0), (RC(3.0) * s2 / RC(4.0) + RC(1.0)) / RC(3.0), us2 / RC(3.0)};
<a name="line521">521: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES213SAL.html">TSDIRKES213SAL</a>, 2, 3, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line522">522: </a>  }

<a name="line524">524: </a>  {
<a name="line525">525: </a><strong><font color="#228B22">#define g   RC(0.43586652150845899941601945)</font></strong>
<a name="line526">526: </a><strong><font color="#228B22">#define g2  <a href="../../../../manualpages/Sys/PetscSqr.html">PetscSqr</a>(g)</font></strong>
<a name="line527">527: </a><strong><font color="#228B22">#define g3  g *g2</font></strong>
<a name="line528">528: </a><strong><font color="#228B22">#define g4  <a href="../../../../manualpages/Sys/PetscSqr.html">PetscSqr</a>(g2)</font></strong>
<a name="line529">529: </a><strong><font color="#228B22">#define g5  g *g4</font></strong>
<a name="line530">530: </a><strong><font color="#228B22">#define c3  RC(1.0)</font></strong>
<a name="line531">531: </a><strong><font color="#228B22">#define a32 c3 *(c3 - RC(2.0) * g) / (RC(4.0) * g)</font></strong>
<a name="line532">532: </a><strong><font color="#228B22">#define b2  (-RC(2.0) + RC(3.0) * c3 + RC(6.0) * g * (RC(1.0) - c3)) / (RC(12.0) * g * (c3 - RC(2.0) * g))</font></strong>
<a name="line533">533: </a><strong><font color="#228B22">#define b3  (RC(1.0) - RC(6.0) * g + RC(6.0) * g2) / (RC(3.0) * c3 * (c3 - RC(2.0) * g))</font></strong>
<a name="line534">534: </a><font color="#A020F0">#if 0</font>
<a name="line535">535: </a><font color="#B22222">/* This is for c3 = 3/5 */</font>
<a name="line536">536: </a><strong><font color="#228B22">  #define bh2 \</font></strong>
<a name="line537">537: </a><strong><font color="#228B22">    c3 * (-RC(1.0) + RC(6.0) * g - RC(23.0) * g3 + RC(12.0) * g4 - RC(6.0) * g5) / (RC(4.0) * (RC(2.0) * g - c3) * (RC(1.0) - RC(6.0) * g + RC(6.0) * g2)) + (RC(3.0) - RC(27.0) * g + RC(68.0) * g2 - RC(55.0) * g3 + RC(21.0) * g4 - RC(6.0) * g5) / (RC(2.0) * (RC(2.0) * g - c3) * (RC(1.0) - RC(6.0) * g + RC(6.0) * g2))</font></strong>
<a name="line538">538: </a><strong><font color="#228B22">  #define bh3 -g * (-RC(2.0) + RC(21.0) * g - RC(68.0) * g2 + RC(79.0) * g3 - RC(33.0) * g4 + RC(12.0) * g5) / (RC(2.0) * (RC(2.0) * g - c3) * (RC(1.0) - RC(6.0) * g + RC(6.0) * g2))</font></strong>
<a name="line539">539: </a><strong><font color="#228B22">  #define bh4 -RC(3.0) * g2 * (-RC(1.0) + RC(4.0) * g - RC(2.0) * g2 + g3) / (RC(1.0) - RC(6.0) * g + RC(6.0) * g2)</font></strong>
<a name="line540">540: </a><font color="#A020F0">#else</font>
<a name="line541">541: </a>  <font color="#B22222">/* This is for c3 = 1.0 */</font>
<a name="line542">542: </a><strong><font color="#228B22">  #define bh2 a32</font></strong>
<a name="line543">543: </a><strong><font color="#228B22">  #define bh3 g</font></strong>
<a name="line544">544: </a><strong><font color="#228B22">  #define bh4 RC(0.0)</font></strong>
<a name="line545">545: </a><font color="#A020F0">#endif</font>
<a name="line546">546: </a>    <font color="#B22222">/* ESDIRK3(2I)4L[2]SA from KC16 with c3 = 1.0 */</font>
<a name="line547">547: </a>    <font color="#B22222">/* Given by Kvaerno https://link.springer.com/article/10.1023/b:bitn.0000046811.70614.38 */</font>
<a name="line548">548: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[4][4] = {
<a name="line549">549: </a>      {RC(0.0),               RC(0.0), RC(0.0), RC(0.0)},
<a name="line550">550: </a>      {g,                     g,       RC(0.0), RC(0.0)},
<a name="line551">551: </a>      {c3 - a32 - g,          a32,     g,       RC(0.0)},
<a name="line552">552: </a>      {RC(1.0) - b2 - b3 - g, b2,      b3,      g      },
<a name="line553">553: </a>    };
<a name="line554">554: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[4]      = {RC(1.0) - b2 - b3 - g, b2, b3, g};
<a name="line555">555: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[4] = {RC(1.0) - bh2 - bh3 - bh4, bh2, bh3, bh4};
<a name="line556">556: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES324SAL.html">TSDIRKES324SAL</a>, 3, 4, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line557">557: </a><strong><font color="#228B22">#undef g</font></strong>
<a name="line558">558: </a><strong><font color="#228B22">#undef g2</font></strong>
<a name="line559">559: </a><strong><font color="#228B22">#undef g3</font></strong>
<a name="line560">560: </a><strong><font color="#228B22">#undef c3</font></strong>
<a name="line561">561: </a><strong><font color="#228B22">#undef a32</font></strong>
<a name="line562">562: </a><strong><font color="#228B22">#undef b2</font></strong>
<a name="line563">563: </a><strong><font color="#228B22">#undef b3</font></strong>
<a name="line564">564: </a><strong><font color="#228B22">#undef bh2</font></strong>
<a name="line565">565: </a><strong><font color="#228B22">#undef bh3</font></strong>
<a name="line566">566: </a><strong><font color="#228B22">#undef bh4</font></strong>
<a name="line567">567: </a>  }

<a name="line569">569: </a>  {
<a name="line570">570: </a>    <font color="#B22222">/* ESDIRK3(2I)5L[2]SA from KC16 */</font>
<a name="line571">571: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[5][5] = {
<a name="line572">572: </a>      {RC(0.0),                  RC(0.0),                  RC(0.0),                 RC(0.0),                   RC(0.0)           },
<a name="line573">573: </a>      {RC(9.0) / RC(40.0),       RC(9.0) / RC(40.0),       RC(0.0),                 RC(0.0),                   RC(0.0)           },
<a name="line574">574: </a>      {RC(19.0) / RC(72.0),      RC(14.0) / RC(45.0),      RC(9.0) / RC(40.0),      RC(0.0),                   RC(0.0)           },
<a name="line575">575: </a>      {RC(3337.0) / RC(11520.0), RC(233.0) / RC(720.0),    RC(207.0) / RC(1280.0),  RC(9.0) / RC(40.0),        RC(0.0)           },
<a name="line576">576: </a>      {RC(7415.0) / RC(34776.0), RC(9920.0) / RC(30429.0), RC(4845.0) / RC(9016.0), -RC(5827.0) / RC(19320.0), RC(9.0) / RC(40.0)},
<a name="line577">577: </a>    };
<a name="line578">578: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[5]      = {RC(7415.0) / RC(34776.0), RC(9920.0) / RC(30429.0), RC(4845.0) / RC(9016.0), -RC(5827.0) / RC(19320.0), RC(9.0) / RC(40.0)};
<a name="line579">579: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[5] = {RC(23705.0) / RC(104328.0), RC(29720.0) / RC(91287.0), RC(4225.0) / RC(9016.0), -RC(69304987.0) / RC(337732920.0), RC(42843.0) / RC(233080.0)};
<a name="line580">580: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES325SAL.html">TSDIRKES325SAL</a>, 3, 5, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line581">581: </a>  }

<a name="line583">583: </a>  {
<a name="line584">584: </a>    // DIRK(6,6)[1]A[(7,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line585">585: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[7][7] = {
<a name="line586">586: </a>      {RC(0.303487844706747),    RC(0.0),                RC(0.0),                   RC(0.0),                   RC(0.0),                 RC(0.0),                RC(0.0)              },
<a name="line587">587: </a>      {RC(-0.279756492709814),   RC(0.500032236020747),  RC(0.0),                   RC(0.0),                   RC(0.0),                 RC(0.0),                RC(0.0)              },
<a name="line588">588: </a>      {RC(0.280583215743895),    RC(-0.438560061586751), RC(0.217250734515736),     RC(0.0),                   RC(0.0),                 RC(0.0),                RC(0.0)              },
<a name="line589">589: </a>      {RC(-0.0677678738539846),  RC(0.984312781232293),  RC(-0.266720192540149),    RC(0.2476680834526),       RC(0.0),                 RC(0.0),                RC(0.0)              },
<a name="line590">590: </a>      {RC(0.125671616147993),    RC(-0.995401751002415), RC(0.761333109549059),     RC(-0.210281837202208),    RC(0.866743712636936),   RC(0.0),                RC(0.0)              },
<a name="line591">591: </a>      {RC(-0.368056238801488),   RC(-0.999928082701516), RC(0.534734253232519),     RC(-0.174856916279082),    RC(0.615007160285509),   RC(0.696549912132029),  RC(0.0)              },
<a name="line592">592: </a>      {RC(-0.00570546839653984), RC(-0.113110431835656), RC(-0.000965563207671587), RC(-0.000130490084629567), RC(0.00111737736895673), RC(-0.279385587378871), RC(0.618455906845342)}
<a name="line593">593: </a>    };
<a name="line594">594: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[7]      = {RC(0.257561510484877), RC(0.234281287047716), RC(0.126658904241469), RC(0.252363215441784), RC(0.396701083526306), RC(-0.267566000742152), RC(0.0)};
<a name="line595">595: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[7] = {RC(0.257561510484945), RC(0.387312822934391), RC(0.126658904241468), RC(0.252363215441784), RC(0.396701083526306), RC(-0.267566000742225), RC(-0.153031535886669)};
<a name="line596">596: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK657A.html">TSDIRK657A</a>, 6, 7, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line597">597: </a>  }
<a name="line598">598: </a>  {
<a name="line599">599: </a>    // ESDIRK(8,6)[2]SA[(8,4)] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line600">600: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[8][8] = {
<a name="line601">601: </a>      {RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),                RC(0.0),                RC(0.0),               RC(0.0)              },
<a name="line602">602: </a>      {RC(0.333222149217725),  RC(0.333222149217725),   RC(0.0),                 RC(0.0),               RC(0.0),                RC(0.0),                RC(0.0),               RC(0.0)              },
<a name="line603">603: </a>      {RC(0.0639743773182214), RC(-0.0830330224410214), RC(0.333222149217725),   RC(0.0),               RC(0.0),                RC(0.0),                RC(0.0),               RC(0.0)              },
<a name="line604">604: </a>      {RC(-0.728522201369326), RC(-0.210414479522485),  RC(0.532519916559342),   RC(0.333222149217725), RC(0.0),                RC(0.0),                RC(0.0),               RC(0.0)              },
<a name="line605">605: </a>      {RC(-0.175135269272067), RC(0.666675582067552),   RC(-0.304400907370867),  RC(0.656797712445756), RC(0.333222149217725),  RC(0.0),                RC(0.0),               RC(0.0)              },
<a name="line606">606: </a>      {RC(0.222695802705462),  RC(-0.0948971794681061), RC(-0.0234336346686545), RC(-0.45385925012042), RC(0.0283910313826958), RC(0.333222149217725),  RC(0.0),               RC(0.0)              },
<a name="line607">607: </a>      {RC(-0.132534078051299), RC(0.702597935004879),   RC(-0.433316453128078),  RC(0.893717488547587), RC(0.057381454791406),  RC(-0.207798411552402), RC(0.333222149217725), RC(0.0)              },
<a name="line608">608: </a>      {RC(0.0802253121418085), RC(0.281196044671022),   RC(0.406758926172157),   RC(-0.01945708512416), RC(-0.41785600088526),  RC(0.0545342658870322), RC(0.281376387919675), RC(0.333222149217725)}
<a name="line609">609: </a>    };
<a name="line610">610: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[8]      = {RC(0.0802253121418085), RC(0.281196044671022), RC(0.406758926172157), RC(-0.01945708512416), RC(-0.41785600088526), RC(0.0545342658870322), RC(0.281376387919675), RC(0.333222149217725)};
<a name="line611">611: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[8] = {RC(0.0), RC(0.292331064554014), RC(0.409676102283681), RC(-0.002094718084982), RC(-0.282771520835975), RC(0.113862336644901), RC(0.181973572260693), RC(0.287023163177669)};
<a name="line612">612: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES648SA.html">TSDIRKES648SA</a>, 6, 8, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line613">613: </a>  }
<a name="line614">614: </a>  {
<a name="line615">615: </a>    // DIRK(8,6)[1]SAL[(8,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line616">616: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[8][8] = {
<a name="line617">617: </a>      {RC(0.477264457385826),    RC(0.0),                RC(0.0),                   RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                 RC(0.0)              },
<a name="line618">618: </a>      {RC(-0.197052588415002),   RC(0.476363428459584),  RC(0.0),                   RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                 RC(0.0)              },
<a name="line619">619: </a>      {RC(-0.0347674430372966),  RC(0.633051807335483),  RC(0.193634310075028),     RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                 RC(0.0)              },
<a name="line620">620: </a>      {RC(0.0967797668578702),   RC(-0.193533526466535), RC(-0.000207622945800473), RC(0.159572204849431),   RC(0.0),                RC(0.0),                RC(0.0),                 RC(0.0)              },
<a name="line621">621: </a>      {RC(0.162527231819875),    RC(-0.249672513547382), RC(-0.0459079972041795),   RC(0.36579476400859),    RC(0.255752838307699),  RC(0.0),                RC(0.0),                 RC(0.0)              },
<a name="line622">622: </a>      {RC(-0.00707603197171262), RC(0.846299854860295),  RC(0.344020016925018),     RC(-0.0720926054548865), RC(-0.215492331980875), RC(0.104341097622161),  RC(0.0),                 RC(0.0)              },
<a name="line623">623: </a>      {RC(0.00176857935179744),  RC(0.0779960013127515), RC(0.303333277564557),     RC(0.213160806732836),   RC(0.351769320319038),  RC(-0.381545894386538), RC(0.433517909105558),   RC(0.0)              },
<a name="line624">624: </a>      {RC(0.0),                  RC(0.22732353410559),   RC(0.308415837980118),     RC(0.157263419573007),   RC(0.243551137152275),  RC(-0.120953626732831), RC(-0.0802678473399899), RC(0.264667545261832)}
<a name="line625">625: </a>    };
<a name="line626">626: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[8]      = {RC(0.0), RC(0.22732353410559), RC(0.308415837980118), RC(0.157263419573007), RC(0.243551137152275), RC(-0.120953626732831), RC(-0.0802678473399899), RC(0.264667545261832)};
<a name="line627">627: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[8] = {RC(0.0), RC(0.22732353410559), RC(0.308415837980118), RC(0.157263419573007), RC(0.243551137152275), RC(-0.103483943222765), RC(-0.0103721771642262), RC(0.177302191576001)};
<a name="line628">628: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK658A.html">TSDIRK658A</a>, 6, 8, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line629">629: </a>  }
<a name="line630">630: </a>  {
<a name="line631">631: </a>    // SDIRK(9,6)[1]SAL[(9,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line632">632: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[9][9] = {
<a name="line633">633: </a>      {RC(0.218127781944908),   RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line634">634: </a>      {RC(-0.0903514856119419), RC(0.218127781944908),  RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line635">635: </a>      {RC(0.172952039138937),   RC(-0.35365501036282),  RC(0.218127781944908),   RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line636">636: </a>      {RC(0.511999875919193),   RC(0.0289640332201925), RC(-0.0144030945657094), RC(0.218127781944908),   RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line637">637: </a>      {RC(0.00465303495506782), RC(-0.075635818766597), RC(0.217273030786712),   RC(-0.0206519428725472), RC(0.218127781944908),  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line638">638: </a>      {RC(0.896145501762472),   RC(0.139267327700498),  RC(-0.186920979752805),  RC(0.0672971012371723),  RC(-0.350891963442176), RC(0.218127781944908),  RC(0.0),                RC(0.0),                RC(0.0)              },
<a name="line639">639: </a>      {RC(0.552959701885751),   RC(-0.439360579793662), RC(0.333704002325091),   RC(-0.0339426520778416), RC(-0.151947445912595), RC(0.0213825661026943), RC(0.218127781944908),  RC(0.0),                RC(0.0)              },
<a name="line640">640: </a>      {RC(0.631360374036476),   RC(0.724733619641466),  RC(-0.432170625425258),  RC(0.598611382182477),   RC(-0.709087197034345), RC(-0.483986685696934), RC(0.378391562905131),  RC(0.218127781944908),  RC(0.0)              },
<a name="line641">641: </a>      {RC(0.0),                 RC(-0.15504452530869),  RC(0.194518478660789),   RC(0.63515640279203),    RC(0.81172278664173),   RC(0.110736108691585),  RC(-0.495304692414479), RC(-0.319912341007872), RC(0.218127781944908)}
<a name="line642">642: </a>    };
<a name="line643">643: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[9]      = {RC(0.0), RC(-0.15504452530869), RC(0.194518478660789), RC(0.63515640279203), RC(0.81172278664173), RC(0.110736108691585), RC(-0.495304692414479), RC(-0.319912341007872), RC(0.218127781944908)};
<a name="line644">644: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[9] = {RC(3.62671059311602e-16), RC(0.0736615558278942), RC(0.103527397262229), RC(1.00247481935499), RC(0.361377289250057), RC(-0.785425929961365), RC(-0.0170499047960784), RC(0.296321252214769), RC(-0.0348864791524953)};
<a name="line645">645: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKS659A.html">TSDIRKS659A</a>, 6, 9, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line646">646: </a>  }
<a name="line647">647: </a>  {
<a name="line648">648: </a>    // DIRK(10,7)[1]SAL[(10,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line649">649: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[10][10] = {
<a name="line650">650: </a>      {RC(0.233704632125264),   RC(0.0),                RC(0.0),                  RC(0.0),                  RC(0.0),                   RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line651">651: </a>      {RC(-0.0739324813149407), RC(0.200056838146104),  RC(0.0),                  RC(0.0),                  RC(0.0),                   RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line652">652: </a>      {RC(0.0943790344044812),  RC(0.264056067701605),  RC(0.133245202456465),    RC(0.0),                  RC(0.0),                   RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line653">653: </a>      {RC(0.269084810601201),   RC(-0.503479002548384), RC(-0.00486736469695022), RC(0.251518716213569),    RC(0.0),                   RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line654">654: </a>      {RC(0.145665801918423),   RC(0.204983170463176),  RC(0.407154634069484),    RC(-0.0121039135200389),  RC(0.190243622486334),     RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line655">655: </a>      {RC(0.985450198547345),   RC(0.806942652811456),  RC(-0.808130934167263),   RC(-0.669035819439391),   RC(0.0269384406756128),    RC(0.462144080607327),    RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line656">656: </a>      {RC(0.163902957809563),   RC(0.228315094960095),  RC(0.0745971021260249),   RC(0.000509793400156559), RC(0.0166533681378294),    RC(-0.0229383879045797),  RC(0.103505486637336),  RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line657">657: </a>      {RC(-0.162694156858437),  RC(0.0453478837428434), RC(0.997443481211424),    RC(0.200251514941093),    RC(-0.000161755458839048), RC(-0.0848134335980281),  RC(-0.36438666566666),  RC(0.158604420136055),   RC(0.0),               RC(0.0)              },
<a name="line658">658: </a>      {RC(0.200733156477425),   RC(0.239686443444433),  RC(0.303837014418929),    RC(-0.0534390596279896),  RC(0.0314067599640569),    RC(-0.00764032790448536), RC(0.0609191260198661), RC(-0.0736319201590642), RC(0.204602530607021), RC(0.0)              },
<a name="line659">659: </a>      {RC(0.0),                 RC(0.235563761744267),  RC(0.658651488684319),    RC(0.0308877804992098),   RC(-0.906514945595336),    RC(-0.0248488551739974),  RC(-0.309967582365257), RC(0.191663316925525),   RC(0.923933712199542), RC(0.200631323081727)}
<a name="line660">660: </a>    };
<a name="line661">661: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[10] = {RC(0.0), RC(0.235563761744267), RC(0.658651488684319), RC(0.0308877804992098), RC(-0.906514945595336), RC(-0.0248488551739974), RC(-0.309967582365257), RC(0.191663316925525), RC(0.923933712199542), RC(0.200631323081727)};
<a name="line662">662: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[10] =
<a name="line663">663: </a>      {RC(0.0), RC(0.222929376486581), RC(0.950668440138169), RC(0.0342694607044032), RC(0.362875840545746), RC(0.223572979288581), RC(-0.764361723526727), RC(0.563476909230026), RC(-0.690896961894185), RC(0.0974656790270323)};
<a name="line664">664: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK7510SAL.html">TSDIRK7510SAL</a>, 7, 10, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line665">665: </a>  }
<a name="line666">666: </a>  {
<a name="line667">667: </a>    // ESDIRK(10,7)[2]SA[(10,5)] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line668">668: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[10][10] = {
<a name="line669">669: </a>      {RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line670">670: </a>      {RC(0.210055790203419),   RC(0.210055790203419),   RC(0.0),                 RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line671">671: </a>      {RC(0.255781739921086),   RC(0.239850916980976),   RC(0.210055790203419),   RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line672">672: </a>      {RC(0.286789624880437),   RC(0.230494748834778),   RC(0.263925149885491),   RC(0.210055790203419),    RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line673">673: </a>      {RC(-0.0219118128774335), RC(0.897684380345907),   RC(-0.657954605498907),  RC(0.124962304722633),    RC(0.210055790203419),    RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line674">674: </a>      {RC(-0.065614879584776),  RC(-0.0565630711859497), RC(0.0254881105065311),  RC(-0.00368981790650006), RC(-0.0115178258446329),  RC(0.210055790203419),    RC(0.0),                RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line675">675: </a>      {RC(0.399860851232098),   RC(0.915588469718705),   RC(-0.0758429094934412), RC(-0.263369154872759),   RC(0.719687583564526),    RC(-0.787410407015369),   RC(0.210055790203419),  RC(0.0),                 RC(0.0),               RC(0.0)              },
<a name="line676">676: </a>      {RC(0.51693616104628),    RC(1.00000540846973),    RC(-0.0485110663289207), RC(-0.315208041581942),   RC(0.749742806451587),    RC(-0.990975090921248),   RC(0.0159279583407308), RC(0.210055790203419),   RC(0.0),               RC(0.0)              },
<a name="line677">677: </a>      {RC(-0.0303062129076945), RC(-0.297035174659034),  RC(0.184724697462164),   RC(-0.0351876079516183),  RC(-0.00324668230690761), RC(0.216151004053531),    RC(-0.126676252098317), RC(0.114040254365262),   RC(0.210055790203419), RC(0.0)              },
<a name="line678">678: </a>      {RC(0.0705997961586714),  RC(-0.0281516061956374), RC(0.314600470734633),   RC(-0.0907057557963371),  RC(0.168078953957742),    RC(-0.00655694984590575), RC(0.0505384497804303), RC(-0.0569572058725042), RC(0.368498056875488), RC(0.210055790203419)}
<a name="line679">679: </a>    };
<a name="line680">680: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[10]      = {RC(0.0705997961586714),   RC(-0.0281516061956374), RC(0.314600470734633),   RC(-0.0907057557963371), RC(0.168078953957742),
<a name="line681">681: </a>                                  RC(-0.00655694984590575), RC(0.0505384497804303),  RC(-0.0569572058725042), RC(0.368498056875488),   RC(0.210055790203419)};
<a name="line682">682: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[10] = {RC(-0.015494246543626), RC(0.167657963820093), RC(0.269858958144236),  RC(-0.0443258997755156), RC(0.150049236875266),
<a name="line683">683: </a>                                  RC(0.259452082755846),  RC(0.244624573502521), RC(-0.215528446920284), RC(0.0487601760292619),  RC(0.134945602112201)};
<a name="line684">684: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES7510SA.html">TSDIRKES7510SA</a>, 7, 10, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line685">685: </a>  }
<a name="line686">686: </a>  {
<a name="line687">687: </a>    // DIRK(9,7)[1]A[(9,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line688">688: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[9][9] = {
<a name="line689">689: </a>      {RC(0.179877789855839),   RC(0.0),                 RC(0.0),                RC(0.0),                  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line690">690: </a>      {RC(-0.100405844885157),  RC(0.214948590644819),   RC(0.0),                RC(0.0),                  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line691">691: </a>      {RC(0.112251360198995),   RC(-0.206162139150298),  RC(0.125159642941958),  RC(0.0),                  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line692">692: </a>      {RC(-0.0335164000768257), RC(0.999942349946143),   RC(-0.491470853833294), RC(0.19820086325566),     RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line693">693: </a>      {RC(-0.0417345265478321), RC(0.187864510308215),   RC(0.0533789224305102), RC(-0.00822060284862916), RC(0.127670843671646),  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line694">694: </a>      {RC(-0.0278257925239257), RC(0.600979340683382),   RC(-0.242632273241134), RC(-0.11318753652081),    RC(0.164326917632931),  RC(0.284116597781395),  RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line695">695: </a>      {RC(0.041465583858922),   RC(0.429657872601836),   RC(-0.381323410582524), RC(0.391934277498434),    RC(-0.245918275501241), RC(-0.35960669741231),  RC(0.184000022289158),  RC(0.0),                RC(0.0)               },
<a name="line696">696: </a>      {RC(-0.105565651574538),  RC(-0.0557833155018609), RC(0.358967568942643),  RC(-0.13489263413921),    RC(0.129553247260677),  RC(0.0992493795371489), RC(-0.15716610563461),  RC(0.17918862279814),   RC(0.0)               },
<a name="line697">697: </a>      {RC(0.00439696079965225), RC(0.960250486570491),   RC(0.143558372286706),  RC(0.0819015241056593),   RC(0.999562318563625),  RC(0.325203439314358),  RC(-0.679013149331228), RC(-0.990589559837246), RC(0.0773648037639896)}
<a name="line698">698: </a>    };

<a name="line700">700: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[9]      = {RC(0.0), RC(0.179291520437966), RC(0.115310295273026), RC(-0.857943261453138), RC(0.654911318641998), RC(1.18713633508094), RC(-0.0949482361570542), RC(-0.37661430946407), RC(0.19285633764033)};
<a name="line701">701: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[9] = {RC(0.0), RC(0.1897135479408), RC(0.127461414808862), RC(-0.835810807663404), RC(0.665114177777166), RC(1.16481046518346), RC(-0.11661858889792), RC(-0.387303251022099), RC(0.192633041873135)};
<a name="line702">702: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK759A.html">TSDIRK759A</a>, 7, 9, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line703">703: </a>  }
<a name="line704">704: </a>  {
<a name="line705">705: </a>    // SDIRK(11,7)[1]SAL[(11,5)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line706">706: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[11][11] = {
<a name="line707">707: </a>      {RC(0.200252661187742),  RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line708">708: </a>      {RC(-0.082947368165267), RC(0.200252661187742),   RC(0.0),                  RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line709">709: </a>      {RC(0.483452690540751),  RC(0.0),                 RC(0.200252661187742),    RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line710">710: </a>      {RC(0.771076453481321),  RC(-0.22936926341842),   RC(0.289733373208823),    RC(0.200252661187742),   RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line711">711: </a>      {RC(0.0329683054968892), RC(-0.162397421903366),  RC(0.000951777538562805), RC(0.0),                 RC(0.200252661187742),   RC(0.0),                 RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line712">712: </a>      {RC(0.265888743485945),  RC(0.606743151103931),   RC(0.173443800537369),    RC(-0.0433968261546912), RC(-0.385211017224481),  RC(0.200252661187742),   RC(0.0),                 RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line713">713: </a>      {RC(0.220662294551146),  RC(-0.0465078507657608), RC(-0.0333111995282464),  RC(0.011801580836998),   RC(0.169480801030105),   RC(-0.0167974432139385), RC(0.200252661187742),   RC(0.0),                 RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line714">714: </a>      {RC(0.323099728365267),  RC(0.0288371831672575),  RC(-0.0543404318773196),  RC(0.0137765831431662),  RC(0.0516799019060702),  RC(-0.0421359763835713), RC(0.181297932037826),   RC(0.200252661187742),   RC(0.0),               RC(0.0),               RC(0.0)              },
<a name="line715">715: </a>      {RC(-0.164226696476538), RC(0.187552004946792),   RC(0.0628674420973025),   RC(-0.0108886582703428), RC(-0.0117628641717889), RC(0.0432176880867965),  RC(-0.0315206836275473), RC(-0.0846007021638797), RC(0.200252661187742), RC(0.0),               RC(0.0)              },
<a name="line716">716: </a>      {RC(0.651428598623771),  RC(-0.10208078475356),   RC(0.198305701801888),    RC(-0.0117354096673789), RC(-0.0440385966743686), RC(-0.0358364455795087), RC(-0.0075408087654097), RC(0.160320941654639),   RC(0.017940248694499), RC(0.200252661187742), RC(0.0)              },
<a name="line717">717: </a>      {RC(0.0),                RC(-0.266259448580236),  RC(-0.615982357748271),   RC(0.561474126687165),   RC(0.266911112787025),   RC(0.219775952207137),   RC(0.387847665451514),   RC(0.612483137773236),   RC(0.330027015806089), RC(-0.6965298655714),  RC(0.200252661187742)}
<a name="line718">718: </a>    };
<a name="line719">719: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[11] =
<a name="line720">720: </a>      {RC(0.0), RC(-0.266259448580236), RC(-0.615982357748271), RC(0.561474126687165), RC(0.266911112787025), RC(0.219775952207137), RC(0.387847665451514), RC(0.612483137773236), RC(0.330027015806089), RC(-0.6965298655714), RC(0.200252661187742)};
<a name="line721">721: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[11] =
<a name="line722">722: </a>      {RC(0.0), RC(0.180185524442613), RC(-0.628869710835338), RC(0.186185675988647), RC(0.0484716652630425), RC(0.203927720607141), RC(0.44041662512573), RC(0.615710527731245), RC(0.0689648839032607), RC(-0.253599870605903), RC(0.138606958379488)};
<a name="line723">723: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKS7511SAL.html">TSDIRKS7511SAL</a>, 7, 11, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line724">724: </a>  }
<a name="line725">725: </a>  {
<a name="line726">726: </a>    // DIRK(13,8)[1]A[(14,6)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line727">727: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[14][14] = {
<a name="line728">728: </a>      {RC(0.421050745442291),   RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line729">729: </a>      {RC(-0.0761079419591268), RC(0.264353986580857),  RC(0.0),                 RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line730">730: </a>      {RC(0.0727106904170694),  RC(-0.204265976977285), RC(0.181608196544136),   RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line731">731: </a>      {RC(0.55763054816611),    RC(-0.409773579543499), RC(0.510926516886944),   RC(0.259892204518476),    RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line732">732: </a>      {RC(0.0228083864844437),  RC(-0.445569051836454), RC(-0.0915242778636248), RC(0.00450055909321655),  RC(0.6397807199983),      RC(0.0),                RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line733">733: </a>      {RC(-0.135945849505152),  RC(0.0946509646963754), RC(-0.236110197279175),  RC(0.00318944206456517),  RC(0.255453021028118),    RC(0.174805219173446),  RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line734">734: </a>      {RC(-0.147960260670772),  RC(-0.402188192230535), RC(-0.703014530043888),  RC(0.00941974677418186),  RC(0.885747111289207),    RC(0.261314066449028),  RC(0.16307697503668),    RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line735">735: </a>      {RC(0.165597241042244),   RC(0.824182962188923),  RC(-0.0280136160783609), RC(0.282372386631758),    RC(-0.957721354131182),   RC(0.489439550159977),  RC(0.170094415598103),   RC(0.0522519785718563),   RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line736">736: </a>      {RC(0.0335292011495618),  RC(0.575750388029166),  RC(0.223289855356637),   RC(-0.00317458833242804), RC(-0.112890382135193),   RC(-0.419809267954284), RC(0.0466136902102104),  RC(-0.00115413813041085), RC(0.109685363692383),  RC(0.0),                 RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line737">737: </a>      {RC(-0.0512616878252355), RC(0.699261265830807),  RC(-0.117939611738769),  RC(0.0021745241931243),   RC(-0.00932826702640947), RC(-0.267575057469428), RC(0.126949139814065),   RC(0.00330353204502163),  RC(0.185949445053766),  RC(0.0938215615963721),  RC(0.0),                RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line738">738: </a>      {RC(-0.106521517960343),  RC(0.41835889096168),   RC(0.353585905881916),   RC(-0.0746474161579599),  RC(-0.015450626460289),   RC(-0.46224659192275),  RC(-0.0576406327329181), RC(-0.00712066942504018), RC(0.377776558014452),  RC(0.36890054338294),    RC(0.0618488746331837), RC(0.0),                RC(0.0),                RC(0.0)               },
<a name="line739">739: </a>      {RC(-0.163079104890997),  RC(0.644561721693806),  RC(0.636968661639572),   RC(-0.122346720085377),   RC(-0.333062564990312),   RC(-0.3054226490478),   RC(-0.357820712828352),  RC(-0.0125510510334706),  RC(0.371263681186311),  RC(0.371979640363694),   RC(0.0531090658708968), RC(0.0518279459132049), RC(0.0),                RC(0.0)               },
<a name="line740">740: </a>      {RC(0.579993784455521),   RC(-0.188833728676494), RC(0.999975696843775),   RC(0.0572810855901161),   RC(-0.264374735003671),   RC(0.165091739976854),  RC(-0.546675809010452),  RC(-0.0283821822291982),  RC(-0.102639860418374), RC(-0.0343251040446405), RC(0.4762598462591),    RC(-0.304153104931261), RC(0.0953911855943621), RC(0.0)               },
<a name="line741">741: </a>      {RC(0.0848552694007844),  RC(0.287193912340074),  RC(0.543683503004232),   RC(-0.081311059300692),   RC(-0.0328661289388557),  RC(-0.323456834372922), RC(-0.240378871658975),  RC(-0.0189913019930369),  RC(0.220663114082036),  RC(0.253029984360864),   RC(0.252011799370563),  RC(-0.154882222605423), RC(0.0315202264687415), RC(0.0514095812104714)}
<a name="line742">742: </a>    };
<a name="line743">743: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[14] = {RC(0.0), RC(0.516650324205117), RC(0.0773227217357826), RC(-0.12474204666975), RC(-0.0241052115180679), RC(-0.325821145180359), RC(0.0907237460123951), RC(0.0459271880596652), RC(0.221012259404702), RC(0.235510906761942), RC(0.491109674204385), RC(-0.323506525837343), RC(0.119918108821531), RC(0.0)};
<a name="line744">744: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[14] = {RC(2.32345691433618e-16), RC(0.499150900944401), RC(0.080991997189243), RC(-0.0359440417166322), RC(-0.0258910397441454), RC(-0.304540350278636),  RC(0.0836627473632563),
<a name="line745">745: </a>                                  RC(0.0417664613347638),   RC(0.223636394275293), RC(0.231569156867596), RC(0.240526201277663),   RC(-0.222933582911926),  RC(-0.0111479879597561), RC(0.19915314335888)};
<a name="line746">746: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK8614A.html">TSDIRK8614A</a>, 8, 14, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line747">747: </a>  }
<a name="line748">748: </a>  {
<a name="line749">749: </a>    // DIRK(15,8)[1]SAL[(16,6)A] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line750">750: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[16][16] = {
<a name="line751">751: </a>      {RC(0.498904981271193),   RC(0.0),                  RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line752">752: </a>      {RC(-0.303806037341816),  RC(0.886299445992379),    RC(0.0),                 RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line753">753: </a>      {RC(-0.581440223471476),  RC(0.371003719460259),    RC(0.43844717752802),    RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line754">754: </a>      {RC(0.531852638870051),   RC(-0.339363014907108),   RC(0.422373239795441),   RC(0.223854203543397),    RC(0.0),                RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line755">755: </a>      {RC(0.118517891868867),   RC(-0.0756235584174296),  RC(-0.0864284870668712), RC(0.000536692838658312), RC(0.10101418329932),   RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line756">756: </a>      {RC(0.218733626116401),   RC(-0.139568928299635),   RC(0.30473612813488),    RC(0.00354038623073564),  RC(0.0932085751160559), RC(0.140161806097591),   RC(0.0),                RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line757">757: </a>      {RC(0.0692944686081835),  RC(-0.0442152168939502),  RC(-0.0903375348855603), RC(0.00259030241156141),  RC(0.204514233679515),  RC(-0.0245383758960002), RC(0.199289437094059),  RC(0.0),                 RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line758">758: </a>      {RC(0.990640016505571),   RC(-0.632104756315967),   RC(0.856971425234221),   RC(0.174494099232246),    RC(-0.113715829680145), RC(-0.151494045307366),  RC(-0.438268629569005), RC(0.120578398912139),   RC(0.0),                   RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line759">759: </a>      {RC(-0.099415677713136),  RC(0.211832014309207),    RC(-0.245998265866888),  RC(-0.182249672235861),   RC(0.167897635713799),  RC(0.212850335030069),   RC(-0.391739299440123), RC(-0.0118718506876767), RC(0.526293701659093),     RC(0.0),                 RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line760">760: </a>      {RC(0.383983914845461),   RC(-0.245011361219604),   RC(0.46717278554955),    RC(-0.0361272447593202),  RC(0.0742234660511333), RC(-0.0474816271948766), RC(-0.229859978525756), RC(0.0516283729206322),  RC(0.0),                   RC(0.193823890777594),   RC(0.0),                  RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line761">761: </a>      {RC(0.0967855003180134),  RC(-0.0481037037916184),  RC(0.191268138832434),   RC(0.234977164564126),    RC(0.0620265921753097), RC(0.403432826534738),   RC(0.152403846687238),  RC(-0.118420429237746),  RC(0.0582141598685892),    RC(-0.13924540906863),   RC(0.106661313117545),    RC(0.0),                 RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line762">762: </a>      {RC(0.133941307432055),   RC(-0.0722076602896254),  RC(0.217086297689275),   RC(0.00495499602192887),  RC(0.0306090174933995), RC(0.26483526755746),    RC(0.204442440745605),  RC(0.196883395136708),   RC(0.056527012583996),     RC(-0.150216381356784),  RC(-0.217209415757333),   RC(0.330353722743315),   RC(0.0),               RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line763">763: </a>      {RC(0.157014274561299),   RC(-0.0883810256381874),  RC(0.117193033885034),   RC(-0.0362304243769466),  RC(0.0169030211466111), RC(-0.169835753576141),  RC(0.399749979234113),  RC(0.31806704093008),    RC(0.050340008347693),     RC(0.120284837472214),   RC(-0.235313193645423),   RC(0.232488522208926),   RC(0.117719679450729), RC(0.0),                 RC(0.0),                 RC(0.0)              },
<a name="line764">764: </a>      {RC(0.00276453816875833), RC(-0.00366028255231782), RC(-0.331078914515559),  RC(0.623377549031949),    RC(0.167618142989491),  RC(0.0748467945312516),  RC(0.797629286699677),  RC(-0.390714256799583),  RC(-0.00808553925131555),  RC(0.014840324980952),   RC(-0.0856180410248133),  RC(0.602943304937827),   RC(-0.5771359338496),  RC(0.112273026653282),   RC(0.0),                 RC(0.0)              },
<a name="line765">765: </a>      {RC(0.0),                 RC(0.0),                  RC(0.085283971980307),   RC(0.51334393454179),     RC(0.144355978013514),  RC(0.255379109487853),   RC(0.225075750790524),  RC(-0.343241323394982),  RC(0.0),                   RC(0.0798250392218852),  RC(0.0528824734082655),   RC(-0.0830350888900362), RC(0.022567388707279), RC(-0.0592631119040204), RC(0.106825878037621),   RC(0.0)              },
<a name="line766">766: </a>      {RC(0.173784481207652),   RC(-0.110887906116241),   RC(0.190052513365204),   RC(-0.0688345422674029),  RC(0.10326505079603),   RC(0.267127097115219),   RC(0.141703423176897),  RC(0.0117966866651728),  RC(-6.65650091812762e-15), RC(-0.0213725083662519), RC(-0.00931148598712566), RC(-0.10007679077114),   RC(0.123471797451553), RC(0.00203684241073055), RC(-0.0294320891781173), RC(0.195746619921528)}
<a name="line767">767: </a>    };
<a name="line768">768: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[16] = {RC(0.0), RC(0.0), RC(0.085283971980307), RC(0.51334393454179), RC(0.144355978013514), RC(0.255379109487853), RC(0.225075750790524), RC(-0.343241323394982), RC(0.0), RC(0.0798250392218852), RC(0.0528824734082655), RC(-0.0830350888900362), RC(0.022567388707279), RC(-0.0592631119040204), RC(0.106825878037621), RC(0.0)};
<a name="line769">769: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[16] = {RC(-1.31988512519898e-15), RC(7.53606601764004e-16), RC(0.0886789133915965),   RC(0.0968726531622137),  RC(0.143815375874267),     RC(0.335214773313601),  RC(0.221862366978063),  RC(-0.147408947987273),
<a name="line770">770: </a>                                  RC(4.16297599203445e-16),  RC(0.000727276166520566), RC(-0.00284892677941246), RC(0.00512492274297611), RC(-0.000275595071215218), RC(0.0136014719350733), RC(0.0165190013607726), RC(0.228116714912817)};
<a name="line771">771: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRK8616SAL.html">TSDIRK8616SAL</a>, 8, 16, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line772">772: </a>  }
<a name="line773">773: </a>  {
<a name="line774">774: </a>    // ESDIRK(16,8)[2]SAL[(16,5)] from https://github.com/yousefalamri55/High_Order_DIRK_Methods_Coeffs
<a name="line775">775: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[16][16] = {
<a name="line776">776: </a>      {RC(0.0),                  RC(0.0),                 RC(0.0),                  RC(0.0),                   RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line777">777: </a>      {RC(0.117318819358521),    RC(0.117318819358521),   RC(0.0),                  RC(0.0),                   RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line778">778: </a>      {RC(0.0557014605974616),   RC(0.385525646638742),   RC(0.117318819358521),    RC(0.0),                   RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line779">779: </a>      {RC(0.063493276428895),    RC(0.373556126263681),   RC(0.0082994166438953),   RC(0.117318819358521),     RC(0.0),                  RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line780">780: </a>      {RC(0.0961351856230088),   RC(0.335558324517178),   RC(0.207077765910132),    RC(-0.0581917140797146),   RC(0.117318819358521),    RC(0.0),                  RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line781">781: </a>      {RC(0.0497669214238319),   RC(0.384288616546039),   RC(0.0821728117583936),   RC(0.120337007107103),     RC(0.202262782645888),    RC(0.117318819358521),    RC(0.0),                  RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line782">782: </a>      {RC(0.00626710666809847),  RC(0.496491452640725),   RC(-0.111303249827358),   RC(0.170478821683603),     RC(0.166517073971103),    RC(-0.0328669811542241),  RC(0.117318819358521),    RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line783">783: </a>      {RC(0.0463439767281591),   RC(0.00306724391019652), RC(-0.00816305222386205), RC(-0.0353302599538294),   RC(0.0139313601702569),   RC(-0.00992014507967429), RC(0.0210087909090165),   RC(0.117318819358521),  RC(0.0),                 RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line784">784: </a>      {RC(0.111574049232048),    RC(0.467639166482209),   RC(0.237773114804619),    RC(0.0798895699267508),    RC(0.109580615914593),    RC(0.0307353103825936),   RC(-0.0404391509541147),  RC(-0.16942110744293),  RC(0.117318819358521),   RC(0.0),                 RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line785">785: </a>      {RC(-0.0107072484863877),  RC(-0.231376703354252),  RC(0.017541113036611),    RC(0.144871527682418),     RC(-0.041855459769806),   RC(0.0841832168332261),   RC(-0.0850020937282192),  RC(0.486170343825899),  RC(-0.0526717116822739), RC(0.117318819358521),   RC(0.0),                RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line786">786: </a>      {RC(-0.0142238262314935),  RC(0.14752923682514),    RC(0.238235830732566),    RC(0.037950291904103),     RC(0.252075123381518),    RC(0.0474266904224567),   RC(-0.00363139069342027), RC(0.274081442388563),  RC(-0.0599166970745255), RC(-0.0527138812389185), RC(0.117318819358521),  RC(0.0),                 RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line787">787: </a>      {RC(-0.11837020183211),    RC(-0.635712481821264),  RC(0.239738832602538),    RC(0.330058936651707),     RC(-0.325784087988237),   RC(-0.0506514314589253),  RC(-0.281914404487009),   RC(0.852596345144291),  RC(0.651444614298805),   RC(-0.103476387303591),  RC(-0.354835880209975), RC(0.117318819358521),   RC(0.0),                 RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line788">788: </a>      {RC(-0.00458164025442349), RC(0.296219694015248),   RC(0.322146049419995),    RC(0.15917778285238),      RC(0.284864871688843),    RC(0.185509526463076),    RC(-0.0784621067883274),  RC(0.166312223692047),  RC(-0.284152486083397),  RC(-0.357125104338944),  RC(0.078437074055306),  RC(0.0884129667114481),  RC(0.117318819358521),   RC(0.0),                  RC(0.0),               RC(0.0)              },
<a name="line789">789: </a>      {RC(-0.0545561913848106),  RC(0.675785423442753),   RC(0.423066443201941),    RC(-0.000165300126841193), RC(0.104252994793763),    RC(-0.105763019303021),   RC(-0.15988308809318),    RC(0.0515050001032011), RC(0.56013979290924),    RC(-0.45781539708603),   RC(-0.255870699752664), RC(0.026960254296416),   RC(-0.0721245985053681), RC(0.117318819358521),    RC(0.0),               RC(0.0)              },
<a name="line790">790: </a>      {RC(0.0649253995775223),   RC(-0.0216056457922249), RC(-0.073738139377975),   RC(0.0931033310077225),    RC(-0.0194339577299149),  RC(-0.0879623837313009),  RC(0.057125517179467),    RC(0.205120850488097),  RC(0.132576503537441),   RC(0.489416890627328),   RC(-0.1106765720501),   RC(-0.081038793996096),  RC(0.0606031613503788),  RC(-0.00241467937442272), RC(0.117318819358521), RC(0.0)              },
<a name="line791">791: </a>      {RC(0.0459979286336779),   RC(0.0780075394482806),  RC(0.015021874148058),    RC(0.195180277284195),     RC(-0.00246643310153235), RC(0.0473977117068314),   RC(-0.0682773558610363),  RC(0.19568019123878),   RC(-0.0876765449323747), RC(0.177874852409192),   RC(-0.337519251582222), RC(-0.0123255553640736), RC(0.311573291192553),   RC(0.0458604327754991),   RC(0.278352222645651), RC(0.117318819358521)}
<a name="line792">792: </a>    };
<a name="line793">793: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[16]      = {RC(0.0459979286336779),  RC(0.0780075394482806), RC(0.015021874148058),  RC(0.195180277284195),   RC(-0.00246643310153235), RC(0.0473977117068314), RC(-0.0682773558610363), RC(0.19568019123878),
<a name="line794">794: </a>                                  RC(-0.0876765449323747), RC(0.177874852409192),  RC(-0.337519251582222), RC(-0.0123255553640736), RC(0.311573291192553),    RC(0.0458604327754991), RC(0.278352222645651),   RC(0.117318819358521)};
<a name="line795">795: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[16] = {RC(0.0603373529853206),   RC(0.175453809423998),  RC(0.0537707777611352), RC(0.195309248607308),  RC(0.0135893741970232), RC(-0.0221160259296707), RC(-0.00726526156430691), RC(0.102961059369124),
<a name="line796">796: </a>                                  RC(0.000900215457460583), RC(0.0547959465692338), RC(-0.334995726863153), RC(0.0464409662093384), RC(0.301388101652194),  RC(0.00524851570622031), RC(0.229538601845236),    RC(0.124643044573514)};
<a name="line797">797: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKES8516SAL.html">TSDIRKES8516SAL</a>, 8, 16, &amp;A[0][0], b, NULL, bembed, 1, b));
<a name="line798">798: </a>  }

<a name="line800">800: </a>  <font color="#B22222">/* Additive methods */</font>
<a name="line801">801: </a>  {
<a name="line802">802: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line803">803: </a>      {0.0, 0.0, 0.0},
<a name="line804">804: </a>      {0.0, 0.0, 0.0},
<a name="line805">805: </a>      {0.0, 0.5, 0.0}
<a name="line806">806: </a>    };
<a name="line807">807: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[3][3] = {
<a name="line808">808: </a>      {1.0, 0.0, 0.0},
<a name="line809">809: </a>      {0.0, 0.5, 0.0},
<a name="line810">810: </a>      {0.0, 0.5, 0.5}
<a name="line811">811: </a>    };
<a name="line812">812: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[3]       = {0.0, 0.5, 0.5};
<a name="line813">813: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[3] = {1.0, 0.0, 0.0};
<a name="line814">814: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX1BEE.html">TSARKIMEX1BEE</a>, 2, 3, &amp;At[0][0], b, NULL, &amp;A[0][0], b, NULL, bembedt, bembedt, 1, b, NULL));
<a name="line815">815: </a>  }
<a name="line816">816: </a>  {
<a name="line817">817: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[2][2] = {
<a name="line818">818: </a>      {0.0, 0.0},
<a name="line819">819: </a>      {0.5, 0.0}
<a name="line820">820: </a>    };
<a name="line821">821: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[2][2] = {
<a name="line822">822: </a>      {0.0, 0.0},
<a name="line823">823: </a>      {0.0, 0.5}
<a name="line824">824: </a>    };
<a name="line825">825: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[2]       = {0.0, 1.0};
<a name="line826">826: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[2] = {0.5, 0.5};
<a name="line827">827: </a>    <font color="#B22222">/* binterpt[2][2] = {{1.0,-1.0},{0.0,1.0}};  second order dense output has poor stability properties and hence it is not currently in use */</font>
<a name="line828">828: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXARS122.html">TSARKIMEXARS122</a>, 2, 2, &amp;At[0][0], b, NULL, &amp;A[0][0], b, NULL, bembedt, bembedt, 1, b, NULL));
<a name="line829">829: </a>  }
<a name="line830">830: </a>  {
<a name="line831">831: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[2][2] = {
<a name="line832">832: </a>      {0.0, 0.0},
<a name="line833">833: </a>      {1.0, 0.0}
<a name="line834">834: </a>    };
<a name="line835">835: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[2][2] = {
<a name="line836">836: </a>      {0.0, 0.0},
<a name="line837">837: </a>      {0.5, 0.5}
<a name="line838">838: </a>    };
<a name="line839">839: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[2]       = {0.5, 0.5};
<a name="line840">840: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[2] = {0.0, 1.0};
<a name="line841">841: </a>    <font color="#B22222">/* binterpt[2][2] = {{1.0,-0.5},{0.0,0.5}}  second order dense output has poor stability properties and hence it is not currently in use */</font>
<a name="line842">842: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXA2.html">TSARKIMEXA2</a>, 2, 2, &amp;At[0][0], b, NULL, &amp;A[0][0], b, NULL, bembedt, bembedt, 1, b, NULL));
<a name="line843">843: </a>  }
<a name="line844">844: </a>  {
<a name="line845">845: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[2][2] = {
<a name="line846">846: </a>      {0.0, 0.0},
<a name="line847">847: </a>      {1.0, 0.0}
<a name="line848">848: </a>    };
<a name="line849">849: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[2][2] = {
<a name="line850">850: </a>      {us2,             0.0},
<a name="line851">851: </a>      {1.0 - 2.0 * us2, us2}
<a name="line852">852: </a>    };
<a name="line853">853: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[2]           = {0.5, 0.5};
<a name="line854">854: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[2]     = {0.0, 1.0};
<a name="line855">855: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[2][2] = {
<a name="line856">856: </a>      {(us2 - 1.0) / (2.0 * us2 - 1.0),     -1 / (2.0 * (1.0 - 2.0 * us2))},
<a name="line857">857: </a>      {1 - (us2 - 1.0) / (2.0 * us2 - 1.0), -1 / (2.0 * (1.0 - 2.0 * us2))}
<a name="line858">858: </a>    };
<a name="line859">859: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterp[2][2] = {
<a name="line860">860: </a>      {1.0, -0.5},
<a name="line861">861: </a>      {0.0, 0.5 }
<a name="line862">862: </a>    };
<a name="line863">863: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXL2.html">TSARKIMEXL2</a>, 2, 2, &amp;At[0][0], b, NULL, &amp;A[0][0], b, NULL, bembedt, bembedt, 2, binterpt[0], binterp[0]));
<a name="line864">864: </a>  }
<a name="line865">865: </a>  {
<a name="line866">866: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line867">867: </a>      {0,      0,   0},
<a name="line868">868: </a>      {2 - s2, 0,   0},
<a name="line869">869: </a>      {0.5,    0.5, 0}
<a name="line870">870: </a>    };
<a name="line871">871: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[3][3] = {
<a name="line872">872: </a>      {0,            0,            0         },
<a name="line873">873: </a>      {1 - 1 / s2,   1 - 1 / s2,   0         },
<a name="line874">874: </a>      {1 / (2 * s2), 1 / (2 * s2), 1 - 1 / s2}
<a name="line875">875: </a>    };
<a name="line876">876: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[3]     = {(4. - s2) / 8., (4. - s2) / 8., 1 / (2. * s2)};
<a name="line877">877: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[3][2] = {
<a name="line878">878: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line879">879: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line880">880: </a>      {1.0 - s2, 1.0 / s2         }
<a name="line881">881: </a>    };
<a name="line882">882: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX2C.html">TSARKIMEX2C</a>, 2, 3, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 2, binterpt[0], NULL));
<a name="line883">883: </a>  }
<a name="line884">884: </a>  {
<a name="line885">885: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line886">886: </a>      {0,      0,    0},
<a name="line887">887: </a>      {2 - s2, 0,    0},
<a name="line888">888: </a>      {0.75,   0.25, 0}
<a name="line889">889: </a>    };
<a name="line890">890: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[3][3] = {
<a name="line891">891: </a>      {0,            0,            0         },
<a name="line892">892: </a>      {1 - 1 / s2,   1 - 1 / s2,   0         },
<a name="line893">893: </a>      {1 / (2 * s2), 1 / (2 * s2), 1 - 1 / s2}
<a name="line894">894: </a>    };
<a name="line895">895: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[3]     = {(4. - s2) / 8., (4. - s2) / 8., 1 / (2. * s2)};
<a name="line896">896: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[3][2] = {
<a name="line897">897: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line898">898: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line899">899: </a>      {1.0 - s2, 1.0 / s2         }
<a name="line900">900: </a>    };
<a name="line901">901: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX2D.html">TSARKIMEX2D</a>, 2, 3, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 2, binterpt[0], NULL));
<a name="line902">902: </a>  }
<a name="line903">903: </a>  { <font color="#B22222">/* Optimal for linear implicit part */</font>
<a name="line904">904: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line905">905: </a>      {0,                0,                0},
<a name="line906">906: </a>      {2 - s2,           0,                0},
<a name="line907">907: </a>      {(3 - 2 * s2) / 6, (3 + 2 * s2) / 6, 0}
<a name="line908">908: </a>    };
<a name="line909">909: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[3][3] = {
<a name="line910">910: </a>      {0,            0,            0         },
<a name="line911">911: </a>      {1 - 1 / s2,   1 - 1 / s2,   0         },
<a name="line912">912: </a>      {1 / (2 * s2), 1 / (2 * s2), 1 - 1 / s2}
<a name="line913">913: </a>    };
<a name="line914">914: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[3]     = {(4. - s2) / 8., (4. - s2) / 8., 1 / (2. * s2)};
<a name="line915">915: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[3][2] = {
<a name="line916">916: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line917">917: </a>      {1.0 / s2, -1.0 / (2.0 * s2)},
<a name="line918">918: </a>      {1.0 - s2, 1.0 / s2         }
<a name="line919">919: </a>    };
<a name="line920">920: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX2E.html">TSARKIMEX2E</a>, 2, 3, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 2, binterpt[0], NULL));
<a name="line921">921: </a>  }
<a name="line922">922: </a>  { <font color="#B22222">/* Optimal for linear implicit part */</font>
<a name="line923">923: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[3][3] = {
<a name="line924">924: </a>      {0,   0,   0},
<a name="line925">925: </a>      {0.5, 0,   0},
<a name="line926">926: </a>      {0.5, 0.5, 0}
<a name="line927">927: </a>    };
<a name="line928">928: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[3][3] = {
<a name="line929">929: </a>      {0.25,   0,      0     },
<a name="line930">930: </a>      {0,      0.25,   0     },
<a name="line931">931: </a>      {1. / 3, 1. / 3, 1. / 3}
<a name="line932">932: </a>    };
<a name="line933">933: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXPRSSP2.html">TSARKIMEXPRSSP2</a>, 2, 3, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, NULL, NULL, 0, NULL, NULL));
<a name="line934">934: </a>  }
<a name="line935">935: </a>  {
<a name="line936">936: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[4][4] = {
<a name="line937">937: </a>      {0,                                0,                                0,                                 0},
<a name="line938">938: </a>      {1767732205903. / 2027836641118.,  0,                                0,                                 0},
<a name="line939">939: </a>      {5535828885825. / 10492691773637., 788022342437. / 10882634858940.,  0,                                 0},
<a name="line940">940: </a>      {6485989280629. / 16251701735622., -4246266847089. / 9704473918619., 10755448449292. / 10357097424841., 0}
<a name="line941">941: </a>    };
<a name="line942">942: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[4][4] = {
<a name="line943">943: </a>      {0,                                0,                                0,                                 0                              },
<a name="line944">944: </a>      {1767732205903. / 4055673282236.,  1767732205903. / 4055673282236.,  0,                                 0                              },
<a name="line945">945: </a>      {2746238789719. / 10658868560708., -640167445237. / 6845629431997.,  1767732205903. / 4055673282236.,   0                              },
<a name="line946">946: </a>      {1471266399579. / 7840856788654.,  -4482444167858. / 7529755066697., 11266239266428. / 11593286722821., 1767732205903. / 4055673282236.}
<a name="line947">947: </a>    };
<a name="line948">948: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[4]     = {2756255671327. / 12835298489170., -10771552573575. / 22201958757719., 9247589265047. / 10645013368117., 2193209047091. / 5459859503100.};
<a name="line949">949: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[4][2] = {
<a name="line950">950: </a>      {4655552711362. / 22874653954995.,  -215264564351. / 13552729205753.  },
<a name="line951">951: </a>      {-18682724506714. / 9892148508045., 17870216137069. / 13817060693119. },
<a name="line952">952: </a>      {34259539580243. / 13192909600954., -28141676662227. / 17317692491321.},
<a name="line953">953: </a>      {584795268549. / 6622622206610.,    2508943948391. / 7218656332882.   }
<a name="line954">954: </a>    };
<a name="line955">955: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a>, 3, 4, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 2, binterpt[0], NULL));
<a name="line956">956: </a>  }
<a name="line957">957: </a>  {
<a name="line958">958: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[5][5] = {
<a name="line959">959: </a>      {0,        0,       0,      0,       0},
<a name="line960">960: </a>      {1. / 2,   0,       0,      0,       0},
<a name="line961">961: </a>      {11. / 18, 1. / 18, 0,      0,       0},
<a name="line962">962: </a>      {5. / 6,   -5. / 6, .5,     0,       0},
<a name="line963">963: </a>      {1. / 4,   7. / 4,  3. / 4, -7. / 4, 0}
<a name="line964">964: </a>    };
<a name="line965">965: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[5][5] = {
<a name="line966">966: </a>      {0, 0,       0,       0,      0     },
<a name="line967">967: </a>      {0, 1. / 2,  0,       0,      0     },
<a name="line968">968: </a>      {0, 1. / 6,  1. / 2,  0,      0     },
<a name="line969">969: </a>      {0, -1. / 2, 1. / 2,  1. / 2, 0     },
<a name="line970">970: </a>      {0, 3. / 2,  -3. / 2, 1. / 2, 1. / 2}
<a name="line971">971: </a>    };
<a name="line972">972: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXARS443.html">TSARKIMEXARS443</a>, 3, 5, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, NULL, NULL, 0, NULL, NULL));
<a name="line973">973: </a>  }
<a name="line974">974: </a>  {
<a name="line975">975: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[5][5] = {
<a name="line976">976: </a>      {0,      0,      0,      0, 0},
<a name="line977">977: </a>      {1,      0,      0,      0, 0},
<a name="line978">978: </a>      {4. / 9, 2. / 9, 0,      0, 0},
<a name="line979">979: </a>      {1. / 4, 0,      3. / 4, 0, 0},
<a name="line980">980: </a>      {1. / 4, 0,      3. / 5, 0, 0}
<a name="line981">981: </a>    };
<a name="line982">982: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[5][5] = {
<a name="line983">983: </a>      {0,       0,       0,   0,   0 },
<a name="line984">984: </a>      {.5,      .5,      0,   0,   0 },
<a name="line985">985: </a>      {5. / 18, -1. / 9, .5,  0,   0 },
<a name="line986">986: </a>      {.5,      0,       0,   .5,  0 },
<a name="line987">987: </a>      {.25,     0,       .75, -.5, .5}
<a name="line988">988: </a>    };
<a name="line989">989: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXBPR3.html">TSARKIMEXBPR3</a>, 3, 5, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, NULL, NULL, 0, NULL, NULL));
<a name="line990">990: </a>  }
<a name="line991">991: </a>  {
<a name="line992">992: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[6][6] = {
<a name="line993">993: </a>      {0,                               0,                                 0,                                 0,                                0,              0},
<a name="line994">994: </a>      {1. / 2,                          0,                                 0,                                 0,                                0,              0},
<a name="line995">995: </a>      {13861. / 62500.,                 6889. / 62500.,                    0,                                 0,                                0,              0},
<a name="line996">996: </a>      {-116923316275. / 2393684061468., -2731218467317. / 15368042101831., 9408046702089. / 11113171139209.,  0,                                0,              0},
<a name="line997">997: </a>      {-451086348788. / 2902428689909., -2682348792572. / 7519795681897.,  12662868775082. / 11960479115383., 3355817975965. / 11060851509271., 0,              0},
<a name="line998">998: </a>      {647845179188. / 3216320057751.,  73281519250. / 8382639484533.,     552539513391. / 3454668386233.,    3354512671639. / 8306763924573.,  4040. / 17871., 0}
<a name="line999">999: </a>    };
<a name="line1000">1000: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[6][6] = {
<a name="line1001">1001: </a>      {0,                            0,                       0,                       0,                   0,             0     },
<a name="line1002">1002: </a>      {1. / 4,                       1. / 4,                  0,                       0,                   0,             0     },
<a name="line1003">1003: </a>      {8611. / 62500.,               -1743. / 31250.,         1. / 4,                  0,                   0,             0     },
<a name="line1004">1004: </a>      {5012029. / 34652500.,         -654441. / 2922500.,     174375. / 388108.,       1. / 4,              0,             0     },
<a name="line1005">1005: </a>      {15267082809. / 155376265600., -71443401. / 120774400., 730878875. / 902184768., 2285395. / 8070912., 1. / 4,        0     },
<a name="line1006">1006: </a>      {82889. / 524892.,             0,                       15625. / 83664.,         69875. / 102672.,    -2260. / 8211, 1. / 4}
<a name="line1007">1007: </a>    };
<a name="line1008">1008: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[6]     = {4586570599. / 29645900160., 0, 178811875. / 945068544., 814220225. / 1159782912., -3700637. / 11593932., 61727. / 225920.};
<a name="line1009">1009: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[6][3] = {
<a name="line1010">1010: </a>      {6943876665148. / 7220017795957.,   -54480133. / 30881146., 6818779379841. / 7100303317025.  },
<a name="line1011">1011: </a>      {0,                                 0,                      0                                },
<a name="line1012">1012: </a>      {7640104374378. / 9702883013639.,   -11436875. / 14766696., 2173542590792. / 12501825683035. },
<a name="line1013">1013: </a>      {-20649996744609. / 7521556579894., 174696575. / 18121608., -31592104683404. / 5083833661969.},
<a name="line1014">1014: </a>      {8854892464581. / 2390941311638.,   -12120380. / 966161.,   61146701046299. / 7138195549469. },
<a name="line1015">1015: </a>      {-11397109935349. / 6675773540249., 3843. / 706.,           -17219254887155. / 4939391667607.}
<a name="line1016">1016: </a>    };
<a name="line1017">1017: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX4.html">TSARKIMEX4</a>, 4, 6, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 3, binterpt[0], NULL));
<a name="line1018">1018: </a>  }
<a name="line1019">1019: </a>  {
<a name="line1020">1020: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[8][8] = {
<a name="line1021">1021: </a>      {0,                                  0,                              0,                                 0,                                  0,                               0,                                 0,                               0},
<a name="line1022">1022: </a>      {41. / 100,                          0,                              0,                                 0,                                  0,                               0,                                 0,                               0},
<a name="line1023">1023: </a>      {367902744464. / 2072280473677.,     677623207551. / 8224143866563., 0,                                 0,                                  0,                               0,                                 0,                               0},
<a name="line1024">1024: </a>      {1268023523408. / 10340822734521.,   0,                              1029933939417. / 13636558850479.,  0,                                  0,                               0,                                 0,                               0},
<a name="line1025">1025: </a>      {14463281900351. / 6315353703477.,   0,                              66114435211212. / 5879490589093.,  -54053170152839. / 4284798021562.,  0,                               0,                                 0,                               0},
<a name="line1026">1026: </a>      {14090043504691. / 34967701212078.,  0,                              15191511035443. / 11219624916014., -18461159152457. / 12425892160975., -281667163811. / 9011619295870., 0,                                 0,                               0},
<a name="line1027">1027: </a>      {19230459214898. / 13134317526959.,  0,                              21275331358303. / 2942455364971.,  -38145345988419. / 4862620318723.,  -1. / 8,                         -1. / 8,                           0,                               0},
<a name="line1028">1028: </a>      {-19977161125411. / 11928030595625., 0,                              -40795976796054. / 6384907823539., 177454434618887. / 12078138498510., 782672205425. / 8267701900261.,  -69563011059811. / 9646580694205., 7356628210526. / 4942186776405., 0}
<a name="line1029">1029: </a>    };
<a name="line1030">1030: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[8][8] = {
<a name="line1031">1031: </a>      {0,                                0,                                0,                                 0,                                  0,                                0,                                  0,                                 0         },
<a name="line1032">1032: </a>      {41. / 200.,                       41. / 200.,                       0,                                 0,                                  0,                                0,                                  0,                                 0         },
<a name="line1033">1033: </a>      {41. / 400.,                       -567603406766. / 11931857230679., 41. / 200.,                        0,                                  0,                                0,                                  0,                                 0         },
<a name="line1034">1034: </a>      {683785636431. / 9252920307686.,   0,                                -110385047103. / 1367015193373.,   41. / 200.,                         0,                                0,                                  0,                                 0         },
<a name="line1035">1035: </a>      {3016520224154. / 10081342136671., 0,                                30586259806659. / 12414158314087., -22760509404356. / 11113319521817., 41. / 200.,                       0,                                  0,                                 0         },
<a name="line1036">1036: </a>      {218866479029. / 1489978393911.,   0,                                638256894668. / 5436446318841.,    -1179710474555. / 5321154724896.,   -60928119172. / 8023461067671.,   41. / 200.,                         0,                                 0         },
<a name="line1037">1037: </a>      {1020004230633. / 5715676835656.,  0,                                25762820946817. / 25263940353407., -2161375909145. / 9755907335909.,   -211217309593. / 5846859502534.,  -4269925059573. / 7827059040749.,   41. / 200,                         0         },
<a name="line1038">1038: </a>      {-872700587467. / 9133579230613.,  0,                                0,                                 22348218063261. / 9555858737531.,   -1143369518992. / 8141816002931., -39379526789629. / 19018526304540., 32727382324388. / 42900044865799., 41. / 200.}
<a name="line1039">1039: </a>    };
<a name="line1040">1040: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[8]     = {-975461918565. / 9796059967033., 0, 0, 78070527104295. / 32432590147079., -548382580838. / 3424219808633., -33438840321285. / 15594753105479., 3629800801594. / 4656183773603., 4035322873751. / 18575991585200.};
<a name="line1041">1041: </a>    const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[8][3] = {
<a name="line1042">1042: </a>      {-17674230611817. / 10670229744614., 43486358583215. / 12773830924787.,  -9257016797708. / 5021505065439. },
<a name="line1043">1043: </a>      {0,                                  0,                                  0                                },
<a name="line1044">1044: </a>      {0,                                  0,                                  0                                },
<a name="line1045">1045: </a>      {65168852399939. / 7868540260826.,   -91478233927265. / 11067650958493., 26096422576131. / 11239449250142.},
<a name="line1046">1046: </a>      {15494834004392. / 5936557850923.,   -79368583304911. / 10890268929626., 92396832856987. / 20362823103730.},
<a name="line1047">1047: </a>      {-99329723586156. / 26959484932159., -12239297817655. / 9152339842473.,  30029262896817. / 10175596800299.},
<a name="line1048">1048: </a>      {-19024464361622. / 5461577185407.,  115839755401235. / 10719374521269., -26136350496073. / 3983972220547.},
<a name="line1049">1049: </a>      {-6511271360970. / 6095937251113.,   5843115559534. / 2180450260947.,    -5289405421727. / 3760307252460. }
<a name="line1050">1050: </a>    };
<a name="line1051">1051: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEX5.html">TSARKIMEX5</a>, 5, 8, &amp;At[0][0], NULL, NULL, &amp;A[0][0], NULL, NULL, bembedt, bembedt, 3, binterpt[0], NULL));
<a name="line1052">1052: </a>  }
<a name="line1053">1053: </a><strong><font color="#228B22">#undef RC</font></strong>
<a name="line1054">1054: </a><strong><font color="#228B22">#undef us2</font></strong>
<a name="line1055">1055: </a><strong><font color="#228B22">#undef s2</font></strong>
<a name="line1056">1056: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1057">1057: </a>}

<a name="line1059">1059: </a><font color="#B22222">/*@C</font>
<a name="line1060">1060: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXRegisterDestroy.html">TSARKIMEXRegisterDestroy</a> - Frees the list of schemes that were registered by `<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>()`.</font>

<a name="line1062">1062: </a><font color="#B22222">  Not Collective</font>

<a name="line1064">1064: </a><font color="#B22222">  Level: advanced</font>

<a name="line1066">1066: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXRegisterAll.html">TSARKIMEXRegisterAll</a>()`</font>
<a name="line1067">1067: </a><font color="#B22222">@*/</font>
<a name="line1068">1068: </a><strong><font color="#4169E1"><a name="TSARKIMEXRegisterDestroy"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXRegisterDestroy.html">TSARKIMEXRegisterDestroy</a>(void)</font></strong>
<a name="line1069">1069: </a>{
<a name="line1070">1070: </a>  ARKTableauLink link;

<a name="line1072">1072: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1073">1073: </a>  <font color="#4169E1">while</font> ((link = ARKTableauList)) {
<a name="line1074">1074: </a>    ARKTableau t   = &amp;link-&gt;tab;
<a name="line1075">1075: </a>    ARKTableauList = link-&gt;next;
<a name="line1076">1076: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree6.html">PetscFree6</a>(t-&gt;At, t-&gt;bt, t-&gt;ct, t-&gt;A, t-&gt;b, t-&gt;c));
<a name="line1077">1077: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree2.html">PetscFree2</a>(t-&gt;bembedt, t-&gt;bembed));
<a name="line1078">1078: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree2.html">PetscFree2</a>(t-&gt;binterpt, t-&gt;binterp));
<a name="line1079">1079: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree.html">PetscFree</a>(t-&gt;name));
<a name="line1080">1080: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree.html">PetscFree</a>(link));
<a name="line1081">1081: </a>  }
<a name="line1082">1082: </a>  TSARKIMEXRegisterAllCalled = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1083">1083: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1084">1084: </a>}

<a name="line1086">1086: </a><font color="#B22222">/*@C</font>
<a name="line1087">1087: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXInitializePackage.html">TSARKIMEXInitializePackage</a> - This function initializes everything in the `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` package. It is called</font>
<a name="line1088">1088: </a><font color="#B22222">  from `<a href="../../../../manualpages/TS/TSInitializePackage.html">TSInitializePackage</a>()`.</font>

<a name="line1090">1090: </a><font color="#B22222">  Level: developer</font>

<a name="line1092">1092: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/Sys/PetscInitialize.html">PetscInitialize</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXFinalizePackage.html">TSARKIMEXFinalizePackage</a>()`</font>
<a name="line1093">1093: </a><font color="#B22222">@*/</font>
<a name="line1094">1094: </a><strong><font color="#4169E1"><a name="TSARKIMEXInitializePackage"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXInitializePackage.html">TSARKIMEXInitializePackage</a>(void)</font></strong>
<a name="line1095">1095: </a>{
<a name="line1096">1096: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1097">1097: </a>  <font color="#4169E1">if</font> (TSARKIMEXPackageInitialized) <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1098">1098: </a>  TSARKIMEXPackageInitialized = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1099">1099: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegisterAll.html">TSARKIMEXRegisterAll</a>());
<a name="line1100">1100: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscRegisterFinalize.html">PetscRegisterFinalize</a>(<a href="../../../../manualpages/TS/TSARKIMEXFinalizePackage.html">TSARKIMEXFinalizePackage</a>));
<a name="line1101">1101: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1102">1102: </a>}

<a name="line1104">1104: </a><font color="#B22222">/*@C</font>
<a name="line1105">1105: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXFinalizePackage.html">TSARKIMEXFinalizePackage</a> - This function destroys everything in the `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` package. It is</font>
<a name="line1106">1106: </a><font color="#B22222">  called from `<a href="../../../../manualpages/Sys/PetscFinalize.html">PetscFinalize</a>()`.</font>

<a name="line1108">1108: </a><font color="#B22222">  Level: developer</font>

<a name="line1110">1110: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/Sys/PetscFinalize.html">PetscFinalize</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXInitializePackage.html">TSARKIMEXInitializePackage</a>()`</font>
<a name="line1111">1111: </a><font color="#B22222">@*/</font>
<a name="line1112">1112: </a><strong><font color="#4169E1"><a name="TSARKIMEXFinalizePackage"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXFinalizePackage.html">TSARKIMEXFinalizePackage</a>(void)</font></strong>
<a name="line1113">1113: </a>{
<a name="line1114">1114: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1115">1115: </a>  TSARKIMEXPackageInitialized = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1116">1116: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegisterDestroy.html">TSARKIMEXRegisterDestroy</a>());
<a name="line1117">1117: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1118">1118: </a>}

<a name="line1120">1120: </a><font color="#B22222">/*@C</font>
<a name="line1121">1121: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a> - register a `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme by providing the entries in the Butcher tableau and optionally embedded approximations and interpolation</font>

<a name="line1123">1123: </a><font color="#B22222">  Logically Collective.</font>

<a name="line1125">1125: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1126">1126: </a><font color="#B22222">+ name     - identifier for method</font>
<a name="line1127">1127: </a><font color="#B22222">. order    - approximation order of method</font>
<a name="line1128">1128: </a><font color="#B22222">. s        - number of stages, this is the dimension of the matrices below</font>
<a name="line1129">1129: </a><font color="#B22222">. At       - Butcher table of stage coefficients for stiff part (dimension s*s, row-major)</font>
<a name="line1130">1130: </a><font color="#B22222">. bt       - Butcher table for completing the stiff part of the step (dimension s; NULL to use the last row of At)</font>
<a name="line1131">1131: </a><font color="#B22222">. ct       - Abscissa of each stiff stage (dimension s, NULL to use row sums of At)</font>
<a name="line1132">1132: </a><font color="#B22222">. A        - Non-stiff stage coefficients (dimension s*s, row-major)</font>
<a name="line1133">1133: </a><font color="#B22222">. b        - Non-stiff step completion table (dimension s; NULL to use last row of At)</font>
<a name="line1134">1134: </a><font color="#B22222">. c        - Non-stiff abscissa (dimension s; NULL to use row sums of A)</font>
<a name="line1135">1135: </a><font color="#B22222">. bembedt  - Stiff part of completion table for embedded method (dimension s; NULL if not available)</font>
<a name="line1136">1136: </a><font color="#B22222">. bembed   - Non-stiff part of completion table for embedded method (dimension s; NULL to use bembedt if provided)</font>
<a name="line1137">1137: </a><font color="#B22222">. pinterp  - Order of the interpolation scheme, equal to the number of columns of binterpt and binterp</font>
<a name="line1138">1138: </a><font color="#B22222">. binterpt - Coefficients of the interpolation formula for the stiff part (dimension s*pinterp)</font>
<a name="line1139">1139: </a><font color="#B22222">- binterp  - Coefficients of the interpolation formula for the non-stiff part (dimension s*pinterp; NULL to reuse binterpt)</font>

<a name="line1141">1141: </a><font color="#B22222">  Level: advanced</font>

<a name="line1143">1143: </a><font color="#B22222">  Note:</font>
<a name="line1144">1144: </a><font color="#B22222">  Several `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` methods are provided, this function is only needed to create new methods.</font>

<a name="line1146">1146: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSType.html">TSType</a>`, `<a href="../../../../manualpages/TS/TS.html">TS</a>`</font>
<a name="line1147">1147: </a><font color="#B22222">@*/</font>
<a name="line1148">1148: </a><strong><font color="#4169E1"><a name="TSARKIMEXRegister"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> name, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> order, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> s, const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bt[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> ct[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> A[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> b[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> c[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembed[], <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> pinterp, const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterp[])</font></strong>
<a name="line1149">1149: </a>{
<a name="line1150">1150: </a>  ARKTableauLink link;
<a name="line1151">1151: </a>  ARKTableau     t;
<a name="line1152">1152: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>       i, j;

<a name="line1154">1154: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1155">1155: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXInitializePackage.html">TSARKIMEXInitializePackage</a>());
<a name="line1156">1156: </a>  <font color="#4169E1">for</font> (link = ARKTableauList; link; link = link-&gt;next) {
<a name="line1157">1157: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> match;

<a name="line1159">1159: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscStrcmp.html">PetscStrcmp</a>(link-&gt;tab.name, name, &amp;match));
<a name="line1160">1160: </a>    <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(!match, <a href="../../../../manualpages/Sys/PETSC_COMM_SELF.html">PETSC_COMM_SELF</a>, <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_ARG_WRONG</a>, <font color="#666666">"Method with name \"%s\" already registered"</font>, name);
<a name="line1161">1161: </a>  }
<a name="line1162">1162: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscNew.html">PetscNew</a>(&amp;link));
<a name="line1163">1163: </a>  t = &amp;link-&gt;tab;
<a name="line1164">1164: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscStrallocpy.html">PetscStrallocpy</a>(name, &amp;t-&gt;name));
<a name="line1165">1165: </a>  t-&gt;order = order;
<a name="line1166">1166: </a>  t-&gt;s     = s;
<a name="line1167">1167: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscMalloc6.html">PetscMalloc6</a>(s * s, &amp;t-&gt;At, s, &amp;t-&gt;bt, s, &amp;t-&gt;ct, s * s, &amp;t-&gt;A, s, &amp;t-&gt;b, s, &amp;t-&gt;c));
<a name="line1168">1168: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;At, At, s * s));
<a name="line1169">1169: </a>  <font color="#4169E1">if</font> (A) {
<a name="line1170">1170: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;A, A, s * s));
<a name="line1171">1171: </a>    t-&gt;additive = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1172">1172: </a>  }

<a name="line1174">1174: </a>  <font color="#4169E1">if</font> (bt) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;bt, bt, s));
<a name="line1175">1175: </a>  <font color="#4169E1">else</font>
<a name="line1176">1176: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) t-&gt;bt[i] = At[(s - 1) * s + i];

<a name="line1178">1178: </a>  <font color="#4169E1">if</font> (t-&gt;additive) {
<a name="line1179">1179: </a>    <font color="#4169E1">if</font> (b) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;b, b, s));
<a name="line1180">1180: </a>    <font color="#4169E1">else</font>
<a name="line1181">1181: </a>      <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) t-&gt;b[i] = t-&gt;bt[i];
<a name="line1182">1182: </a>  } <font color="#4169E1">else</font> <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArrayzero.html">PetscArrayzero</a>(t-&gt;b, s));

<a name="line1184">1184: </a>  <font color="#4169E1">if</font> (ct) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;ct, ct, s));
<a name="line1185">1185: </a>  <font color="#4169E1">else</font>
<a name="line1186">1186: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; s; i++)
<a name="line1187">1187: </a>      <font color="#4169E1">for</font> (j = 0, t-&gt;ct[i] = 0; j &lt; s; j++) t-&gt;ct[i] += At[i * s + j];

<a name="line1189">1189: </a>  <font color="#4169E1">if</font> (t-&gt;additive) {
<a name="line1190">1190: </a>    <font color="#4169E1">if</font> (c) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;c, c, s));
<a name="line1191">1191: </a>    <font color="#4169E1">else</font>
<a name="line1192">1192: </a>      <font color="#4169E1">for</font> (i = 0; i &lt; s; i++)
<a name="line1193">1193: </a>        <font color="#4169E1">for</font> (j = 0, t-&gt;c[i] = 0; j &lt; s; j++) t-&gt;c[i] += A[i * s + j];
<a name="line1194">1194: </a>  } <font color="#4169E1">else</font> <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArrayzero.html">PetscArrayzero</a>(t-&gt;c, s));

<a name="line1196">1196: </a>  t-&gt;stiffly_accurate = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1197">1197: </a>  <font color="#4169E1">for</font> (i = 0; i &lt; s; i++)
<a name="line1198">1198: </a>    <font color="#4169E1">if</font> (t-&gt;At[(s - 1) * s + i] != t-&gt;bt[i]) t-&gt;stiffly_accurate = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;

<a name="line1200">1200: </a>  t-&gt;explicit_first_stage = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1201">1201: </a>  <font color="#4169E1">for</font> (i = 0; i &lt; s; i++)
<a name="line1202">1202: </a>    <font color="#4169E1">if</font> (t-&gt;At[i] != 0.0) t-&gt;explicit_first_stage = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;

<a name="line1204">1204: </a>  <font color="#B22222">/* def of FSAL can be made more precise */</font>
<a name="line1205">1205: </a>  t-&gt;FSAL_implicit = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)(t-&gt;explicit_first_stage &amp;&amp; t-&gt;stiffly_accurate);

<a name="line1207">1207: </a>  <font color="#4169E1">if</font> (bembedt) {
<a name="line1208">1208: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscMalloc2.html">PetscMalloc2</a>(s, &amp;t-&gt;bembedt, s, &amp;t-&gt;bembed));
<a name="line1209">1209: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;bembedt, bembedt, s));
<a name="line1210">1210: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;bembed, bembed ? bembed : bembedt, s));
<a name="line1211">1211: </a>  }

<a name="line1213">1213: </a>  t-&gt;pinterp = pinterp;
<a name="line1214">1214: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscMalloc2.html">PetscMalloc2</a>(s * pinterp, &amp;t-&gt;binterpt, s * pinterp, &amp;t-&gt;binterp));
<a name="line1215">1215: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;binterpt, binterpt, s * pinterp));
<a name="line1216">1216: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscArraycpy.html">PetscArraycpy</a>(t-&gt;binterp, binterp ? binterp : binterpt, s * pinterp));

<a name="line1218">1218: </a>  link-&gt;next     = ARKTableauList;
<a name="line1219">1219: </a>  ARKTableauList = link;
<a name="line1220">1220: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1221">1221: </a>}

<a name="line1223">1223: </a><font color="#B22222">/*@C</font>
<a name="line1224">1224: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a> - register a `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme by providing the entries in its Butcher tableau and, optionally, embedded approximations and interpolation</font>

<a name="line1226">1226: </a><font color="#B22222">  Logically Collective.</font>

<a name="line1228">1228: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1229">1229: </a><font color="#B22222">+ name     - identifier for method</font>
<a name="line1230">1230: </a><font color="#B22222">. order    - approximation order of method</font>
<a name="line1231">1231: </a><font color="#B22222">. s        - number of stages, this is the dimension of the matrices below</font>
<a name="line1232">1232: </a><font color="#B22222">. At       - Butcher table of stage coefficients (dimension `s`*`s`, row-major order)</font>
<a name="line1233">1233: </a><font color="#B22222">. bt       - Butcher table for completing the step (dimension `s`; pass `NULL` to use the last row of `At`)</font>
<a name="line1234">1234: </a><font color="#B22222">. ct       - Abscissa of each stage (dimension s, NULL to use row sums of At)</font>
<a name="line1235">1235: </a><font color="#B22222">. bembedt  - Stiff part of completion table for embedded method (dimension s; `NULL` if not available)</font>
<a name="line1236">1236: </a><font color="#B22222">. pinterp  - Order of the interpolation scheme, equal to the number of columns of `binterpt` and `binterp`</font>
<a name="line1237">1237: </a><font color="#B22222">- binterpt - Coefficients of the interpolation formula (dimension s*pinterp)</font>

<a name="line1239">1239: </a><font color="#B22222">  Level: advanced</font>

<a name="line1241">1241: </a><font color="#B22222">  Note:</font>
<a name="line1242">1242: </a><font color="#B22222">  Several `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` methods are provided, the use of this function is only needed to create new methods.</font>

<a name="line1244">1244: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSType.html">TSType</a>`, `<a href="../../../../manualpages/TS/TS.html">TS</a>`</font>
<a name="line1245">1245: </a><font color="#B22222">@*/</font>
<a name="line1246">1246: </a><strong><font color="#4169E1"><a name="TSDIRKRegister"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>(<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a> name, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> order, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> s, const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> At[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bt[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> ct[], const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> bembedt[], <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> pinterp, const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> binterpt[])</font></strong>
<a name="line1247">1247: </a>{
<a name="line1248">1248: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1249">1249: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>(name, order, s, At, bt, ct, NULL, NULL, NULL, bembedt, NULL, pinterp, binterpt, NULL));
<a name="line1250">1250: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1251">1251: </a>}

<a name="line1253">1253: </a><font color="#B22222">/*</font>
<a name="line1254">1254: </a><font color="#B22222"> The step completion formula is</font>

<a name="line1256">1256: </a><font color="#B22222"> x1 = x0 - h bt^T YdotI + h b^T YdotRHS</font>

<a name="line1258">1258: </a><font color="#B22222"> This function can be called before or after ts-&gt;vec_sol has been updated.</font>
<a name="line1259">1259: </a><font color="#B22222"> Suppose we have a completion formula (bt,b) and an embedded formula (bet,be) of different order.</font>
<a name="line1260">1260: </a><font color="#B22222"> We can write</font>

<a name="line1262">1262: </a><font color="#B22222"> x1e = x0 - h bet^T YdotI + h be^T YdotRHS</font>
<a name="line1263">1263: </a><font color="#B22222">     = x1 + h bt^T YdotI - h b^T YdotRHS - h bet^T YdotI + h be^T YdotRHS</font>
<a name="line1264">1264: </a><font color="#B22222">     = x1 - h (bet - bt)^T YdotI + h (be - b)^T YdotRHS</font>

<a name="line1266">1266: </a><font color="#B22222"> so we can evaluate the method with different order even after the step has been optimistically completed.</font>
<a name="line1267">1267: </a><font color="#B22222">*/</font>
<a name="line1268">1268: </a><strong><font color="#4169E1"><a name="TSEvaluateStep_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSEvaluateStep_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> order, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> X, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *done)</font></strong>
<a name="line1269">1269: </a>{
<a name="line1270">1270: </a>  TS_ARKIMEX  *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1271">1271: </a>  ARKTableau   tab = ark-&gt;tableau;
<a name="line1272">1272: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a> *w   = ark-&gt;work;
<a name="line1273">1273: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>    h;
<a name="line1274">1274: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>     s = tab-&gt;s, j;
<a name="line1275">1275: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>    hasE;

<a name="line1277">1277: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1278">1278: </a>  <font color="#4169E1">switch</font> (ark-&gt;status) {
<a name="line1279">1279: </a>  <font color="#4169E1">case</font> TS_STEP_INCOMPLETE:
<a name="line1280">1280: </a>  <font color="#4169E1">case</font> TS_STEP_PENDING:
<a name="line1281">1281: </a>    h = ts-&gt;time_step;
<a name="line1282">1282: </a>    <font color="#4169E1">break</font>;
<a name="line1283">1283: </a>  <font color="#4169E1">case</font> TS_STEP_COMPLETE:
<a name="line1284">1284: </a>    h = ts-&gt;ptime - ts-&gt;ptime_prev;
<a name="line1285">1285: </a>    <font color="#4169E1">break</font>;
<a name="line1286">1286: </a><strong><font color="#FF0000">  default:</font></strong>
<a name="line1287">1287: </a>    <a href="../../../../manualpages/Sys/SETERRQ.html">SETERRQ</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_PLIB</a>, <font color="#666666">"Invalid TSStepStatus"</font>);
<a name="line1288">1288: </a>  }
<a name="line1289">1289: </a>  <font color="#4169E1">if</font> (order == tab-&gt;order) {
<a name="line1290">1290: </a>    <font color="#4169E1">if</font> (ark-&gt;status == TS_STEP_INCOMPLETE) {
<a name="line1291">1291: </a>      <font color="#4169E1">if</font> (!ark-&gt;imex &amp;&amp; tab-&gt;stiffly_accurate) { <font color="#B22222">/* Only the stiffly accurate implicit formula is used */</font>
<a name="line1292">1292: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ark-&gt;Y[s - 1], X));
<a name="line1293">1293: </a>      } <font color="#4169E1">else</font> { <font color="#B22222">/* Use the standard completion formula (bt,b) */</font>
<a name="line1294">1294: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, X));
<a name="line1295">1295: </a>        <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * tab-&gt;bt[j];
<a name="line1296">1296: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, w, ark-&gt;YdotI));
<a name="line1297">1297: </a>        <font color="#4169E1">if</font> (tab-&gt;additive &amp;&amp; ark-&gt;imex) { <font color="#B22222">/* Method is IMEX, complete the explicit formula */</font>
<a name="line1298">1298: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1299">1299: </a>          <font color="#4169E1">if</font> (hasE) {
<a name="line1300">1300: </a>            <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * tab-&gt;b[j];
<a name="line1301">1301: </a>            <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, w, ark-&gt;YdotRHS));
<a name="line1302">1302: </a>          }
<a name="line1303">1303: </a>        }
<a name="line1304">1304: </a>      }
<a name="line1305">1305: </a>    } <font color="#4169E1">else</font> <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, X));
<a name="line1306">1306: </a>    <font color="#4169E1">if</font> (done) *done = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1307">1307: </a>    <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1308">1308: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (order == tab-&gt;order - 1) {
<a name="line1309">1309: </a>    <font color="#4169E1">if</font> (!tab-&gt;bembedt) <font color="#4169E1">goto</font> unavailable;
<a name="line1310">1310: </a>    <font color="#4169E1">if</font> (ark-&gt;status == TS_STEP_INCOMPLETE) { <font color="#B22222">/* Complete with the embedded method (bet,be) */</font>
<a name="line1311">1311: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, X));
<a name="line1312">1312: </a>      <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * tab-&gt;bembedt[j];
<a name="line1313">1313: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, w, ark-&gt;YdotI));
<a name="line1314">1314: </a>      <font color="#4169E1">if</font> (tab-&gt;additive) {
<a name="line1315">1315: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1316">1316: </a>        <font color="#4169E1">if</font> (hasE) {
<a name="line1317">1317: </a>          <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * tab-&gt;bembed[j];
<a name="line1318">1318: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, w, ark-&gt;YdotRHS));
<a name="line1319">1319: </a>        }
<a name="line1320">1320: </a>      }
<a name="line1321">1321: </a>    } <font color="#4169E1">else</font> { <font color="#B22222">/* Rollback and re-complete using (bet-be,be-b) */</font>
<a name="line1322">1322: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, X));
<a name="line1323">1323: </a>      <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * (tab-&gt;bembedt[j] - tab-&gt;bt[j]);
<a name="line1324">1324: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, tab-&gt;s, w, ark-&gt;YdotI));
<a name="line1325">1325: </a>      <font color="#4169E1">if</font> (tab-&gt;additive) {
<a name="line1326">1326: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1327">1327: </a>        <font color="#4169E1">if</font> (hasE) {
<a name="line1328">1328: </a>          <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = h * (tab-&gt;bembed[j] - tab-&gt;b[j]);
<a name="line1329">1329: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, w, ark-&gt;YdotRHS));
<a name="line1330">1330: </a>        }
<a name="line1331">1331: </a>      }
<a name="line1332">1332: </a>    }
<a name="line1333">1333: </a>    <font color="#4169E1">if</font> (done) *done = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1334">1334: </a>    <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1335">1335: </a>  }
<a name="line1336">1336: </a><strong><font color="#FF0000">unavailable:</font></strong>
<a name="line1337">1337: </a>  <font color="#4169E1">if</font> (done) *done = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1338">1338: </a>  <font color="#4169E1">else</font>
<a name="line1339">1339: </a>    <a href="../../../../manualpages/Sys/SETERRQ.html">SETERRQ</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"ARKIMEX '%s' of order %"</font> PetscInt_FMT <font color="#666666">" cannot evaluate step at order %"</font> PetscInt_FMT <font color="#666666">". Consider using -ts_adapt_type none or a different method that has an embedded estimate."</font>, tab-&gt;name,
<a name="line1340">1340: </a>            tab-&gt;order, order);
<a name="line1341">1341: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1342">1342: </a>}

<a name="line1344">1344: </a><strong><font color="#4169E1"><a name="TSARKIMEXTestMassIdentity"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXTestMassIdentity(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *id)</font></strong>
<a name="line1345">1345: </a>{
<a name="line1346">1346: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         Udot, Y1, Y2;
<a name="line1347">1347: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1348">1348: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>   norm;

<a name="line1350">1350: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1351">1351: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;Udot));
<a name="line1352">1352: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;Y1));
<a name="line1353">1353: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;Y2));
<a name="line1354">1354: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIFunction.html">TSComputeIFunction</a>(ts, ts-&gt;ptime, ts-&gt;vec_sol, Udot, Y1, ark-&gt;imex));
<a name="line1355">1355: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecSetRandom.html">VecSetRandom</a>(Udot, NULL));
<a name="line1356">1356: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIFunction.html">TSComputeIFunction</a>(ts, ts-&gt;ptime, ts-&gt;vec_sol, Udot, Y2, ark-&gt;imex));
<a name="line1357">1357: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(Y2, -1.0, Y1));
<a name="line1358">1358: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(Y2, -1.0, Udot));
<a name="line1359">1359: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecNorm.html">VecNorm</a>(Y2, <a href="../../../../manualpages/Vec/NORM_2.html">NORM_2</a>, &amp;norm));
<a name="line1360">1360: </a>  <font color="#4169E1">if</font> (norm &lt; 100.0 * PETSC_MACHINE_EPSILON) {
<a name="line1361">1361: </a>    *id = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1362">1362: </a>  } <font color="#4169E1">else</font> {
<a name="line1363">1363: </a>    *id = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1364">1364: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Profiling/PetscInfo.html">PetscInfo</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"IFunction(Udot = random) - IFunction(Udot = 0) is not near Udot, %g, suspect mass matrix implied in IFunction() is not the identity as required\n"</font>, (double)norm));
<a name="line1365">1365: </a>  }
<a name="line1366">1366: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;Udot));
<a name="line1367">1367: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;Y1));
<a name="line1368">1368: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;Y2));
<a name="line1369">1369: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1370">1370: </a>}

<a name="line1372">1372: </a><strong><font color="#4169E1"><a name="TSRollBack_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSRollBack_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1373">1373: </a>{
<a name="line1374">1374: </a>  TS_ARKIMEX      *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1375">1375: </a>  ARKTableau       tab = ark-&gt;tableau;
<a name="line1376">1376: </a>  const <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   s   = tab-&gt;s;
<a name="line1377">1377: </a>  const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *bt = tab-&gt;bt, *b = tab-&gt;b;
<a name="line1378">1378: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a>     *w     = ark-&gt;work;
<a name="line1379">1379: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>             *YdotI = ark-&gt;YdotI, *YdotRHS = ark-&gt;YdotRHS;
<a name="line1380">1380: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         j;
<a name="line1381">1381: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        h;

<a name="line1383">1383: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1384">1384: </a>  <font color="#4169E1">switch</font> (ark-&gt;status) {
<a name="line1385">1385: </a>  <font color="#4169E1">case</font> TS_STEP_INCOMPLETE:
<a name="line1386">1386: </a>  <font color="#4169E1">case</font> TS_STEP_PENDING:
<a name="line1387">1387: </a>    h = ts-&gt;time_step;
<a name="line1388">1388: </a>    <font color="#4169E1">break</font>;
<a name="line1389">1389: </a>  <font color="#4169E1">case</font> TS_STEP_COMPLETE:
<a name="line1390">1390: </a>    h = ts-&gt;ptime - ts-&gt;ptime_prev;
<a name="line1391">1391: </a>    <font color="#4169E1">break</font>;
<a name="line1392">1392: </a><strong><font color="#FF0000">  default:</font></strong>
<a name="line1393">1393: </a>    <a href="../../../../manualpages/Sys/SETERRQ.html">SETERRQ</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_PLIB</a>, <font color="#666666">"Invalid TSStepStatus"</font>);
<a name="line1394">1394: </a>  }
<a name="line1395">1395: </a>  <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = -h * bt[j];
<a name="line1396">1396: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(ts-&gt;vec_sol, s, w, YdotI));
<a name="line1397">1397: </a>  <font color="#4169E1">if</font> (tab-&gt;additive) {
<a name="line1398">1398: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> hasE;

<a name="line1400">1400: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1401">1401: </a>    <font color="#4169E1">if</font> (hasE) {
<a name="line1402">1402: </a>      <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = -h * b[j];
<a name="line1403">1403: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(ts-&gt;vec_sol, s, w, YdotRHS));
<a name="line1404">1404: </a>    }
<a name="line1405">1405: </a>  }
<a name="line1406">1406: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1407">1407: </a>}

<a name="line1409">1409: </a><strong><font color="#4169E1"><a name="TSStep_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSStep_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1410">1410: </a>{
<a name="line1411">1411: </a>  TS_ARKIMEX      *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1412">1412: </a>  ARKTableau       tab = ark-&gt;tableau;
<a name="line1413">1413: </a>  const <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   s   = tab-&gt;s;
<a name="line1414">1414: </a>  const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *At = tab-&gt;At, *A = tab-&gt;A, *ct = tab-&gt;ct, *c = tab-&gt;c;
<a name="line1415">1415: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a>     *w = ark-&gt;work;
<a name="line1416">1416: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>             *Y = ark-&gt;Y, *YdotI = ark-&gt;YdotI, *YdotRHS = ark-&gt;YdotRHS, Ydot = ark-&gt;Ydot, Ydot0 = ark-&gt;Ydot0, Z = ark-&gt;Z;
<a name="line1417">1417: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>        extrapolate = ark-&gt;extrapolate;
<a name="line1418">1418: </a>  <a href="../../../../manualpages/TS/TSAdapt.html">TSAdapt</a>          adapt;
<a name="line1419">1419: </a>  <a href="../../../../manualpages/SNES/SNES.html">SNES</a>             snes;
<a name="line1420">1420: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         i, j, its, lits;
<a name="line1421">1421: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         rejections = 0;
<a name="line1422">1422: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>        hasE = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>, dirk = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)(!tab-&gt;additive), stageok, accept = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;
<a name="line1423">1423: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        next_time_step = ts-&gt;time_step;

<a name="line1425">1425: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1426">1426: </a>  <font color="#4169E1">if</font> (ark-&gt;extrapolate &amp;&amp; !ark-&gt;Y_prev) {
<a name="line1427">1427: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;Y_prev));
<a name="line1428">1428: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotI_prev));
<a name="line1429">1429: </a>    <font color="#4169E1">if</font> (tab-&gt;additive) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotRHS_prev));
<a name="line1430">1430: </a>  }

<a name="line1432">1432: </a>  <font color="#4169E1">if</font> (!dirk) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1433">1433: </a>  <font color="#4169E1">if</font> (!hasE) dirk = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;

<a name="line1435">1435: </a>  <font color="#4169E1">if</font> (!ts-&gt;steprollback) {
<a name="line1436">1436: </a>    <font color="#4169E1">if</font> (dirk || ts-&gt;equation_type &gt;= <a href="../../../../manualpages/TS/TSEquationType.html">TS_EQ_IMPLICIT</a>) { <font color="#B22222">/* Save the initial slope for the next step */</font>
<a name="line1437">1437: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(YdotI[s - 1], Ydot0));
<a name="line1438">1438: </a>    }
<a name="line1439">1439: </a>    <font color="#4169E1">if</font> (ark-&gt;extrapolate &amp;&amp; !ts-&gt;steprestart) { <font color="#B22222">/* Save the Y, YdotI, YdotRHS for extrapolation initial guess */</font>
<a name="line1440">1440: </a>      <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) {
<a name="line1441">1441: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(Y[i], ark-&gt;Y_prev[i]));
<a name="line1442">1442: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(YdotI[i], ark-&gt;YdotI_prev[i]));
<a name="line1443">1443: </a>        <font color="#4169E1">if</font> (tab-&gt;additive &amp;&amp; hasE) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(YdotRHS[i], ark-&gt;YdotRHS_prev[i]));
<a name="line1444">1444: </a>      }
<a name="line1445">1445: </a>    }
<a name="line1446">1446: </a>  }

<a name="line1448">1448: </a>  <font color="#B22222">/*</font>
<a name="line1449">1449: </a><font color="#B22222">     For fully implicit formulations we must solve the equations</font>

<a name="line1451">1451: </a><font color="#B22222">       F(t_n,x_n,xdot) = 0</font>

<a name="line1453">1453: </a><font color="#B22222">     for the explicit first stage.</font>
<a name="line1454">1454: </a><font color="#B22222">     Here we call <a href="../../../../manualpages/SNES/SNESSolve.html">SNESSolve</a> using PETSC_MAX_REAL as shift to flag it.</font>
<a name="line1455">1455: </a><font color="#B22222">     Special handling is inside SNESTSFormFunction_ARKIMEX and SNESTSFormJacobian_ARKIMEX</font>
<a name="line1456">1456: </a><font color="#B22222">  */</font>
<a name="line1457">1457: </a>  <font color="#4169E1">if</font> (dirk &amp;&amp; tab-&gt;explicit_first_stage &amp;&amp; ts-&gt;steprestart) {
<a name="line1458">1458: </a>    ark-&gt;scoeff = PETSC_MAX_REAL;
<a name="line1459">1459: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, Z));
<a name="line1460">1460: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetSNES.html">TSGetSNES</a>(ts, &amp;snes));
<a name="line1461">1461: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESSolve.html">SNESSolve</a>(snes, NULL, Ydot0));
<a name="line1462">1462: </a>  }

<a name="line1464">1464: </a>  <font color="#B22222">/* For IMEX we compute a step */</font>
<a name="line1465">1465: </a>  <font color="#4169E1">if</font> (!dirk &amp;&amp; ts-&gt;equation_type &gt;= <a href="../../../../manualpages/TS/TSEquationType.html">TS_EQ_IMPLICIT</a> &amp;&amp; tab-&gt;explicit_first_stage &amp;&amp; ts-&gt;steprestart) {
<a name="line1466">1466: </a>    <a href="../../../../manualpages/TS/TS.html">TS</a> ts_start;
<a name="line1467">1467: </a>    <font color="#4169E1">if</font> (<a href="../../../../manualpages/Sys/PetscDefined.html">PetscDefined</a>(USE_DEBUG) &amp;&amp; hasE) {
<a name="line1468">1468: </a>      <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> id = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1469">1469: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTestMassIdentity(ts, &amp;id));
<a name="line1470">1470: </a>      <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(id, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_ARG_INCOMP</a>, <font color="#666666">"This scheme requires an identity mass matrix, however the <a href="../../../../manualpages/TS/TSIFunction.html">TSIFunction</a> you provided does not utilize an identity mass matrix"</font>);
<a name="line1471">1471: </a>    }
<a name="line1472">1472: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSClone.html">TSClone</a>(ts, &amp;ts_start));
<a name="line1473">1473: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetSolution.html">TSSetSolution</a>(ts_start, ts-&gt;vec_sol));
<a name="line1474">1474: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetTime.html">TSSetTime</a>(ts_start, ts-&gt;ptime));
<a name="line1475">1475: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetMaxSteps.html">TSSetMaxSteps</a>(ts_start, ts-&gt;steps + 1));
<a name="line1476">1476: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetMaxTime.html">TSSetMaxTime</a>(ts_start, ts-&gt;ptime + ts-&gt;time_step));
<a name="line1477">1477: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetExactFinalTime.html">TSSetExactFinalTime</a>(ts_start, <a href="../../../../manualpages/TS/TSExactFinalTimeOption.html">TS_EXACTFINALTIME_STEPOVER</a>));
<a name="line1478">1478: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetTimeStep.html">TSSetTimeStep</a>(ts_start, ts-&gt;time_step));
<a name="line1479">1479: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetType.html">TSSetType</a>(ts_start, <a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>));
<a name="line1480">1480: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a>(ts_start, <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>));
<a name="line1481">1481: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>(ts_start, <a href="../../../../manualpages/TS/TSARKIMEX1BEE.html">TSARKIMEX1BEE</a>));

<a name="line1483">1483: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSRestartStep.html">TSRestartStep</a>(ts_start));
<a name="line1484">1484: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSolve.html">TSSolve</a>(ts_start, ts-&gt;vec_sol));
<a name="line1485">1485: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetTime.html">TSGetTime</a>(ts_start, &amp;ts-&gt;ptime));
<a name="line1486">1486: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetTimeStep.html">TSGetTimeStep</a>(ts_start, &amp;ts-&gt;time_step));

<a name="line1488">1488: </a>    { <font color="#B22222">/* Save the initial slope for the next step */</font>
<a name="line1489">1489: </a>      TS_ARKIMEX *ark_start = (TS_ARKIMEX *)ts_start-&gt;data;
<a name="line1490">1490: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ark_start-&gt;YdotI[ark_start-&gt;tableau-&gt;s - 1], Ydot0));
<a name="line1491">1491: </a>    }
<a name="line1492">1492: </a>    ts-&gt;steps++;

<a name="line1494">1494: </a>    <font color="#B22222">/* Set the correct <a href="../../../../manualpages/TS/TS.html">TS</a> in <a href="../../../../manualpages/SNES/SNES.html">SNES</a> */</font>
<a name="line1495">1495: </a>    <font color="#B22222">/* We'll try to bypass this by changing the method on the fly */</font>
<a name="line1496">1496: </a>    {
<a name="line1497">1497: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetSNES.html">TSGetSNES</a>(ts, &amp;snes));
<a name="line1498">1498: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSSetSNES.html">TSSetSNES</a>(ts, snes));
<a name="line1499">1499: </a>    }
<a name="line1500">1500: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDestroy.html">TSDestroy</a>(&amp;ts_start));
<a name="line1501">1501: </a>  }

<a name="line1503">1503: </a>  ark-&gt;status = TS_STEP_INCOMPLETE;
<a name="line1504">1504: </a>  <font color="#4169E1">while</font> (!ts-&gt;reason &amp;&amp; ark-&gt;status != TS_STEP_COMPLETE) {
<a name="line1505">1505: </a>    <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> t = ts-&gt;ptime;
<a name="line1506">1506: </a>    <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> h = ts-&gt;time_step;
<a name="line1507">1507: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) {
<a name="line1508">1508: </a>      ark-&gt;stage_time = t + h * ct[i];
<a name="line1509">1509: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSPreStage.html">TSPreStage</a>(ts, ark-&gt;stage_time));
<a name="line1510">1510: </a>      <font color="#4169E1">if</font> (At[i * s + i] == 0) { <font color="#B22222">/* This stage is explicit */</font>
<a name="line1511">1511: </a>        <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(i == 0 || ts-&gt;equation_type &lt; <a href="../../../../manualpages/TS/TSEquationType.html">TS_EQ_IMPLICIT</a>, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"Explicit stages other than the first one are not supported for implicit problems"</font>);
<a name="line1512">1512: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, Y[i]));
<a name="line1513">1513: </a>        <font color="#4169E1">for</font> (j = 0; j &lt; i; j++) w[j] = h * At[i * s + j];
<a name="line1514">1514: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(Y[i], i, w, YdotI));
<a name="line1515">1515: </a>        <font color="#4169E1">if</font> (tab-&gt;additive &amp;&amp; hasE) {
<a name="line1516">1516: </a>          <font color="#4169E1">for</font> (j = 0; j &lt; i; j++) w[j] = h * A[i * s + j];
<a name="line1517">1517: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(Y[i], i, w, YdotRHS));
<a name="line1518">1518: </a>        }
<a name="line1519">1519: </a>      } <font color="#4169E1">else</font> {
<a name="line1520">1520: </a>        ark-&gt;scoeff = 1. / At[i * s + i];
<a name="line1521">1521: </a>        <font color="#B22222">/* Ydot = shift*(Y-Z) */</font>
<a name="line1522">1522: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ts-&gt;vec_sol, Z));
<a name="line1523">1523: </a>        <font color="#4169E1">for</font> (j = 0; j &lt; i; j++) w[j] = h * At[i * s + j];
<a name="line1524">1524: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(Z, i, w, YdotI));
<a name="line1525">1525: </a>        <font color="#4169E1">if</font> (tab-&gt;additive &amp;&amp; hasE) {
<a name="line1526">1526: </a>          <font color="#4169E1">for</font> (j = 0; j &lt; i; j++) w[j] = h * A[i * s + j];
<a name="line1527">1527: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(Z, i, w, YdotRHS));
<a name="line1528">1528: </a>        }
<a name="line1529">1529: </a>        <font color="#4169E1">if</font> (extrapolate &amp;&amp; !ts-&gt;steprestart) {
<a name="line1530">1530: </a>          <font color="#B22222">/* Initial guess extrapolated from previous time step stage values */</font>
<a name="line1531">1531: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSExtrapolate_ARKIMEX(ts, c[i], Y[i]));
<a name="line1532">1532: </a>        } <font color="#4169E1">else</font> {
<a name="line1533">1533: </a>          <font color="#B22222">/* Initial guess taken from last stage */</font>
<a name="line1534">1534: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(i &gt; 0 ? Y[i - 1] : ts-&gt;vec_sol, Y[i]));
<a name="line1535">1535: </a>        }
<a name="line1536">1536: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetSNES.html">TSGetSNES</a>(ts, &amp;snes));
<a name="line1537">1537: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESSolve.html">SNESSolve</a>(snes, NULL, Y[i]));
<a name="line1538">1538: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetIterationNumber.html">SNESGetIterationNumber</a>(snes, &amp;its));
<a name="line1539">1539: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetLinearSolveIterations.html">SNESGetLinearSolveIterations</a>(snes, &amp;lits));
<a name="line1540">1540: </a>        ts-&gt;snes_its += its;
<a name="line1541">1541: </a>        ts-&gt;ksp_its += lits;
<a name="line1542">1542: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetAdapt.html">TSGetAdapt</a>(ts, &amp;adapt));
<a name="line1543">1543: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSAdaptCheckStage.html">TSAdaptCheckStage</a>(adapt, ts, ark-&gt;stage_time, Y[i], &amp;stageok));
<a name="line1544">1544: </a>        <font color="#4169E1">if</font> (!stageok) {
<a name="line1545">1545: </a>          <font color="#B22222">/* We are likely rejecting the step because of solver or function domain problems so we should not attempt to</font>
<a name="line1546">1546: </a><font color="#B22222">           * use extrapolation to initialize the solves on the next attempt. */</font>
<a name="line1547">1547: </a>          extrapolate = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1548">1548: </a>          <font color="#4169E1">goto</font> reject_step;
<a name="line1549">1549: </a>        }
<a name="line1550">1550: </a>      }
<a name="line1551">1551: </a>      <font color="#4169E1">if</font> (dirk || ts-&gt;equation_type &gt;= <a href="../../../../manualpages/TS/TSEquationType.html">TS_EQ_IMPLICIT</a>) {
<a name="line1552">1552: </a>        <font color="#4169E1">if</font> (i == 0 &amp;&amp; tab-&gt;explicit_first_stage) {
<a name="line1553">1553: </a>          <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(tab-&gt;stiffly_accurate, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"%s %s is not stiffly accurate and therefore explicit-first stage methods cannot be used if the equation is implicit because the slope cannot be evaluated"</font>,
<a name="line1554">1554: </a>                     ((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts)-&gt;type_name, ark-&gt;tableau-&gt;name);
<a name="line1555">1555: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(Ydot0, YdotI[0])); <font color="#B22222">/* YdotI = YdotI(tn-1) */</font>
<a name="line1556">1556: </a>        } <font color="#4169E1">else</font> {
<a name="line1557">1557: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPBYPCZ.html">VecAXPBYPCZ</a>(YdotI[i], -ark-&gt;scoeff / h, ark-&gt;scoeff / h, 0, Z, Y[i])); <font color="#B22222">/* YdotI = shift*(X-Z) */</font>
<a name="line1558">1558: </a>        }
<a name="line1559">1559: </a>      } <font color="#4169E1">else</font> {
<a name="line1560">1560: </a>        <font color="#4169E1">if</font> (i == 0 &amp;&amp; tab-&gt;explicit_first_stage) {
<a name="line1561">1561: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecZeroEntries.html">VecZeroEntries</a>(Ydot));
<a name="line1562">1562: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIFunction.html">TSComputeIFunction</a>(ts, t + h * ct[i], Y[i], Ydot, YdotI[i], ark-&gt;imex)); <font color="#B22222">/* YdotI = -G(t,Y,0)   */</font>
<a name="line1563">1563: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecScale.html">VecScale</a>(YdotI[i], -1.0));
<a name="line1564">1564: </a>        } <font color="#4169E1">else</font> {
<a name="line1565">1565: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPBYPCZ.html">VecAXPBYPCZ</a>(YdotI[i], -ark-&gt;scoeff / h, ark-&gt;scoeff / h, 0, Z, Y[i])); <font color="#B22222">/* YdotI = shift*(X-Z) */</font>
<a name="line1566">1566: </a>        }
<a name="line1567">1567: </a>        <font color="#4169E1">if</font> (hasE) {
<a name="line1568">1568: </a>          <font color="#4169E1">if</font> (ark-&gt;imex) {
<a name="line1569">1569: </a>            <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeRHSFunction.html">TSComputeRHSFunction</a>(ts, t + h * c[i], Y[i], YdotRHS[i]));
<a name="line1570">1570: </a>          } <font color="#4169E1">else</font> {
<a name="line1571">1571: </a>            <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecZeroEntries.html">VecZeroEntries</a>(YdotRHS[i]));
<a name="line1572">1572: </a>          }
<a name="line1573">1573: </a>        }
<a name="line1574">1574: </a>      }
<a name="line1575">1575: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSPostStage.html">TSPostStage</a>(ts, ark-&gt;stage_time, i, Y));
<a name="line1576">1576: </a>    }

<a name="line1578">1578: </a>    ark-&gt;status = TS_STEP_INCOMPLETE;
<a name="line1579">1579: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSEvaluateStep_ARKIMEX(ts, tab-&gt;order, ts-&gt;vec_sol, NULL));
<a name="line1580">1580: </a>    ark-&gt;status = TS_STEP_PENDING;
<a name="line1581">1581: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetAdapt.html">TSGetAdapt</a>(ts, &amp;adapt));
<a name="line1582">1582: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSAdaptCandidatesClear.html">TSAdaptCandidatesClear</a>(adapt));
<a name="line1583">1583: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSAdaptCandidateAdd.html">TSAdaptCandidateAdd</a>(adapt, tab-&gt;name, tab-&gt;order, 1, tab-&gt;ccfl, (<a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>)tab-&gt;s, <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>));
<a name="line1584">1584: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSAdaptChoose.html">TSAdaptChoose</a>(adapt, ts, ts-&gt;time_step, NULL, &amp;next_time_step, &amp;accept));
<a name="line1585">1585: </a>    ark-&gt;status = accept ? TS_STEP_COMPLETE : TS_STEP_INCOMPLETE;
<a name="line1586">1586: </a>    <font color="#4169E1">if</font> (!accept) { <font color="#B22222">/* Roll back the current step */</font>
<a name="line1587">1587: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSRollBack_ARKIMEX(ts));
<a name="line1588">1588: </a>      ts-&gt;time_step = next_time_step;
<a name="line1589">1589: </a>      <font color="#4169E1">goto</font> reject_step;
<a name="line1590">1590: </a>    }

<a name="line1592">1592: </a>    ts-&gt;ptime += ts-&gt;time_step;
<a name="line1593">1593: </a>    ts-&gt;time_step = next_time_step;
<a name="line1594">1594: </a>    <font color="#4169E1">break</font>;

<a name="line1596">1596: </a><strong><font color="#FF0000">  reject_step:</font></strong>
<a name="line1597">1597: </a>    ts-&gt;reject++;
<a name="line1598">1598: </a>    accept = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line1599">1599: </a>    <font color="#4169E1">if</font> (!ts-&gt;reason &amp;&amp; ++rejections &gt; ts-&gt;max_reject &amp;&amp; ts-&gt;max_reject &gt;= 0) {
<a name="line1600">1600: </a>      ts-&gt;reason = <a href="../../../../manualpages/TS/TS_DIVERGED_STEP_REJECTED.html">TS_DIVERGED_STEP_REJECTED</a>;
<a name="line1601">1601: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Profiling/PetscInfo.html">PetscInfo</a>(ts, <font color="#666666">"Step=%"</font> PetscInt_FMT <font color="#666666">", step rejections %"</font> PetscInt_FMT <font color="#666666">" greater than current <a href="../../../../manualpages/TS/TS.html">TS</a> allowed, stopping solve\n"</font>, ts-&gt;steps, rejections));
<a name="line1602">1602: </a>    }
<a name="line1603">1603: </a>  }
<a name="line1604">1604: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1605">1605: </a>}

<a name="line1607">1607: </a><font color="#B22222">/*</font>
<a name="line1608">1608: </a><font color="#B22222">  This adjoint step function assumes the partitioned ODE system has an identity mass matrix and thus can be represented in the form</font>
<a name="line1609">1609: </a><font color="#B22222">  Udot = H(t,U) + G(t,U)</font>
<a name="line1610">1610: </a><font color="#B22222">  This corresponds to F(t,U,Udot) = Udot-H(t,U).</font>

<a name="line1612">1612: </a><font color="#B22222">  The complete adjoint equations are</font>
<a name="line1613">1613: </a><font color="#B22222">  (shift*I - dHdu) lambda_s[i]   = 1/at[i][i] (</font>
<a name="line1614">1614: </a><font color="#B22222">    dGdU (b_i lambda_{n+1} + \sum_{j=i+1}^s a[j][i] lambda_s[j])</font>
<a name="line1615">1615: </a><font color="#B22222">    + dHdU (bt[i] lambda_{n+1} +  \sum_{j=i+1}^s at[j][i] lambda_s[j])), i = s-1,...,0</font>
<a name="line1616">1616: </a><font color="#B22222">  lambda_n = lambda_{n+1} + \sum_{j=1}^s lambda_s[j]</font>
<a name="line1617">1617: </a><font color="#B22222">  mu_{n+1}[i]   = h (at[i][i] dHdP lambda_s[i]</font>
<a name="line1618">1618: </a><font color="#B22222">    + dGdP (b_i lambda_{n+1} + \sum_{j=i+1}^s a[j][i] lambda_s[j])</font>
<a name="line1619">1619: </a><font color="#B22222">    + dHdP (bt[i] lambda_{n+1} + \sum_{j=i+1}^s at[j][i] lambda_s[j])), i = s-1,...,0</font>
<a name="line1620">1620: </a><font color="#B22222">  mu_n = mu_{n+1} + \sum_{j=1}^s mu_{n+1}[j]</font>
<a name="line1621">1621: </a><font color="#B22222">  where shift = 1/(at[i][i]*h)</font>

<a name="line1623">1623: </a><font color="#B22222">  If at[i][i] is 0, the first equation falls back to</font>
<a name="line1624">1624: </a><font color="#B22222">  lambda_s[i] = h (</font>
<a name="line1625">1625: </a><font color="#B22222">    (b_i dGdU + bt[i] dHdU) lambda_{n+1} + dGdU \sum_{j=i+1}^s a[j][i] lambda_s[j]</font>
<a name="line1626">1626: </a><font color="#B22222">    + dHdU \sum_{j=i+1}^s at[j][i] lambda_s[j])</font>

<a name="line1628">1628: </a><font color="#B22222">*/</font>
<a name="line1629">1629: </a><strong><font color="#4169E1"><a name="TSAdjointStep_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSAdjointStep_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1630">1630: </a>{
<a name="line1631">1631: </a>  TS_ARKIMEX      *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1632">1632: </a>  ARKTableau       tab = ark-&gt;tableau;
<a name="line1633">1633: </a>  const <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>   s   = tab-&gt;s;
<a name="line1634">1634: </a>  const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *At = tab-&gt;At, *A = tab-&gt;A, *ct = tab-&gt;ct, *c = tab-&gt;c, *b = tab-&gt;b, *bt = tab-&gt;bt;
<a name="line1635">1635: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a>     *w = ark-&gt;work;
<a name="line1636">1636: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>             *Y = ark-&gt;Y, Ydot = ark-&gt;Ydot, *VecsDeltaLam = ark-&gt;VecsDeltaLam, *VecsSensiTemp = ark-&gt;VecsSensiTemp, *VecsSensiPTemp = ark-&gt;VecsSensiPTemp;
<a name="line1637">1637: </a>  <a href="../../../../manualpages/Mat/Mat.html">Mat</a>              Jex, Jim, Jimpre;
<a name="line1638">1638: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         i, j, nadj;
<a name="line1639">1639: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        t                 = ts-&gt;ptime, stage_time_ex;
<a name="line1640">1640: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        adjoint_time_step = -ts-&gt;time_step; <font color="#B22222">/* always positive since ts-&gt;time_step is negative */</font>
<a name="line1641">1641: </a>  <a href="../../../../manualpages/KSP/KSP.html">KSP</a>              ksp;

<a name="line1643">1643: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1644">1644: </a>  ark-&gt;status = TS_STEP_INCOMPLETE;
<a name="line1645">1645: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetKSP.html">SNESGetKSP</a>(ts-&gt;snes, &amp;ksp));
<a name="line1646">1646: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSGetRHSMats_Private(ts, &amp;Jex, NULL));
<a name="line1647">1647: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetIJacobian.html">TSGetIJacobian</a>(ts, &amp;Jim, &amp;Jimpre, NULL, NULL));

<a name="line1649">1649: </a>  <font color="#4169E1">for</font> (i = s - 1; i &gt;= 0; i--) {
<a name="line1650">1650: </a>    ark-&gt;stage_time = t - adjoint_time_step * (1.0 - ct[i]);
<a name="line1651">1651: </a>    stage_time_ex   = t - adjoint_time_step * (1.0 - c[i]);
<a name="line1652">1652: </a>    <font color="#4169E1">if</font> (At[i * s + i] == 0) { // This stage is explicit
<a name="line1653">1653: </a>      ark-&gt;scoeff = 0.;
<a name="line1654">1654: </a>    } <font color="#4169E1">else</font> {
<a name="line1655">1655: </a>      ark-&gt;scoeff = -1. / At[i * s + i]; // this makes shift=ark-&gt;scoeff/ts-&gt;time_step positive since ts-&gt;time_step is negative
<a name="line1656">1656: </a>    }
<a name="line1657">1657: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sensitivity/TSComputeSNESJacobian.html">TSComputeSNESJacobian</a>(ts, Y[i], Jim, Jimpre));
<a name="line1658">1658: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeRHSJacobian.html">TSComputeRHSJacobian</a>(ts, stage_time_ex, Y[i], Jex, Jex));
<a name="line1659">1659: </a>    <font color="#4169E1">if</font> (ts-&gt;vecs_sensip) {
<a name="line1660">1660: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sensitivity/TSComputeIJacobianP.html">TSComputeIJacobianP</a>(ts, ark-&gt;stage_time, Y[i], Ydot, ark-&gt;scoeff / adjoint_time_step, ts-&gt;Jacp, <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>)); // get dFdP (-dHdP), Ydot not really used since mass matrix is identity
<a name="line1661">1661: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sensitivity/TSComputeRHSJacobianP.html">TSComputeRHSJacobianP</a>(ts, stage_time_ex, Y[i], ts-&gt;Jacprhs));                                                 // get dGdP
<a name="line1662">1662: </a>    }
<a name="line1663">1663: </a>    <font color="#B22222">/* Build RHS (stored in VecsDeltaLam) for first-order adjoint */</font>
<a name="line1664">1664: </a>    <font color="#4169E1">for</font> (nadj = 0; nadj &lt; ts-&gt;numcost; nadj++) {
<a name="line1665">1665: </a>      <font color="#B22222">/* build implicit part */</font>
<a name="line1666">1666: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecSet.html">VecSet</a>(VecsSensiTemp[nadj], 0));
<a name="line1667">1667: </a>      <font color="#4169E1">if</font> (s - i - 1 &gt; 0) {
<a name="line1668">1668: </a>        <font color="#B22222">/* Temp = -\sum_{j=i+1}^s at[j][i] lambda_s[j] */</font>
<a name="line1669">1669: </a>        <font color="#4169E1">for</font> (j = i + 1; j &lt; s; j++) w[j - i - 1] = -At[j * s + i];
<a name="line1670">1670: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(VecsSensiTemp[nadj], s - i - 1, w, &amp;VecsDeltaLam[nadj * s + i + 1]));
<a name="line1671">1671: </a>      }
<a name="line1672">1672: </a>      <font color="#B22222">/* Temp = Temp - bt[i] lambda_{n+1} */</font>
<a name="line1673">1673: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(VecsSensiTemp[nadj], -bt[i], ts-&gt;vecs_sensi[nadj]));
<a name="line1674">1674: </a>      <font color="#4169E1">if</font> (bt[i] || s - i - 1 &gt; 0) {
<a name="line1675">1675: </a>        <font color="#B22222">/* (shift I - dHdU) Temp */</font>
<a name="line1676">1676: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatMultTranspose.html">MatMultTranspose</a>(Jim, VecsSensiTemp[nadj], VecsDeltaLam[nadj * s + i]));
<a name="line1677">1677: </a>        <font color="#B22222">/* cancel out shift Temp where shift=-scoeff/h */</font>
<a name="line1678">1678: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(VecsDeltaLam[nadj * s + i], ark-&gt;scoeff / adjoint_time_step, VecsSensiTemp[nadj]));
<a name="line1679">1679: </a>        <font color="#4169E1">if</font> (ts-&gt;vecs_sensip) {
<a name="line1680">1680: </a>          <font color="#B22222">/* - dHdP Temp */</font>
<a name="line1681">1681: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatMultTranspose.html">MatMultTranspose</a>(ts-&gt;Jacp, VecsSensiTemp[nadj], VecsSensiPTemp[nadj]));
<a name="line1682">1682: </a>          <font color="#B22222">/* mu_n += -h dHdP Temp */</font>
<a name="line1683">1683: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(ts-&gt;vecs_sensip[nadj], adjoint_time_step, VecsSensiPTemp[nadj]));
<a name="line1684">1684: </a>        }
<a name="line1685">1685: </a>      } <font color="#4169E1">else</font> {
<a name="line1686">1686: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecSet.html">VecSet</a>(VecsDeltaLam[nadj * s + i], 0)); // make sure it is initialized
<a name="line1687">1687: </a>      }
<a name="line1688">1688: </a>      <font color="#B22222">/* build explicit part */</font>
<a name="line1689">1689: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecSet.html">VecSet</a>(VecsSensiTemp[nadj], 0));
<a name="line1690">1690: </a>      <font color="#4169E1">if</font> (s - i - 1 &gt; 0) {
<a name="line1691">1691: </a>        <font color="#B22222">/* Temp = \sum_{j=i+1}^s a[j][i] lambda_s[j] */</font>
<a name="line1692">1692: </a>        <font color="#4169E1">for</font> (j = i + 1; j &lt; s; j++) w[j - i - 1] = A[j * s + i];
<a name="line1693">1693: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(VecsSensiTemp[nadj], s - i - 1, w, &amp;VecsDeltaLam[nadj * s + i + 1]));
<a name="line1694">1694: </a>      }
<a name="line1695">1695: </a>      <font color="#B22222">/* Temp = Temp + b[i] lambda_{n+1} */</font>
<a name="line1696">1696: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(VecsSensiTemp[nadj], b[i], ts-&gt;vecs_sensi[nadj]));
<a name="line1697">1697: </a>      <font color="#4169E1">if</font> (b[i] || s - i - 1 &gt; 0) {
<a name="line1698">1698: </a>        <font color="#B22222">/* dGdU Temp */</font>
<a name="line1699">1699: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatMultTransposeAdd.html">MatMultTransposeAdd</a>(Jex, VecsSensiTemp[nadj], VecsDeltaLam[nadj * s + i], VecsDeltaLam[nadj * s + i]));
<a name="line1700">1700: </a>        <font color="#4169E1">if</font> (ts-&gt;vecs_sensip) {
<a name="line1701">1701: </a>          <font color="#B22222">/* dGdP Temp */</font>
<a name="line1702">1702: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatMultTranspose.html">MatMultTranspose</a>(ts-&gt;Jacprhs, VecsSensiTemp[nadj], VecsSensiPTemp[nadj]));
<a name="line1703">1703: </a>          <font color="#B22222">/* mu_n += h dGdP Temp */</font>
<a name="line1704">1704: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(ts-&gt;vecs_sensip[nadj], adjoint_time_step, VecsSensiPTemp[nadj]));
<a name="line1705">1705: </a>        }
<a name="line1706">1706: </a>      }
<a name="line1707">1707: </a>      <font color="#B22222">/* Build LHS for first-order adjoint */</font>
<a name="line1708">1708: </a>      <font color="#4169E1">if</font> (At[i * s + i] == 0) { // This stage is explicit
<a name="line1709">1709: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecScale.html">VecScale</a>(VecsDeltaLam[nadj * s + i], adjoint_time_step));
<a name="line1710">1710: </a>      } <font color="#4169E1">else</font> {
<a name="line1711">1711: </a>        <a href="../../../../manualpages/KSP/KSP.html">KSP</a>                ksp;
<a name="line1712">1712: </a>        <a href="../../../../manualpages/KSP/KSPConvergedReason.html">KSPConvergedReason</a> kspreason;
<a name="line1713">1713: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetKSP.html">SNESGetKSP</a>(ts-&gt;snes, &amp;ksp));
<a name="line1714">1714: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/KSP/KSPSetOperators.html">KSPSetOperators</a>(ksp, Jim, Jimpre));
<a name="line1715">1715: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecScale.html">VecScale</a>(VecsDeltaLam[nadj * s + i], 1. / At[i * s + i]));
<a name="line1716">1716: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/KSP/KSPSolveTranspose.html">KSPSolveTranspose</a>(ksp, VecsDeltaLam[nadj * s + i], VecsDeltaLam[nadj * s + i]));
<a name="line1717">1717: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/KSP/KSPGetConvergedReason.html">KSPGetConvergedReason</a>(ksp, &amp;kspreason));
<a name="line1718">1718: </a>        <font color="#4169E1">if</font> (kspreason &lt; 0) {
<a name="line1719">1719: </a>          ts-&gt;reason = <a href="../../../../manualpages/TS/TSConvergedReason.html">TSADJOINT_DIVERGED_LINEAR_SOLVE</a>;
<a name="line1720">1720: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Profiling/PetscInfo.html">PetscInfo</a>(ts, <font color="#666666">"Step=%"</font> PetscInt_FMT <font color="#666666">", %"</font> PetscInt_FMT <font color="#666666">"th cost function, transposed linear solve fails, stopping 1st-order adjoint solve\n"</font>, ts-&gt;steps, nadj));
<a name="line1721">1721: </a>        }
<a name="line1722">1722: </a>        <font color="#4169E1">if</font> (ts-&gt;vecs_sensip) {
<a name="line1723">1723: </a>          <font color="#B22222">/* -dHdP lambda_s[i] */</font>
<a name="line1724">1724: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatMultTranspose.html">MatMultTranspose</a>(ts-&gt;Jacp, VecsDeltaLam[nadj * s + i], VecsSensiPTemp[nadj]));
<a name="line1725">1725: </a>          <font color="#B22222">/* mu_n += h at[i][i] dHdP lambda_s[i] */</font>
<a name="line1726">1726: </a>          <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPY.html">VecAXPY</a>(ts-&gt;vecs_sensip[nadj], -At[i * s + i] * adjoint_time_step, VecsSensiPTemp[nadj]));
<a name="line1727">1727: </a>        }
<a name="line1728">1728: </a>      }
<a name="line1729">1729: </a>    }
<a name="line1730">1730: </a>  }
<a name="line1731">1731: </a>  <font color="#4169E1">for</font> (j = 0; j &lt; s; j++) w[j] = 1.0;
<a name="line1732">1732: </a>  <font color="#4169E1">for</font> (nadj = 0; nadj &lt; ts-&gt;numcost; nadj++) // no need to <font color="#4169E1">do</font> this <font color="#4169E1">for</font> mu's
<a name="line1733">1733: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(ts-&gt;vecs_sensi[nadj], s, w, &amp;VecsDeltaLam[nadj * s]));
<a name="line1734">1734: </a>  ark-&gt;status = TS_STEP_COMPLETE;
<a name="line1735">1735: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1736">1736: </a>}

<a name="line1738">1738: </a><strong><font color="#4169E1"><a name="TSInterpolate_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSInterpolate_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> itime, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> X)</font></strong>
<a name="line1739">1739: </a>{
<a name="line1740">1740: </a>  TS_ARKIMEX      *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1741">1741: </a>  ARKTableau       tab = ark-&gt;tableau;
<a name="line1742">1742: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         s = tab-&gt;s, pinterp = tab-&gt;pinterp, i, j;
<a name="line1743">1743: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        h;
<a name="line1744">1744: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        tt, t;
<a name="line1745">1745: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a>     *bt = ark-&gt;work, *b = ark-&gt;work + s;
<a name="line1746">1746: </a>  const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *Bt = tab-&gt;binterpt, *B = tab-&gt;binterp;

<a name="line1748">1748: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1749">1749: </a>  <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(Bt &amp;&amp; B, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"%s %s does not have an interpolation formula"</font>, ((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts)-&gt;type_name, ark-&gt;tableau-&gt;name);
<a name="line1750">1750: </a>  <font color="#4169E1">switch</font> (ark-&gt;status) {
<a name="line1751">1751: </a>  <font color="#4169E1">case</font> TS_STEP_INCOMPLETE:
<a name="line1752">1752: </a>  <font color="#4169E1">case</font> TS_STEP_PENDING:
<a name="line1753">1753: </a>    h = ts-&gt;time_step;
<a name="line1754">1754: </a>    t = (itime - ts-&gt;ptime) / h;
<a name="line1755">1755: </a>    <font color="#4169E1">break</font>;
<a name="line1756">1756: </a>  <font color="#4169E1">case</font> TS_STEP_COMPLETE:
<a name="line1757">1757: </a>    h = ts-&gt;ptime - ts-&gt;ptime_prev;
<a name="line1758">1758: </a>    t = (itime - ts-&gt;ptime) / h + 1; <font color="#B22222">/* In the interval [0,1] */</font>
<a name="line1759">1759: </a>    <font color="#4169E1">break</font>;
<a name="line1760">1760: </a><strong><font color="#FF0000">  default:</font></strong>
<a name="line1761">1761: </a>    <a href="../../../../manualpages/Sys/SETERRQ.html">SETERRQ</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_PLIB</a>, <font color="#666666">"Invalid TSStepStatus"</font>);
<a name="line1762">1762: </a>  }
<a name="line1763">1763: </a>  <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) bt[i] = b[i] = 0;
<a name="line1764">1764: </a>  <font color="#4169E1">for</font> (j = 0, tt = t; j &lt; pinterp; j++, tt *= t) {
<a name="line1765">1765: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) {
<a name="line1766">1766: </a>      bt[i] += h * Bt[i * pinterp + j] * tt;
<a name="line1767">1767: </a>      b[i] += h * B[i * pinterp + j] * tt;
<a name="line1768">1768: </a>    }
<a name="line1769">1769: </a>  }
<a name="line1770">1770: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ark-&gt;Y[0], X));
<a name="line1771">1771: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, bt, ark-&gt;YdotI));
<a name="line1772">1772: </a>  <font color="#4169E1">if</font> (tab-&gt;additive) {
<a name="line1773">1773: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> hasE;
<a name="line1774">1774: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1775">1775: </a>    <font color="#4169E1">if</font> (hasE) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, b, ark-&gt;YdotRHS));
<a name="line1776">1776: </a>  }
<a name="line1777">1777: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1778">1778: </a>}

<a name="line1780">1780: </a><strong><font color="#4169E1"><a name="TSExtrapolate_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSExtrapolate_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> c, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> X)</font></strong>
<a name="line1781">1781: </a>{
<a name="line1782">1782: </a>  TS_ARKIMEX      *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1783">1783: </a>  ARKTableau       tab = ark-&gt;tableau;
<a name="line1784">1784: </a>  <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>         s = tab-&gt;s, pinterp = tab-&gt;pinterp, i, j;
<a name="line1785">1785: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>        h, h_prev, t, tt;
<a name="line1786">1786: </a>  <a href="../../../../manualpages/Sys/PetscScalar.html">PetscScalar</a>     *bt = ark-&gt;work, *b = ark-&gt;work + s;
<a name="line1787">1787: </a>  const <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> *Bt = tab-&gt;binterpt, *B = tab-&gt;binterp;

<a name="line1789">1789: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1790">1790: </a>  <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(Bt &amp;&amp; B, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a> %s does not have an interpolation formula"</font>, ark-&gt;tableau-&gt;name);
<a name="line1791">1791: </a>  h      = ts-&gt;time_step;
<a name="line1792">1792: </a>  h_prev = ts-&gt;ptime - ts-&gt;ptime_prev;
<a name="line1793">1793: </a>  t      = 1 + h / h_prev * c;
<a name="line1794">1794: </a>  <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) bt[i] = b[i] = 0;
<a name="line1795">1795: </a>  <font color="#4169E1">for</font> (j = 0, tt = t; j &lt; pinterp; j++, tt *= t) {
<a name="line1796">1796: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; s; i++) {
<a name="line1797">1797: </a>      bt[i] += h * Bt[i * pinterp + j] * tt;
<a name="line1798">1798: </a>      b[i] += h * B[i * pinterp + j] * tt;
<a name="line1799">1799: </a>    }
<a name="line1800">1800: </a>  }
<a name="line1801">1801: </a>  <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(ark-&gt;Y_prev, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_SUP</a>, <font color="#666666">"Stages from previous step have not been stored"</font>);
<a name="line1802">1802: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecCopy.html">VecCopy</a>(ark-&gt;Y_prev[0], X));
<a name="line1803">1803: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, bt, ark-&gt;YdotI_prev));
<a name="line1804">1804: </a>  <font color="#4169E1">if</font> (tab-&gt;additive) {
<a name="line1805">1805: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> hasE;
<a name="line1806">1806: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSHasRHSFunction(ts, &amp;hasE));
<a name="line1807">1807: </a>    <font color="#4169E1">if</font> (hasE) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecMAXPY.html">VecMAXPY</a>(X, s, b, ark-&gt;YdotRHS_prev));
<a name="line1808">1808: </a>  }
<a name="line1809">1809: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1810">1810: </a>}

<a name="line1812">1812: </a><strong><font color="#4169E1"><a name="TSARKIMEXTableauReset"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXTableauReset(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1813">1813: </a>{
<a name="line1814">1814: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1815">1815: </a>  ARKTableau  tab = ark-&gt;tableau;

<a name="line1817">1817: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1818">1818: </a>  <font color="#4169E1">if</font> (!tab) <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1819">1819: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree.html">PetscFree</a>(ark-&gt;work));
<a name="line1820">1820: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;Y));
<a name="line1821">1821: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;YdotI));
<a name="line1822">1822: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;YdotRHS));
<a name="line1823">1823: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;Y_prev));
<a name="line1824">1824: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;YdotI_prev));
<a name="line1825">1825: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s, &amp;ark-&gt;YdotRHS_prev));
<a name="line1826">1826: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1827">1827: </a>}

<a name="line1829">1829: </a><strong><font color="#4169E1"><a name="TSReset_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSReset_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1830">1830: </a>{
<a name="line1831">1831: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line1833">1833: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1834">1834: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTableauReset(ts));
<a name="line1835">1835: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;ark-&gt;Ydot));
<a name="line1836">1836: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;ark-&gt;Ydot0));
<a name="line1837">1837: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroy.html">VecDestroy</a>(&amp;ark-&gt;Z));
<a name="line1838">1838: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1839">1839: </a>}

<a name="line1841">1841: </a><strong><font color="#4169E1"><a name="TSAdjointReset_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSAdjointReset_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1842">1842: </a>{
<a name="line1843">1843: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1844">1844: </a>  ARKTableau  tab = ark-&gt;tableau;

<a name="line1846">1846: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1847">1847: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(tab-&gt;s * ts-&gt;numcost, &amp;ark-&gt;VecsDeltaLam));
<a name="line1848">1848: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(ts-&gt;numcost, &amp;ark-&gt;VecsSensiTemp));
<a name="line1849">1849: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDestroyVecs.html">VecDestroyVecs</a>(ts-&gt;numcost, &amp;ark-&gt;VecsSensiPTemp));
<a name="line1850">1850: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1851">1851: </a>}

<a name="line1853">1853: </a><strong><font color="#4169E1"><a name="TSARKIMEXGetVecs"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXGetVecs(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/DM/DM.html">DM</a> dm, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *Z, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *Ydot)</font></strong>
<a name="line1854">1854: </a>{
<a name="line1855">1855: </a>  TS_ARKIMEX *ax = (TS_ARKIMEX *)ts-&gt;data;

<a name="line1857">1857: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1858">1858: </a>  <font color="#4169E1">if</font> (Z) {
<a name="line1859">1859: </a>    <font color="#4169E1">if</font> (dm &amp;&amp; dm != ts-&gt;dm) {
<a name="line1860">1860: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMGetNamedGlobalVector.html">DMGetNamedGlobalVector</a>(dm, <font color="#666666">"TSARKIMEX_Z"</font>, Z));
<a name="line1861">1861: </a>    } <font color="#4169E1">else</font> *Z = ax-&gt;Z;
<a name="line1862">1862: </a>  }
<a name="line1863">1863: </a>  <font color="#4169E1">if</font> (Ydot) {
<a name="line1864">1864: </a>    <font color="#4169E1">if</font> (dm &amp;&amp; dm != ts-&gt;dm) {
<a name="line1865">1865: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMGetNamedGlobalVector.html">DMGetNamedGlobalVector</a>(dm, <font color="#666666">"TSARKIMEX_Ydot"</font>, Ydot));
<a name="line1866">1866: </a>    } <font color="#4169E1">else</font> *Ydot = ax-&gt;Ydot;
<a name="line1867">1867: </a>  }
<a name="line1868">1868: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1869">1869: </a>}

<a name="line1871">1871: </a><strong><font color="#4169E1"><a name="TSARKIMEXRestoreVecs"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXRestoreVecs(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/DM/DM.html">DM</a> dm, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *Z, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *Ydot)</font></strong>
<a name="line1872">1872: </a>{
<a name="line1873">1873: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1874">1874: </a>  <font color="#4169E1">if</font> (Z) {
<a name="line1875">1875: </a>    <font color="#4169E1">if</font> (dm &amp;&amp; dm != ts-&gt;dm) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMRestoreNamedGlobalVector.html">DMRestoreNamedGlobalVector</a>(dm, <font color="#666666">"TSARKIMEX_Z"</font>, Z));
<a name="line1876">1876: </a>  }
<a name="line1877">1877: </a>  <font color="#4169E1">if</font> (Ydot) {
<a name="line1878">1878: </a>    <font color="#4169E1">if</font> (dm &amp;&amp; dm != ts-&gt;dm) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMRestoreNamedGlobalVector.html">DMRestoreNamedGlobalVector</a>(dm, <font color="#666666">"TSARKIMEX_Ydot"</font>, Ydot));
<a name="line1879">1879: </a>  }
<a name="line1880">1880: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1881">1881: </a>}

<a name="line1883">1883: </a><strong><font color="#4169E1">PETSC_SINGLE_LIBRARY_INTERN <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> MatFindNonzeroRowsOrCols_Basic(<a href="../../../../manualpages/Mat/Mat.html">Mat</a>, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>, <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>, <a href="../../../../manualpages/IS/IS.html">IS</a> *)</font></strong>;

<a name="line1885">1885: </a><font color="#B22222">/* This defines the nonlinear equation that is to be solved with <a href="../../../../manualpages/SNES/SNES.html">SNES</a> */</font>
<a name="line1886">1886: </a><strong><font color="#4169E1"><a name="SNESTSFormFunction_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> SNESTSFormFunction_ARKIMEX(<a href="../../../../manualpages/SNES/SNES.html">SNES</a> snes, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> X, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> F, <a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1887">1887: </a>{
<a name="line1888">1888: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1889">1889: </a>  <a href="../../../../manualpages/DM/DM.html">DM</a>          dm, dmsave;
<a name="line1890">1890: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         Z, Ydot;

<a name="line1892">1892: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1893">1893: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetDM.html">SNESGetDM</a>(snes, &amp;dm));
<a name="line1894">1894: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, dm, &amp;Z, &amp;Ydot));
<a name="line1895">1895: </a>  dmsave = ts-&gt;dm;
<a name="line1896">1896: </a>  ts-&gt;dm = dm;

<a name="line1898">1898: </a>  <font color="#4169E1">if</font> (ark-&gt;scoeff == PETSC_MAX_REAL) {
<a name="line1899">1899: </a>    <font color="#B22222">/* We are solving F(t_n,x_n,xdot) = 0 to start the method */</font>
<a name="line1900">1900: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIFunction.html">TSComputeIFunction</a>(ts, ark-&gt;stage_time, Z, X, F, ark-&gt;imex));
<a name="line1901">1901: </a>  } <font color="#4169E1">else</font> {
<a name="line1902">1902: </a>    <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a> shift = ark-&gt;scoeff / ts-&gt;time_step;
<a name="line1903">1903: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecAXPBYPCZ.html">VecAXPBYPCZ</a>(Ydot, -shift, shift, 0, Z, X)); <font color="#B22222">/* Ydot = shift*(X-Z) */</font>
<a name="line1904">1904: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIFunction.html">TSComputeIFunction</a>(ts, ark-&gt;stage_time, X, Ydot, F, ark-&gt;imex));
<a name="line1905">1905: </a>  }

<a name="line1907">1907: </a>  ts-&gt;dm = dmsave;
<a name="line1908">1908: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, dm, &amp;Z, &amp;Ydot));
<a name="line1909">1909: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1910">1910: </a>}

<a name="line1912">1912: </a><strong><font color="#4169E1"><a name="SNESTSFormJacobian_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> SNESTSFormJacobian_ARKIMEX(<a href="../../../../manualpages/SNES/SNES.html">SNES</a> snes, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> X, <a href="../../../../manualpages/Mat/Mat.html">Mat</a> A, <a href="../../../../manualpages/Mat/Mat.html">Mat</a> B, <a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line1913">1913: </a>{
<a name="line1914">1914: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line1915">1915: </a>  <a href="../../../../manualpages/DM/DM.html">DM</a>          dm, dmsave;
<a name="line1916">1916: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a>         Ydot, Z;
<a name="line1917">1917: </a>  <a href="../../../../manualpages/Sys/PetscReal.html">PetscReal</a>   shift;

<a name="line1919">1919: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1920">1920: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESGetDM.html">SNESGetDM</a>(snes, &amp;dm));
<a name="line1921">1921: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, dm, &amp;Z, &amp;Ydot));
<a name="line1922">1922: </a>  <font color="#B22222">/* ark-&gt;Ydot has already been computed in SNESTSFormFunction_ARKIMEX (<a href="../../../../manualpages/SNES/SNES.html">SNES</a> guarantees this) */</font>
<a name="line1923">1923: </a>  dmsave = ts-&gt;dm;
<a name="line1924">1924: </a>  ts-&gt;dm = dm;

<a name="line1926">1926: </a>  <font color="#4169E1">if</font> (ark-&gt;scoeff == PETSC_MAX_REAL) {
<a name="line1927">1927: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> hasZeroRows;
<a name="line1928">1928: </a>    <a href="../../../../manualpages/IS/IS.html">IS</a>        alg_is;

<a name="line1930">1930: </a>    <font color="#B22222">/* We are solving F(t_n,x_n,xdot) = 0 to start the method</font>
<a name="line1931">1931: </a><font color="#B22222">       Jed's proposal is to compute with a very large shift and then scale back the matrix */</font>
<a name="line1932">1932: </a>    shift = 1.0 / PETSC_MACHINE_EPSILON;
<a name="line1933">1933: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIJacobian.html">TSComputeIJacobian</a>(ts, ark-&gt;stage_time, Z, X, shift, A, B, ark-&gt;imex));
<a name="line1934">1934: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatScale.html">MatScale</a>(B, PETSC_MACHINE_EPSILON));
<a name="line1935">1935: </a>    <font color="#B22222">/* DAEs need special handling for preconditioning purposes only.</font>
<a name="line1936">1936: </a><font color="#B22222">       We need to locate the algebraic variables and modify the preconditioning matrix by</font>
<a name="line1937">1937: </a><font color="#B22222">       calling <a href="../../../../manualpages/Mat/MatZeroRows.html">MatZeroRows</a> with identity on these variables.</font>
<a name="line1938">1938: </a><font color="#B22222">       We must store the <a href="../../../../manualpages/IS/IS.html">IS</a> in the <a href="../../../../manualpages/DM/DM.html">DM</a> since this function can be called by multilevel solvers.</font>
<a name="line1939">1939: </a><font color="#B22222">    */</font>
<a name="line1940">1940: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectQuery.html">PetscObjectQuery</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)dm, <font color="#666666">"TSARKIMEX_ALG_IS"</font>, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a> *)&amp;alg_is));
<a name="line1941">1941: </a>    <font color="#4169E1">if</font> (!alg_is) {
<a name="line1942">1942: </a>      <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> m, n;
<a name="line1943">1943: </a>      <a href="../../../../manualpages/IS/IS.html">IS</a>       nonzeroRows;

<a name="line1945">1945: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatViewFromOptions.html">MatViewFromOptions</a>(B, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)snes, <font color="#666666">"-ts_arkimex_alg_mat_view_pre"</font>));
<a name="line1946">1946: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(MatFindNonzeroRowsOrCols_Basic(B, <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>, 100 * PETSC_MACHINE_EPSILON, &amp;nonzeroRows));
<a name="line1947">1947: </a>      <font color="#4169E1">if</font> (nonzeroRows) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISViewFromOptions.html">ISViewFromOptions</a>(nonzeroRows, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)snes, <font color="#666666">"-ts_arkimex_alg_is_view_pre"</font>));
<a name="line1948">1948: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatGetOwnershipRange.html">MatGetOwnershipRange</a>(B, &amp;m, &amp;n));
<a name="line1949">1949: </a>      <font color="#4169E1">if</font> (nonzeroRows) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISComplement.html">ISComplement</a>(nonzeroRows, m, n, &amp;alg_is));
<a name="line1950">1950: </a>      <font color="#4169E1">else</font> <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISCreateStride.html">ISCreateStride</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)snes), 0, m, 1, &amp;alg_is));
<a name="line1951">1951: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISDestroy.html">ISDestroy</a>(&amp;nonzeroRows));
<a name="line1952">1952: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectCompose.html">PetscObjectCompose</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)dm, <font color="#666666">"TSARKIMEX_ALG_IS"</font>, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)alg_is));
<a name="line1953">1953: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISDestroy.html">ISDestroy</a>(&amp;alg_is));
<a name="line1954">1954: </a>    }
<a name="line1955">1955: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectQuery.html">PetscObjectQuery</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)dm, <font color="#666666">"TSARKIMEX_ALG_IS"</font>, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a> *)&amp;alg_is));
<a name="line1956">1956: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/IS/ISViewFromOptions.html">ISViewFromOptions</a>(alg_is, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)snes, <font color="#666666">"-ts_arkimex_alg_is_view"</font>));
<a name="line1957">1957: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatHasOperation.html">MatHasOperation</a>(B, MATOP_ZERO_ROWS, &amp;hasZeroRows));
<a name="line1958">1958: </a>    <font color="#4169E1">if</font> (hasZeroRows) {
<a name="line1959">1959: </a>      <font color="#B22222">/* the default of AIJ is to not keep the pattern! We should probably change it someday */</font>
<a name="line1960">1960: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatSetOption.html">MatSetOption</a>(B, <a href="../../../../manualpages/Mat/MatOption.html">MAT_KEEP_NONZERO_PATTERN</a>, <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>));
<a name="line1961">1961: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatZeroRowsIS.html">MatZeroRowsIS</a>(B, alg_is, 1.0, NULL, NULL));
<a name="line1962">1962: </a>    }
<a name="line1963">1963: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatViewFromOptions.html">MatViewFromOptions</a>(B, (<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)snes, <font color="#666666">"-ts_arkimex_alg_mat_view"</font>));
<a name="line1964">1964: </a>    <font color="#4169E1">if</font> (A != B) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatScale.html">MatScale</a>(A, PETSC_MACHINE_EPSILON));
<a name="line1965">1965: </a>  } <font color="#4169E1">else</font> {
<a name="line1966">1966: </a>    shift = ark-&gt;scoeff / ts-&gt;time_step;
<a name="line1967">1967: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSComputeIJacobian.html">TSComputeIJacobian</a>(ts, ark-&gt;stage_time, X, Ydot, shift, A, B, ark-&gt;imex));
<a name="line1968">1968: </a>  }
<a name="line1969">1969: </a>  ts-&gt;dm = dmsave;
<a name="line1970">1970: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, dm, &amp;Z, &amp;Ydot));
<a name="line1971">1971: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1972">1972: </a>}

<a name="line1974">1974: </a><strong><font color="#4169E1"><a name="TSGetStages_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSGetStages_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> *ns, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> *Y[])</font></strong>
<a name="line1975">1975: </a>{
<a name="line1976">1976: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line1978">1978: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1979">1979: </a>  <font color="#4169E1">if</font> (ns) *ns = ark-&gt;tableau-&gt;s;
<a name="line1980">1980: </a>  <font color="#4169E1">if</font> (Y) *Y = ark-&gt;Y;
<a name="line1981">1981: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1982">1982: </a>}

<a name="line1984">1984: </a><strong><font color="#4169E1"><a name="DMCoarsenHook_TSARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> DMCoarsenHook_TSARKIMEX(<a href="../../../../manualpages/DM/DM.html">DM</a> fine, <a href="../../../../manualpages/DM/DM.html">DM</a> coarse, void *ctx)</font></strong>
<a name="line1985">1985: </a>{
<a name="line1986">1986: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1987">1987: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line1988">1988: </a>}

<a name="line1990">1990: </a><strong><font color="#4169E1"><a name="DMRestrictHook_TSARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> DMRestrictHook_TSARKIMEX(<a href="../../../../manualpages/DM/DM.html">DM</a> fine, <a href="../../../../manualpages/Mat/Mat.html">Mat</a> restrct, <a href="../../../../manualpages/Vec/Vec.html">Vec</a> rscale, <a href="../../../../manualpages/Mat/Mat.html">Mat</a> inject, <a href="../../../../manualpages/DM/DM.html">DM</a> coarse, void *ctx)</font></strong>
<a name="line1991">1991: </a>{
<a name="line1992">1992: </a>  <a href="../../../../manualpages/TS/TS.html">TS</a>  ts = (<a href="../../../../manualpages/TS/TS.html">TS</a>)ctx;
<a name="line1993">1993: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a> Z, Z_c;

<a name="line1995">1995: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line1996">1996: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, fine, &amp;Z, NULL));
<a name="line1997">1997: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, coarse, &amp;Z_c, NULL));
<a name="line1998">1998: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Mat/MatRestrict.html">MatRestrict</a>(restrct, Z, Z_c));
<a name="line1999">1999: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecPointwiseMult.html">VecPointwiseMult</a>(Z_c, rscale, Z_c));
<a name="line2000">2000: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, fine, &amp;Z, NULL));
<a name="line2001">2001: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, coarse, &amp;Z_c, NULL));
<a name="line2002">2002: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2003">2003: </a>}

<a name="line2005">2005: </a><strong><font color="#4169E1"><a name="DMSubDomainHook_TSARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> DMSubDomainHook_TSARKIMEX(<a href="../../../../manualpages/DM/DM.html">DM</a> dm, <a href="../../../../manualpages/DM/DM.html">DM</a> subdm, void *ctx)</font></strong>
<a name="line2006">2006: </a>{
<a name="line2007">2007: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2008">2008: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2009">2009: </a>}

<a name="line2011">2011: </a><strong><font color="#4169E1"><a name="DMSubDomainRestrictHook_TSARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> DMSubDomainRestrictHook_TSARKIMEX(<a href="../../../../manualpages/DM/DM.html">DM</a> dm, <a href="../../../../manualpages/PetscSF/VecScatter.html">VecScatter</a> gscat, <a href="../../../../manualpages/PetscSF/VecScatter.html">VecScatter</a> lscat, <a href="../../../../manualpages/DM/DM.html">DM</a> subdm, void *ctx)</font></strong>
<a name="line2012">2012: </a>{
<a name="line2013">2013: </a>  <a href="../../../../manualpages/TS/TS.html">TS</a>  ts = (<a href="../../../../manualpages/TS/TS.html">TS</a>)ctx;
<a name="line2014">2014: </a>  <a href="../../../../manualpages/Vec/Vec.html">Vec</a> Z, Z_c;

<a name="line2016">2016: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2017">2017: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, dm, &amp;Z, NULL));
<a name="line2018">2018: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXGetVecs(ts, subdm, &amp;Z_c, NULL));

<a name="line2020">2020: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/PetscSF/VecScatterBegin.html">VecScatterBegin</a>(gscat, Z, Z_c, <a href="../../../../manualpages/Sys/INSERT_VALUES.html">INSERT_VALUES</a>, <a href="../../../../manualpages/Vec/SCATTER_FORWARD.html">SCATTER_FORWARD</a>));
<a name="line2021">2021: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/PetscSF/VecScatterEnd.html">VecScatterEnd</a>(gscat, Z, Z_c, <a href="../../../../manualpages/Sys/INSERT_VALUES.html">INSERT_VALUES</a>, <a href="../../../../manualpages/Vec/SCATTER_FORWARD.html">SCATTER_FORWARD</a>));

<a name="line2023">2023: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, dm, &amp;Z, NULL));
<a name="line2024">2024: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXRestoreVecs(ts, subdm, &amp;Z_c, NULL));
<a name="line2025">2025: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2026">2026: </a>}

<a name="line2028">2028: </a><strong><font color="#4169E1"><a name="TSARKIMEXTableauSetUp"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXTableauSetUp(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2029">2029: </a>{
<a name="line2030">2030: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2031">2031: </a>  ARKTableau  tab = ark-&gt;tableau;

<a name="line2033">2033: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2034">2034: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscMalloc1.html">PetscMalloc1</a>(2 * tab-&gt;s, &amp;ark-&gt;work));
<a name="line2035">2035: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;Y));
<a name="line2036">2036: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotI));
<a name="line2037">2037: </a>  <font color="#4169E1">if</font> (tab-&gt;additive) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotRHS));
<a name="line2038">2038: </a>  <font color="#4169E1">if</font> (ark-&gt;extrapolate) {
<a name="line2039">2039: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;Y_prev));
<a name="line2040">2040: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotI_prev));
<a name="line2041">2041: </a>    <font color="#4169E1">if</font> (tab-&gt;additive) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vec_sol, tab-&gt;s, &amp;ark-&gt;YdotRHS_prev));
<a name="line2042">2042: </a>  }
<a name="line2043">2043: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2044">2044: </a>}

<a name="line2046">2046: </a><strong><font color="#4169E1"><a name="TSSetUp_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSSetUp_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2047">2047: </a>{
<a name="line2048">2048: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2049">2049: </a>  <a href="../../../../manualpages/DM/DM.html">DM</a>          dm;
<a name="line2050">2050: </a>  <a href="../../../../manualpages/SNES/SNES.html">SNES</a>        snes;

<a name="line2052">2052: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2053">2053: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTableauSetUp(ts));
<a name="line2054">2054: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;ark-&gt;Ydot));
<a name="line2055">2055: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;ark-&gt;Ydot0));
<a name="line2056">2056: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicate.html">VecDuplicate</a>(ts-&gt;vec_sol, &amp;ark-&gt;Z));
<a name="line2057">2057: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetDM.html">TSGetDM</a>(ts, &amp;dm));
<a name="line2058">2058: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMCoarsenHookAdd.html">DMCoarsenHookAdd</a>(dm, DMCoarsenHook_TSARKIMEX, DMRestrictHook_TSARKIMEX, ts));
<a name="line2059">2059: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMSubDomainHookAdd.html">DMSubDomainHookAdd</a>(dm, DMSubDomainHook_TSARKIMEX, DMSubDomainRestrictHook_TSARKIMEX, ts));
<a name="line2060">2060: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetSNES.html">TSGetSNES</a>(ts, &amp;snes));
<a name="line2061">2061: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2062">2062: </a>}

<a name="line2064">2064: </a><strong><font color="#4169E1"><a name="TSAdjointSetUp_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSAdjointSetUp_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2065">2065: </a>{
<a name="line2066">2066: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2067">2067: </a>  ARKTableau  tab = ark-&gt;tableau;

<a name="line2069">2069: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2070">2070: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vecs_sensi[0], tab-&gt;s * ts-&gt;numcost, &amp;ark-&gt;VecsDeltaLam));
<a name="line2071">2071: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vecs_sensi[0], ts-&gt;numcost, &amp;ark-&gt;VecsSensiTemp));
<a name="line2072">2072: </a>  <font color="#4169E1">if</font> (ts-&gt;vecs_sensip) { <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Vec/VecDuplicateVecs.html">VecDuplicateVecs</a>(ts-&gt;vecs_sensip[0], ts-&gt;numcost, &amp;ark-&gt;VecsSensiPTemp)); }
<a name="line2073">2073: </a>  <font color="#4169E1">if</font> (<a href="../../../../manualpages/Sys/PetscDefined.html">PetscDefined</a>(USE_DEBUG)) {
<a name="line2074">2074: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> id = <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a>;
<a name="line2075">2075: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTestMassIdentity(ts, &amp;id));
<a name="line2076">2076: </a>    <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(id, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_ARG_INCOMP</a>, <font color="#666666">"Adjoint ARKIMEX requires an identity mass matrix, however the <a href="../../../../manualpages/TS/TSIFunction.html">TSIFunction</a> you provided does not utilize an identity mass matrix"</font>);
<a name="line2077">2077: </a>  }
<a name="line2078">2078: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2079">2079: </a>}

<a name="line2081">2081: </a><strong><font color="#4169E1"><a name="TSSetFromOptions_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSSetFromOptions_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, PetscOptionItems *PetscOptionsObject)</font></strong>
<a name="line2082">2082: </a>{
<a name="line2083">2083: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2084">2084: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>   dirk;

<a name="line2086">2086: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2087">2087: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectTypeCompare.html">PetscObjectTypeCompare</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>, &amp;dirk));
<a name="line2088">2088: </a>  <a href="../../../../manualpages/Sys/PetscOptionsHeadBegin.html">PetscOptionsHeadBegin</a>(PetscOptionsObject, dirk ? <font color="#666666">"DIRK ODE solver options"</font> : <font color="#666666">"ARKIMEX ODE solver options"</font>);
<a name="line2089">2089: </a>  {
<a name="line2090">2090: </a>    ARKTableauLink link;
<a name="line2091">2091: </a>    <a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a>       count, choice;
<a name="line2092">2092: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>      flg;
<a name="line2093">2093: </a>    const char   **namelist;
<a name="line2094">2094: </a>    <font color="#4169E1">for</font> (link = ARKTableauList, count = 0; link; link = link-&gt;next) {
<a name="line2095">2095: </a>      <font color="#4169E1">if</font> (!dirk &amp;&amp; link-&gt;tab.additive) count++;
<a name="line2096">2096: </a>      <font color="#4169E1">if</font> (dirk &amp;&amp; !link-&gt;tab.additive) count++;
<a name="line2097">2097: </a>    }
<a name="line2098">2098: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscMalloc1.html">PetscMalloc1</a>(count, (char ***)&amp;namelist));
<a name="line2099">2099: </a>    <font color="#4169E1">for</font> (link = ARKTableauList, count = 0; link; link = link-&gt;next) {
<a name="line2100">2100: </a>      <font color="#4169E1">if</font> (!dirk &amp;&amp; link-&gt;tab.additive) namelist[count++] = link-&gt;tab.name;
<a name="line2101">2101: </a>      <font color="#4169E1">if</font> (dirk &amp;&amp; !link-&gt;tab.additive) namelist[count++] = link-&gt;tab.name;
<a name="line2102">2102: </a>    }
<a name="line2103">2103: </a>    <font color="#4169E1">if</font> (dirk) {
<a name="line2104">2104: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscOptionsEList.html">PetscOptionsEList</a>(<font color="#666666">"-ts_dirk_type"</font>, <font color="#666666">"Family of DIRK method"</font>, <font color="#666666">"<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>"</font>, (const char *const *)namelist, count, ark-&gt;tableau-&gt;name, &amp;choice, &amp;flg));
<a name="line2105">2105: </a>      <font color="#4169E1">if</font> (flg) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>(ts, namelist[choice]));
<a name="line2106">2106: </a>    } <font color="#4169E1">else</font> {
<a name="line2107">2107: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscOptionsEList.html">PetscOptionsEList</a>(<font color="#666666">"-ts_arkimex_type"</font>, <font color="#666666">"Family of ARK IMEX method"</font>, <font color="#666666">"<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>"</font>, (const char *const *)namelist, count, ark-&gt;tableau-&gt;name, &amp;choice, &amp;flg));
<a name="line2108">2108: </a>      <font color="#4169E1">if</font> (flg) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>(ts, namelist[choice]));
<a name="line2109">2109: </a>      flg = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)!ark-&gt;imex;
<a name="line2110">2110: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscOptionsBool.html">PetscOptionsBool</a>(<font color="#666666">"-ts_arkimex_fully_implicit"</font>, <font color="#666666">"Solve the problem fully implicitly"</font>, <font color="#666666">"<a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a>"</font>, flg, &amp;flg, NULL));
<a name="line2111">2111: </a>      ark-&gt;imex = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)!flg;
<a name="line2112">2112: </a>    }
<a name="line2113">2113: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree.html">PetscFree</a>(namelist));
<a name="line2114">2114: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscOptionsBool.html">PetscOptionsBool</a>(<font color="#666666">"-ts_arkimex_initial_guess_extrapolate"</font>, <font color="#666666">"Extrapolate the initial guess for the stage solution from stage values of the previous time step"</font>, <font color="#666666">""</font>, ark-&gt;extrapolate, &amp;ark-&gt;extrapolate, NULL));
<a name="line2115">2115: </a>  }
<a name="line2116">2116: </a>  <a href="../../../../manualpages/Sys/PetscOptionsHeadEnd.html">PetscOptionsHeadEnd</a>();
<a name="line2117">2117: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2118">2118: </a>}

<a name="line2120">2120: </a><strong><font color="#4169E1"><a name="TSView_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSView_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Viewer/PetscViewer.html">PetscViewer</a> viewer)</font></strong>
<a name="line2121">2121: </a>{
<a name="line2122">2122: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2123">2123: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>   iascii, dirk;

<a name="line2125">2125: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2126">2126: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectTypeCompare.html">PetscObjectTypeCompare</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>, &amp;dirk));
<a name="line2127">2127: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectTypeCompare.html">PetscObjectTypeCompare</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)viewer, <a href="../../../../manualpages/Viewer/PETSCVIEWERASCII.html">PETSCVIEWERASCII</a>, &amp;iascii));
<a name="line2128">2128: </a>  <font color="#4169E1">if</font> (iascii) {
<a name="line2129">2129: </a>    <a href="../../../../manualpages/Viewer/PetscViewerFormat.html">PetscViewerFormat</a> format;
<a name="line2130">2130: </a>    ARKTableau        tab = ark-&gt;tableau;
<a name="line2131">2131: </a>    <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>     arktype;
<a name="line2132">2132: </a>    char              buf[2048];
<a name="line2133">2133: </a>    <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>         flg;

<a name="line2135">2135: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>(ts, &amp;arktype));
<a name="line2136">2136: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXGetFullyImplicit.html">TSARKIMEXGetFullyImplicit</a>(ts, &amp;flg));
<a name="line2137">2137: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  %s %s\n"</font>, dirk ? <font color="#666666">"DIRK"</font> : <font color="#666666">"ARK IMEX"</font>, arktype));
<a name="line2138">2138: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(PetscFormatRealArray(buf, <font color="#4169E1">sizeof</font>(buf), <font color="#666666">"% 8.6f"</font>, tab-&gt;s, tab-&gt;ct));
<a name="line2139">2139: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  %sabscissa       ct = %s\n"</font>, dirk ? <font color="#666666">""</font> : <font color="#666666">"Stiff "</font>, buf));
<a name="line2140">2140: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerGetFormat.html">PetscViewerGetFormat</a>(viewer, &amp;format));
<a name="line2141">2141: </a>    <font color="#4169E1">if</font> (format == <a href="../../../../manualpages/Viewer/PetscViewerFormat.html">PETSC_VIEWER_ASCII_INFO_DETAIL</a>) {
<a name="line2142">2142: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  %sAt =\n"</font>, dirk ? <font color="#666666">""</font> : <font color="#666666">"Stiff "</font>));
<a name="line2143">2143: </a>      <font color="#4169E1">for</font> (<a href="../../../../manualpages/Sys/PetscInt.html">PetscInt</a> i = 0; i &lt; tab-&gt;s; i++) {
<a name="line2144">2144: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(PetscFormatRealArray(buf, <font color="#4169E1">sizeof</font>(buf), <font color="#666666">"% 8.6f"</font>, tab-&gt;s, tab-&gt;At + i * tab-&gt;s));
<a name="line2145">2145: </a>        <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"    %s\n"</font>, buf));
<a name="line2146">2146: </a>      }
<a name="line2147">2147: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(PetscFormatRealArray(buf, <font color="#4169E1">sizeof</font>(buf), <font color="#666666">"% 8.6f"</font>, tab-&gt;s, tab-&gt;bt));
<a name="line2148">2148: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  %sbt = %s\n"</font>, dirk ? <font color="#666666">""</font> : <font color="#666666">"Stiff "</font>, buf));
<a name="line2149">2149: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(PetscFormatRealArray(buf, <font color="#4169E1">sizeof</font>(buf), <font color="#666666">"% 8.6f"</font>, tab-&gt;s, tab-&gt;bembedt));
<a name="line2150">2150: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  %sbet = %s\n"</font>, dirk ? <font color="#666666">""</font> : <font color="#666666">"Stiff "</font>, buf));
<a name="line2151">2151: </a>    }
<a name="line2152">2152: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Fully implicit: %s\n"</font>, flg ? <font color="#666666">"yes"</font> : <font color="#666666">"no"</font>));
<a name="line2153">2153: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Stiffly accurate: %s\n"</font>, tab-&gt;stiffly_accurate ? <font color="#666666">"yes"</font> : <font color="#666666">"no"</font>));
<a name="line2154">2154: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Explicit first stage: %s\n"</font>, tab-&gt;explicit_first_stage ? <font color="#666666">"yes"</font> : <font color="#666666">"no"</font>));
<a name="line2155">2155: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"FSAL property: %s\n"</font>, tab-&gt;FSAL_implicit ? <font color="#666666">"yes"</font> : <font color="#666666">"no"</font>));
<a name="line2156">2156: </a>    <font color="#4169E1">if</font> (!dirk) {
<a name="line2157">2157: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(PetscFormatRealArray(buf, <font color="#4169E1">sizeof</font>(buf), <font color="#666666">"% 8.6f"</font>, tab-&gt;s, tab-&gt;c));
<a name="line2158">2158: </a>      <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Viewer/PetscViewerASCIIPrintf.html">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  Nonstiff abscissa     c = %s\n"</font>, buf));
<a name="line2159">2159: </a>    }
<a name="line2160">2160: </a>  }
<a name="line2161">2161: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2162">2162: </a>}

<a name="line2164">2164: </a><strong><font color="#4169E1"><a name="TSLoad_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSLoad_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Viewer/PetscViewer.html">PetscViewer</a> viewer)</font></strong>
<a name="line2165">2165: </a>{
<a name="line2166">2166: </a>  <a href="../../../../manualpages/SNES/SNES.html">SNES</a>    snes;
<a name="line2167">2167: </a>  <a href="../../../../manualpages/TS/TSAdapt.html">TSAdapt</a> adapt;

<a name="line2169">2169: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2170">2170: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetAdapt.html">TSGetAdapt</a>(ts, &amp;adapt));
<a name="line2171">2171: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSAdaptLoad.html">TSAdaptLoad</a>(adapt, viewer));
<a name="line2172">2172: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSGetSNES.html">TSGetSNES</a>(ts, &amp;snes));
<a name="line2173">2173: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESLoad.html">SNESLoad</a>(snes, viewer));
<a name="line2174">2174: </a>  <font color="#B22222">/* function and Jacobian context for <a href="../../../../manualpages/SNES/SNES.html">SNES</a> when used with <a href="../../../../manualpages/TS/TS.html">TS</a> is always ts object */</font>
<a name="line2175">2175: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESSetFunction.html">SNESSetFunction</a>(snes, NULL, NULL, ts));
<a name="line2176">2176: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/SNES/SNESSetJacobian.html">SNESSetJacobian</a>(snes, NULL, NULL, NULL, ts));
<a name="line2177">2177: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2178">2178: </a>}

<a name="line2180">2180: </a><font color="#B22222">/*@C</font>
<a name="line2181">2181: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a> - Set the type of `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme</font>

<a name="line2183">2183: </a><font color="#B22222">  Logically Collective</font>

<a name="line2185">2185: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2186">2186: </a><font color="#B22222">+ ts      - timestepping context</font>
<a name="line2187">2187: </a><font color="#B22222">- arktype - type of `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme</font>

<a name="line2189">2189: </a><font color="#B22222">  Options Database Key:</font>
<a name="line2190">2190: </a><font color="#B22222">. -ts_arkimex_type &lt;1bee,a2,l2,ars122,2c,2d,2e,prssp2,3,bpr3,ars443,4,5&gt; - set `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme type</font>

<a name="line2192">2192: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2194">2194: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX1BEE.html">TSARKIMEX1BEE</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXA2.html">TSARKIMEXA2</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXL2.html">TSARKIMEXL2</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXARS122.html">TSARKIMEXARS122</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2C.html">TSARKIMEX2C</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2D.html">TSARKIMEX2D</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2E.html">TSARKIMEX2E</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXPRSSP2.html">TSARKIMEXPRSSP2</a>`,</font>
<a name="line2195">2195: </a><font color="#B22222">          `<a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXBPR3.html">TSARKIMEXBPR3</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXARS443.html">TSARKIMEXARS443</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX4.html">TSARKIMEX4</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX5.html">TSARKIMEX5</a>`</font>
<a name="line2196">2196: </a><font color="#B22222">@*/</font>
<a name="line2197">2197: </a><strong><font color="#4169E1"><a name="TSARKIMEXSetType"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> arktype)</font></strong>
<a name="line2198">2198: </a>{
<a name="line2199">2199: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2201">2201: </a>  PetscAssertPointer(arktype, 2);
<a name="line2202">2202: </a>  <a href="../../../../manualpages/Sys/PetscTryMethod.html">PetscTryMethod</a>(ts, <font color="#666666">"TSARKIMEXSetType_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>), (ts, arktype));
<a name="line2203">2203: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2204">2204: </a>}

<a name="line2206">2206: </a><font color="#B22222">/*@C</font>
<a name="line2207">2207: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a> - Get the type of `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme</font>

<a name="line2209">2209: </a><font color="#B22222">  Logically Collective</font>

<a name="line2211">2211: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2212">2212: </a><font color="#B22222">. ts - timestepping context</font>

<a name="line2214">2214: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2215">2215: </a><font color="#B22222">. arktype - type of `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>` scheme</font>

<a name="line2217">2217: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2219">2219: </a><font color="#B22222">.seealso: [](ch_ts), `TSARKIMEXc`</font>
<a name="line2220">2220: </a><font color="#B22222">@*/</font>
<a name="line2221">2221: </a><strong><font color="#4169E1"><a name="TSARKIMEXGetType"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> *arktype)</font></strong>
<a name="line2222">2222: </a>{
<a name="line2223">2223: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2225">2225: </a>  <a href="../../../../manualpages/Sys/PetscUseMethod.html">PetscUseMethod</a>(ts, <font color="#666666">"TSARKIMEXGetType_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> *), (ts, arktype));
<a name="line2226">2226: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2227">2227: </a>}

<a name="line2229">2229: </a><font color="#B22222">/*@</font>
<a name="line2230">2230: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a> - Solve both parts of the equation implicitly, including the part that is normally solved explicitly</font>

<a name="line2232">2232: </a><font color="#B22222">  Logically Collective</font>

<a name="line2234">2234: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2235">2235: </a><font color="#B22222">+ ts  - timestepping context</font>
<a name="line2236">2236: </a><font color="#B22222">- flg - `<a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>` for fully implicit</font>

<a name="line2238">2238: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2240">2240: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXGetFullyImplicit.html">TSARKIMEXGetFullyImplicit</a>()`</font>
<a name="line2241">2241: </a><font color="#B22222">@*/</font>
<a name="line2242">2242: </a><strong><font color="#4169E1"><a name="TSARKIMEXSetFullyImplicit"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> flg)</font></strong>
<a name="line2243">2243: </a>{
<a name="line2244">2244: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2247">2247: </a>  <a href="../../../../manualpages/Sys/PetscTryMethod.html">PetscTryMethod</a>(ts, <font color="#666666">"TSARKIMEXSetFullyImplicit_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>), (ts, flg));
<a name="line2248">2248: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2249">2249: </a>}

<a name="line2251">2251: </a><font color="#B22222">/*@</font>
<a name="line2252">2252: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSARKIMEXGetFullyImplicit.html">TSARKIMEXGetFullyImplicit</a> - Inquires if both parts of the equation are solved implicitly</font>

<a name="line2254">2254: </a><font color="#B22222">  Logically Collective</font>

<a name="line2256">2256: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2257">2257: </a><font color="#B22222">. ts - timestepping context</font>

<a name="line2259">2259: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2260">2260: </a><font color="#B22222">. flg - `<a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>` for fully implicit</font>

<a name="line2262">2262: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2264">2264: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a>()`</font>
<a name="line2265">2265: </a><font color="#B22222">@*/</font>
<a name="line2266">2266: </a><strong><font color="#4169E1"><a name="TSARKIMEXGetFullyImplicit"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSARKIMEXGetFullyImplicit.html">TSARKIMEXGetFullyImplicit</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *flg)</font></strong>
<a name="line2267">2267: </a>{
<a name="line2268">2268: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2270">2270: </a>  PetscAssertPointer(flg, 2);
<a name="line2271">2271: </a>  <a href="../../../../manualpages/Sys/PetscUseMethod.html">PetscUseMethod</a>(ts, <font color="#666666">"TSARKIMEXGetFullyImplicit_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *), (ts, flg));
<a name="line2272">2272: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2273">2273: </a>}

<a name="line2275">2275: </a><strong><font color="#4169E1"><a name="TSARKIMEXGetType_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXGetType_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> *arktype)</font></strong>
<a name="line2276">2276: </a>{
<a name="line2277">2277: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line2279">2279: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2280">2280: </a>  *arktype = ark-&gt;tableau-&gt;name;
<a name="line2281">2281: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2282">2282: </a>}

<a name="line2284">2284: </a><strong><font color="#4169E1"><a name="TSARKIMEXSetType_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXSetType_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a> arktype)</font></strong>
<a name="line2285">2285: </a>{
<a name="line2286">2286: </a>  TS_ARKIMEX    *ark = (TS_ARKIMEX *)ts-&gt;data;
<a name="line2287">2287: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>      match;
<a name="line2288">2288: </a>  ARKTableauLink link;

<a name="line2290">2290: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2291">2291: </a>  <font color="#4169E1">if</font> (ark-&gt;tableau) {
<a name="line2292">2292: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscStrcmp.html">PetscStrcmp</a>(ark-&gt;tableau-&gt;name, arktype, &amp;match));
<a name="line2293">2293: </a>    <font color="#4169E1">if</font> (match) <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2294">2294: </a>  }
<a name="line2295">2295: </a>  <font color="#4169E1">for</font> (link = ARKTableauList; link; link = link-&gt;next) {
<a name="line2296">2296: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscStrcmp.html">PetscStrcmp</a>(link-&gt;tab.name, arktype, &amp;match));
<a name="line2297">2297: </a>    <font color="#4169E1">if</font> (match) {
<a name="line2298">2298: </a>      <font color="#4169E1">if</font> (ts-&gt;setupcalled) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTableauReset(ts));
<a name="line2299">2299: </a>      ark-&gt;tableau = &amp;link-&gt;tab;
<a name="line2300">2300: </a>      <font color="#4169E1">if</font> (ts-&gt;setupcalled) <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXTableauSetUp(ts));
<a name="line2301">2301: </a>      ts-&gt;default_adapt_type = ark-&gt;tableau-&gt;bembed ? <a href="../../../../manualpages/TS/TSADAPTBASIC.html">TSADAPTBASIC</a> : <a href="../../../../manualpages/TS/TSADAPTNONE.html">TSADAPTNONE</a>;
<a name="line2302">2302: </a>      <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2303">2303: </a>    }
<a name="line2304">2304: </a>  }
<a name="line2305">2305: </a>  <a href="../../../../manualpages/Sys/SETERRQ.html">SETERRQ</a>(<a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_ARG_UNKNOWN_TYPE</a>, <font color="#666666">"Could not find '%s'"</font>, arktype);
<a name="line2306">2306: </a>}

<a name="line2308">2308: </a><strong><font color="#4169E1"><a name="TSARKIMEXSetFullyImplicit_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXSetFullyImplicit_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> flg)</font></strong>
<a name="line2309">2309: </a>{
<a name="line2310">2310: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line2312">2312: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2313">2313: </a>  ark-&gt;imex = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)!flg;
<a name="line2314">2314: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2315">2315: </a>}

<a name="line2317">2317: </a><strong><font color="#4169E1"><a name="TSARKIMEXGetFullyImplicit_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSARKIMEXGetFullyImplicit_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a> *flg)</font></strong>
<a name="line2318">2318: </a>{
<a name="line2319">2319: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line2321">2321: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2322">2322: </a>  *flg = (<a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>)!ark-&gt;imex;
<a name="line2323">2323: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2324">2324: </a>}

<a name="line2326">2326: </a><strong><font color="#4169E1"><a name="TSDestroy_ARKIMEX"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSDestroy_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2327">2327: </a>{
<a name="line2328">2328: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2329">2329: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSReset_ARKIMEX(ts));
<a name="line2330">2330: </a>  <font color="#4169E1">if</font> (ts-&gt;dm) {
<a name="line2331">2331: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMCoarsenHookRemove.html">DMCoarsenHookRemove</a>(ts-&gt;dm, DMCoarsenHook_TSARKIMEX, DMRestrictHook_TSARKIMEX, ts));
<a name="line2332">2332: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/DM/DMSubDomainHookRemove.html">DMSubDomainHookRemove</a>(ts-&gt;dm, DMSubDomainHook_TSARKIMEX, DMSubDomainRestrictHook_TSARKIMEX, ts));
<a name="line2333">2333: </a>  }
<a name="line2334">2334: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscFree.html">PetscFree</a>(ts-&gt;data));
<a name="line2335">2335: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSDIRKGetType_C"</font>, NULL));
<a name="line2336">2336: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSDIRKSetType_C"</font>, NULL));
<a name="line2337">2337: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXGetType_C"</font>, NULL));
<a name="line2338">2338: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXSetType_C"</font>, NULL));
<a name="line2339">2339: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXSetFullyImplicit_C"</font>, NULL));
<a name="line2340">2340: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXGetFullyImplicit_C"</font>, NULL));
<a name="line2341">2341: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2342">2342: </a>}

<a name="line2344">2344: </a><font color="#B22222">/* ------------------------------------------------------------ */</font>
<a name="line2345">2345: </a><font color="#B22222">/*MC</font>
<a name="line2346">2346: </a><font color="#B22222">      <a href="../../../../manualpages/TS/TSARKIMEX.html">TSARKIMEX</a> - ODE and DAE solver using additive Runge-Kutta IMEX schemes</font>

<a name="line2348">2348: </a><font color="#B22222">  These methods are intended for problems with well-separated time scales, especially when a slow scale is strongly</font>
<a name="line2349">2349: </a><font color="#B22222">  nonlinear such that it is expensive to solve with a fully implicit method. The user should provide the stiff part</font>
<a name="line2350">2350: </a><font color="#B22222">  of the equation using `<a href="../../../../manualpages/TS/TSSetIFunction.html">TSSetIFunction</a>()` and the non-stiff part with `<a href="../../../../manualpages/TS/TSSetRHSFunction.html">TSSetRHSFunction</a>()`.</font>

<a name="line2352">2352: </a><font color="#B22222">  Level: beginner</font>

<a name="line2354">2354: </a><font color="#B22222">  Notes:</font>
<a name="line2355">2355: </a><font color="#B22222">  The default is `<a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a>`, it can be changed with `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()` or -ts_arkimex_type</font>

<a name="line2357">2357: </a><font color="#B22222">  If the equation is implicit or a DAE, then `<a href="../../../../manualpages/TS/TSSetEquationType.html">TSSetEquationType</a>()` needs to be set accordingly. Refer to the manual for further information.</font>

<a name="line2359">2359: </a><font color="#B22222">  Methods with an explicit stage can only be used with ODE in which the stiff part G(t,X,Xdot) has the form Xdot + Ghat(t,X).</font>

<a name="line2361">2361: </a><font color="#B22222">  Consider trying `<a href="../../../../manualpages/TS/TSROSW.html">TSROSW</a>` if the stiff part is linear or weakly nonlinear.</font>

<a name="line2363">2363: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSCreate.html">TSCreate</a>()`, `<a href="../../../../manualpages/TS/TS.html">TS</a>`, `<a href="../../../../manualpages/TS/TSSetType.html">TSSetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXGetType.html">TSARKIMEXGetType</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXSetFullyImplicit.html">TSARKIMEXSetFullyImplicit</a>()`, `<a href="../../../../manualpages/TS/TSARKIMEXGetFullyImplicit.html">TSARKIMEXGetFullyImplicit</a>()`,</font>
<a name="line2364">2364: </a><font color="#B22222">          `<a href="../../../../manualpages/TS/TSARKIMEX1BEE.html">TSARKIMEX1BEE</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2C.html">TSARKIMEX2C</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2D.html">TSARKIMEX2D</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX2E.html">TSARKIMEX2E</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX3.html">TSARKIMEX3</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXL2.html">TSARKIMEXL2</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXA2.html">TSARKIMEXA2</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXARS122.html">TSARKIMEXARS122</a>`,</font>
<a name="line2365">2365: </a><font color="#B22222">          `<a href="../../../../manualpages/TS/TSARKIMEX4.html">TSARKIMEX4</a>`, `<a href="../../../../manualpages/TS/TSARKIMEX5.html">TSARKIMEX5</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXPRSSP2.html">TSARKIMEXPRSSP2</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXARS443.html">TSARKIMEXARS443</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXBPR3.html">TSARKIMEXBPR3</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXType.html">TSARKIMEXType</a>`, `<a href="../../../../manualpages/TS/TSARKIMEXRegister.html">TSARKIMEXRegister</a>()`, `<a href="../../../../manualpages/TS/TSType.html">TSType</a>`</font>
<a name="line2366">2366: </a><font color="#B22222">M*/</font>
<a name="line2367">2367: </a><strong><font color="#4169E1"><a name="TSCreate_ARKIMEX"></a>PETSC_EXTERN <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSCreate_ARKIMEX(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2368">2368: </a>{
<a name="line2369">2369: </a>  TS_ARKIMEX *ark;
<a name="line2370">2370: </a>  <a href="../../../../manualpages/Sys/PetscBool.html">PetscBool</a>   dirk;

<a name="line2372">2372: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2373">2373: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXInitializePackage.html">TSARKIMEXInitializePackage</a>());
<a name="line2374">2374: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectTypeCompare.html">PetscObjectTypeCompare</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>, &amp;dirk));

<a name="line2376">2376: </a>  ts-&gt;ops-&gt;reset          = TSReset_ARKIMEX;
<a name="line2377">2377: </a>  ts-&gt;ops-&gt;adjointreset   = TSAdjointReset_ARKIMEX;
<a name="line2378">2378: </a>  ts-&gt;ops-&gt;destroy        = TSDestroy_ARKIMEX;
<a name="line2379">2379: </a>  ts-&gt;ops-&gt;view           = TSView_ARKIMEX;
<a name="line2380">2380: </a>  ts-&gt;ops-&gt;load           = TSLoad_ARKIMEX;
<a name="line2381">2381: </a>  ts-&gt;ops-&gt;setup          = TSSetUp_ARKIMEX;
<a name="line2382">2382: </a>  ts-&gt;ops-&gt;adjointsetup   = TSAdjointSetUp_ARKIMEX;
<a name="line2383">2383: </a>  ts-&gt;ops-&gt;step           = TSStep_ARKIMEX;
<a name="line2384">2384: </a>  ts-&gt;ops-&gt;interpolate    = TSInterpolate_ARKIMEX;
<a name="line2385">2385: </a>  ts-&gt;ops-&gt;evaluatestep   = TSEvaluateStep_ARKIMEX;
<a name="line2386">2386: </a>  ts-&gt;ops-&gt;rollback       = TSRollBack_ARKIMEX;
<a name="line2387">2387: </a>  ts-&gt;ops-&gt;setfromoptions = TSSetFromOptions_ARKIMEX;
<a name="line2388">2388: </a>  ts-&gt;ops-&gt;snesfunction   = SNESTSFormFunction_ARKIMEX;
<a name="line2389">2389: </a>  ts-&gt;ops-&gt;snesjacobian   = SNESTSFormJacobian_ARKIMEX;
<a name="line2390">2390: </a>  ts-&gt;ops-&gt;getstages      = TSGetStages_ARKIMEX;
<a name="line2391">2391: </a>  ts-&gt;ops-&gt;adjointstep    = TSAdjointStep_ARKIMEX;

<a name="line2393">2393: </a>  ts-&gt;usessnes = <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;

<a name="line2395">2395: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscNew.html">PetscNew</a>(&amp;ark));
<a name="line2396">2396: </a>  ts-&gt;data  = (void *)ark;
<a name="line2397">2397: </a>  ark-&gt;imex = dirk ? <a href="../../../../manualpages/Sys/PETSC_FALSE.html">PETSC_FALSE</a> : <a href="../../../../manualpages/Sys/PETSC_TRUE.html">PETSC_TRUE</a>;

<a name="line2399">2399: </a>  ark-&gt;VecsDeltaLam   = NULL;
<a name="line2400">2400: </a>  ark-&gt;VecsSensiTemp  = NULL;
<a name="line2401">2401: </a>  ark-&gt;VecsSensiPTemp = NULL;

<a name="line2403">2403: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXGetType_C"</font>, TSARKIMEXGetType_ARKIMEX));
<a name="line2404">2404: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXGetFullyImplicit_C"</font>, TSARKIMEXGetFullyImplicit_ARKIMEX));
<a name="line2405">2405: </a>  <font color="#4169E1">if</font> (!dirk) {
<a name="line2406">2406: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXSetType_C"</font>, TSARKIMEXSetType_ARKIMEX));
<a name="line2407">2407: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSARKIMEXSetFullyImplicit_C"</font>, TSARKIMEXSetFullyImplicit_ARKIMEX));
<a name="line2408">2408: </a>    <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSARKIMEXSetType.html">TSARKIMEXSetType</a>(ts, TSARKIMEXDefault));
<a name="line2409">2409: </a>  }
<a name="line2410">2410: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2411">2411: </a>}

<a name="line2413">2413: </a><font color="#B22222">/* ------------------------------------------------------------ */</font>

<a name="line2415">2415: </a><strong><font color="#4169E1"><a name="TSDIRKSetType_DIRK"></a>static <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSDIRKSetType_DIRK(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a> dirktype)</font></strong>
<a name="line2416">2416: </a>{
<a name="line2417">2417: </a>  TS_ARKIMEX *ark = (TS_ARKIMEX *)ts-&gt;data;

<a name="line2419">2419: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2420">2420: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSARKIMEXSetType_ARKIMEX(ts, dirktype));
<a name="line2421">2421: </a>  <a href="../../../../manualpages/Sys/PetscCheck.html">PetscCheck</a>(!ark-&gt;tableau-&gt;additive, <a href="../../../../manualpages/Sys/PetscObjectComm.html">PetscObjectComm</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts), <a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_ERR_ARG_WRONG</a>, <font color="#666666">"Method \"%s\" is not DIRK"</font>, dirktype);
<a name="line2422">2422: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2423">2423: </a>}

<a name="line2425">2425: </a><font color="#B22222">/*@C</font>
<a name="line2426">2426: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a> - Set the type of `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme</font>

<a name="line2428">2428: </a><font color="#B22222">  Logically Collective</font>

<a name="line2430">2430: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2431">2431: </a><font color="#B22222">+ ts       - timestepping context</font>
<a name="line2432">2432: </a><font color="#B22222">- dirktype - type of `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme</font>

<a name="line2434">2434: </a><font color="#B22222">  Options Database Key:</font>
<a name="line2435">2435: </a><font color="#B22222">. -ts_dirkimex_type - set `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme type</font>

<a name="line2437">2437: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2439">2439: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRKGetType.html">TSDIRKGetType</a>()`, `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>`, `<a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>`</font>
<a name="line2440">2440: </a><font color="#B22222">@*/</font>
<a name="line2441">2441: </a><strong><font color="#4169E1"><a name="TSDIRKSetType"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a> dirktype)</font></strong>
<a name="line2442">2442: </a>{
<a name="line2443">2443: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2445">2445: </a>  PetscAssertPointer(dirktype, 2);
<a name="line2446">2446: </a>  <a href="../../../../manualpages/Sys/PetscTryMethod.html">PetscTryMethod</a>(ts, <font color="#666666">"TSDIRKSetType_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a>), (ts, dirktype));
<a name="line2447">2447: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2448">2448: </a>}

<a name="line2450">2450: </a><font color="#B22222">/*@C</font>
<a name="line2451">2451: </a><font color="#B22222">  <a href="../../../../manualpages/TS/TSDIRKGetType.html">TSDIRKGetType</a> - Get the type of `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme</font>

<a name="line2453">2453: </a><font color="#B22222">  Logically Collective</font>

<a name="line2455">2455: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2456">2456: </a><font color="#B22222">. ts - timestepping context</font>

<a name="line2458">2458: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2459">2459: </a><font color="#B22222">. dirktype - type of `<a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>` scheme</font>

<a name="line2461">2461: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2463">2463: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`</font>
<a name="line2464">2464: </a><font color="#B22222">@*/</font>
<a name="line2465">2465: </a><strong><font color="#4169E1"><a name="TSDIRKGetType"></a><a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> <a href="../../../../manualpages/TS/TSDIRKGetType.html">TSDIRKGetType</a>(<a href="../../../../manualpages/TS/TS.html">TS</a> ts, <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a> *dirktype)</font></strong>
<a name="line2466">2466: </a>{
<a name="line2467">2467: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2469">2469: </a>  <a href="../../../../manualpages/Sys/PetscUseMethod.html">PetscUseMethod</a>(ts, <font color="#666666">"TSDIRKGetType_C"</font>, (<a href="../../../../manualpages/TS/TS.html">TS</a>, <a href="../../../../manualpages/TS/TSDIRKType.html">TSDIRKType</a> *), (ts, dirktype));
<a name="line2470">2470: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2471">2471: </a>}

<a name="line2473">2473: </a><font color="#B22222">/*MC</font>
<a name="line2474">2474: </a><font color="#B22222">      <a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a> - ODE and DAE solver using Diagonally implicit Runge-Kutta schemes.</font>

<a name="line2476">2476: </a><font color="#B22222">  Level: beginner</font>

<a name="line2478">2478: </a><font color="#B22222">  Notes:</font>
<a name="line2479">2479: </a><font color="#B22222">  The default is `<a href="../../../../manualpages/TS/TSDIRKES213SAL.html">TSDIRKES213SAL</a>`, it can be changed with `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()` or -ts_dirk_type.</font>
<a name="line2480">2480: </a><font color="#B22222">  The convention used in PETSc to name the DIRK methods is <a href="../../../../manualpages/TS/TSDIRK.html">TSDIRK</a>[E][S]PQS[SA][L][A] with:</font>
<a name="line2481">2481: </a><font color="#B22222">+ E - whether the method has an explicit first stage</font>
<a name="line2482">2482: </a><font color="#B22222">. S - whether the method is single diagonal</font>
<a name="line2483">2483: </a><font color="#B22222">. P - order of the advancing method</font>
<a name="line2484">2484: </a><font color="#B22222">. Q - order of the embedded method</font>
<a name="line2485">2485: </a><font color="#B22222">. S - number of stages</font>
<a name="line2486">2486: </a><font color="#B22222">. SA - whether the method is stiffly accurate</font>
<a name="line2487">2487: </a><font color="#B22222">. L - whether the method is L-stable</font>
<a name="line2488">2488: </a><font color="#B22222">- A - whether the method is A-stable</font>

<a name="line2490">2490: </a><font color="#B22222">.seealso: [](ch_ts), `<a href="../../../../manualpages/TS/TSCreate.html">TSCreate</a>()`, `<a href="../../../../manualpages/TS/TS.html">TS</a>`, `<a href="../../../../manualpages/TS/TSSetType.html">TSSetType</a>()`, `<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>()`, `<a href="../../../../manualpages/TS/TSDIRKGetType.html">TSDIRKGetType</a>()`, `<a href="../../../../manualpages/TS/TSDIRKRegister.html">TSDIRKRegister</a>()`.</font>
<a name="line2491">2491: </a><font color="#B22222">M*/</font>
<a name="line2492">2492: </a><strong><font color="#4169E1"><a name="TSCreate_DIRK"></a>PETSC_EXTERN <a href="../../../../manualpages/Sys/PetscErrorCode.html">PetscErrorCode</a> TSCreate_DIRK(<a href="../../../../manualpages/TS/TS.html">TS</a> ts)</font></strong>
<a name="line2493">2493: </a>{
<a name="line2494">2494: </a>  <a href="../../../../manualpages/Sys/PetscFunctionBegin.html">PetscFunctionBegin</a>;
<a name="line2495">2495: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(TSCreate_ARKIMEX(ts));
<a name="line2496">2496: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSDIRKGetType_C"</font>, TSARKIMEXGetType_ARKIMEX));
<a name="line2497">2497: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/Sys/PetscObjectComposeFunction.html">PetscObjectComposeFunction</a>((<a href="../../../../manualpages/Sys/PetscObject.html">PetscObject</a>)ts, <font color="#666666">"TSDIRKSetType_C"</font>, TSDIRKSetType_DIRK));
<a name="line2498">2498: </a>  <a href="../../../../manualpages/Sys/PetscCall.html">PetscCall</a>(<a href="../../../../manualpages/TS/TSDIRKSetType.html">TSDIRKSetType</a>(ts, TSDIRKDefault));
<a name="line2499">2499: </a>  <a href="../../../../manualpages/Sys/PetscFunctionReturn.html">PetscFunctionReturn</a>(<a href="../../../../manualpages/Sys/PetscErrorCode.html">PETSC_SUCCESS</a>);
<a name="line2500">2500: </a>}
</pre>
</body>

</html>
